Estrutura de arquivos:

|-- PdfProcessor.API
|   |-- Controllers
|   |   |-- BtgController.cs
|   |   |-- CompressPdfController.cs
|   |   |-- EditPdfController.cs
|   |   |-- ItauCash2Controller.cs
|   |   |-- ItauCashController.cs
|   |   |-- ItauMovimentacaoController.cs
|   |   |-- MergePdfController.cs
|   |   |-- MorganStanleyController.cs
|   |   |-- RotatePdfController.cs
|   |   -- UbsController.cs
|   |-- Properties
|   |   -- launchSettings.json
|   |-- appsettings.Development.json
|   |-- appsettings.json
|   |-- PdfProcessor.API.csproj
|   |-- PdfProcessor.API.http
|   -- Program.cs
|-- PdfProcessor.Application
|   |-- DTOs
|   |   |-- RequestDtos.cs
|   |   -- ResponseDtos.cs
|   |-- Class1.cs
|   -- PdfProcessor.Application.csproj
|-- PdfProcessor.Core
|   |-- Entities
|   |   |-- BankAccount.cs
|   |   |-- ProcessingResult.cs
|   |   -- Transaction.cs
|   |-- Enums
|   |   |-- BankType.cs
|   |   |-- CompressionLevel.cs
|   |   -- RotationAngle.cs
|   |-- Exceptions
|   |   -- PdfProcessingExceptions.cs
|   |-- Interfaces
|   |   |-- IBankParser.cs
|   |   |-- IBtgParser.cs
|   |   |-- IExcelGeneratorService.cs
|   |   |-- IItauCash2Parser.cs
|   |   |-- IItauCashParser.cs
|   |   |-- IItauMovimentacaoParser.cs
|   |   |-- IMorganStanleyParser.cs
|   |   |-- IPdfCompressService.cs
|   |   |-- IPdfEditService.cs
|   |   |-- IPdfMergeService.cs
|   |   |-- IPdfRotateService.cs
|   |   -- IUbsParser.cs
|   |-- Models
|   |   |-- BtgTransaction.cs
|   |   |-- ItauCash2Transaction.cs
|   |   |-- ItauCashTransaction.cs
|   |   |-- ItauTransaction.cs
|   |   |-- MorganStanleyTransaction.cs
|   |   -- UbsTransaction.cs
|   |-- Class1.cs
|   -- PdfProcessor.Core.csproj
|-- PdfProcessor.Infrastructure
|   |-- Parsers
|   |   |-- BtgParser.cs
|   |   |-- ItauCash2Parser.cs
|   |   |-- ItauCashParser.cs
|   |   |-- ItauMovimentacaoParser.cs
|   |   |-- MorganStanleyParser.cs
|   |   -- UbsParser.cs
|   |-- PdfServices
|   |   |-- PdfCompressService.cs
|   |   |-- PdfEditService.cs
|   |   |-- PdfMergeService.cs
|   |   -- PdfRotateService.cs
|   |-- Class1.cs
|   -- PdfProcessor.Infrastructure.csproj
|-- PdfProcessor.Shared
|   |-- Constants
|   |   -- AppConstants.cs
|   |-- Extensions
|   |   -- CommonExtensions.cs
|   |-- Class1.cs
|   -- PdfProcessor.Shared.csproj
|-- PdfProcessor.Web
|   |-- Components
|   |   |-- Layout
|   |   |   |-- MainLayout.razor
|   |   |   |-- MainLayout.razor.css
|   |   |   |-- NavMenu.razor
|   |   |   -- NavMenu.razor.css
|   |   |-- Pages
|   |   |   |-- Btg.razor
|   |   |   |-- CompressPdf.razor
|   |   |   |-- Counter.razor
|   |   |   |-- Dashboard.razor
|   |   |   |-- EditPdf.razor
|   |   |   |-- Error.razor
|   |   |   |-- Help.razor
|   |   |   |-- ItauCash.razor
|   |   |   |-- ItauCash2.razor
|   |   |   |-- ItauMovimentacao.razor
|   |   |   |-- MergePdf.razor
|   |   |   |-- MorganStanley.razor
|   |   |   |-- RotatePdf.razor
|   |   |   |-- Ubs.razor
|   |   |   -- Weather.razor
|   |   |-- App.razor
|   |   |-- Routes.razor
|   |   -- _Imports.razor
|   |-- Properties
|   |   -- launchSettings.json
|   |-- wwwroot
|   |   |-- css
|   |   |   |-- app.css
|   |   |   |-- btg.css
|   |   |   |-- compress-pdf.css
|   |   |   |-- dashboard.css
|   |   |   |-- edit-pdf.css
|   |   |   |-- itau-cash.css
|   |   |   |-- itau-cash2.css
|   |   |   |-- itau-movimentacao.css
|   |   |   |-- merge-pdf.css
|   |   |   |-- morgan-stanley.css
|   |   |   |-- pdf-upload-shared.css
|   |   |   |-- rotate-pdf.css
|   |   |   -- ubs.css
|   |   |-- js
|   |   |   |-- api-config.js
|   |   |   |-- app.js
|   |   |   |-- btg.js
|   |   |   |-- compress-pdf.js
|   |   |   |-- edit-pdf.js
|   |   |   |-- itau-cash.js
|   |   |   |-- itau-cash2.js
|   |   |   |-- itau-movimentacao.js
|   |   |   |-- merge-pdf.js
|   |   |   |-- morgan-stanley.js
|   |   |   |-- pdf-upload-handler.js
|   |   |   |-- rotate-pdf.js
|   |   |   -- ubs.js
|   |   |-- favicon.png
|   |   -- fileUploadHelper.js
|   |-- appsettings.Development.json
|   |-- appsettings.json
|   |-- PdfProcessor.Web.csproj
|   -- Program.cs
|-- .gitignore
|-- gerar-listagem.ps1
|-- gerar-listagem.sh
|-- Listagem-detalhada.txt
|-- PdfProcesor.sln
-- README.md

==============================
CONTEÃšDO DOS ARQUIVOS
==============================

----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\.gitignore
----------------------------------------

# ============================================
# .NET Core / ASP.NET Core
# ============================================

# Build results
[Dd]ebug/
[Dd]ebugPublic/
[Rr]elease/
[Rr]eleases/
x64/
x86/
[Ww][Ii][Nn]32/
[Aa][Rr][Mm]/
[Aa][Rr][Mm]64/
bld/
[Bb]in/
[Oo]bj/
[Ll]og/
[Ll]ogs/

# Visual Studio cache/options
.vs/
.vscode/
.idea/

# Visual Studio Code
.vscode/*
!.vscode/settings.json
!.vscode/tasks.json
!.vscode/launch.json
!.vscode/extensions.json
*.code-workspace

# User-specific files
*.rsuser
*.suo
*.user
*.userosscache
*.sln.docstates

# Mono auto generated files
mono_crash.*

# Build Results of an ATL Project
[Dd]ebugPS/
[Rr]eleasePS/
dlldata.c

# Benchmark Results
BenchmarkDotNet.Artifacts/

# .NET Core
project.lock.json
project.fragment.lock.json
artifacts/

# ASP.NET Scaffolding
ScaffoldingReadMe.txt

# StyleCop
StyleCopReport.xml

# Files built by Visual Studio
*_i.c
*_p.c
*_h.h
*.ilk
*.meta
*.obj
*.iobj
*.pch
*.pdb
*.ipdb
*.pgc
*.pgd
*.rsp
*.sbr
*.tlb
*.tli
*.tlh
*.tmp
*.tmp_proj
*_wpftmp.csproj
*.log
*.vspscc
*.vssscc
.builds
*.pidb
*.svclog
*.scc

# Chutzpah Test files
_Chutzpah*

# Visual C++ cache files
ipch/
*.aps
*.ncb
*.opendb
*.opensdf
*.sdf
*.cachefile
*.VC.db
*.VC.VC.opendb

# Visual Studio profiler
*.psess
*.vsp
*.vspx
*.sap

# Visual Studio Trace Files
*.e2e

# TFS 2012 Local Workspace
$tf/

# Guidance Automation Toolkit
*.gpState

# ReSharper is a .NET coding add-in
_ReSharper*/
*.[Rr]e[Ss]harper
*.DotSettings.user

# TeamCity is a build add-in
_TeamCity*

# DotCover is a Code Coverage Tool
*.dotCover

# AxoCover is a Code Coverage Tool
.axoCover/*
!.axoCover/settings.json

# Coverlet is a free, cross platform Code Coverage Tool
coverage*.json
coverage*.xml
coverage*.info

# Visual Studio code coverage results
*.coverage
*.coveragexml

# NCrunch
_NCrunch_*
.*crunch*.local.xml
nCrunchTemp_*

# MightyMoose
*.mm.*
AutoTest.Net/

# Web workbench (sass)
.sass-cache/

# Installshield output folder
[Ee]xpress/

# DocProject is a documentation generator add-in
DocProject/buildhelp/
DocProject/Help/*.HxT
DocProject/Help/*.HxC
DocProject/Help/*.hhc
DocProject/Help/*.hhk
DocProject/Help/*.hhp
DocProject/Help/Html2
DocProject/Help/html

# Click-Once directory
publish/

# Publish Web Output
*.[Pp]ublish.xml
*.azurePubxml
*.pubxml
*.publishproj

# Microsoft Azure Web App publish settings
PublishScripts/

# NuGet Packages
*.nupkg
*.snupkg
**/[Pp]ackages/*
!**/[Pp]ackages/build/
*.nuget.props
*.nuget.targets

# NuGet Symbol Packages
*.snupkg

# Microsoft Azure Build Output
csx/
*.build.csdef

# Microsoft Azure Emulator
ecf/
rcf/

# Windows Store app package directories and files
AppPackages/
BundleArtifacts/
Package.StoreAssociation.xml
_pkginfo.txt
*.appx
*.appxbundle
*.appxupload

# Visual Studio cache files
*.cachefile
*.VC.db
*.VC.VC.opendb

# Visual Studio profiler
*.psess
*.vsp
*.vspx
*.sap

# Visual Studio Trace Files
*.e2e

# Others
ClientBin/
~$*
*~
*.dbmdl
*.dbproj.schemaview
*.jfm
*.pfx
*.publishsettings
orleans.codegen.cs

# Including strong name files can present a security risk
*.snk

# Since there are multiple workflows, uncomment next line to ignore bower_components
# (https://github.com/github/gitignore/pull/1529#issuecomment-104372622)
#bower_components/

# RIA/Silverlight projects
Generated_Code/

# Backup & report files from converting an old project file
_UpgradeReport_Files/
Backup*/
UpgradeLog*.XML
UpgradeLog*.htm
ServiceFabricBackup/
*.rptproj.bak

# SQL Server files
*.mdf
*.ldf
*.ndf

# Business Intelligence projects
*.rdl.data
*.bim.layout
*.bim_*.settings
*.rptproj.rsuser
*- [Bb]ackup.rdl
*- [Bb]ackup ([0-9]).rdl
*- [Bb]ackup ([0-9][0-9]).rdl

# Microsoft Fakes
FakesAssemblies/

# GhostDoc plugin setting file
*.GhostDoc.xml

# Node.js Tools for Visual Studio
.ntvs_analysis.dat
node_modules/

# Visual Studio 6 build log
*.plg

# Visual Studio 6 workspace options file
*.opt

# Visual Studio 6 auto-generated workspace file (contains which files were open etc.)
*.vbw

# Visual Studio LightSwitch build output
**/*.HTMLClient/GeneratedArtifacts
**/*.DesktopClient/GeneratedArtifacts
**/*.DesktopClient/ModelManifest.xml
**/*.Server/GeneratedArtifacts
**/*.Server/ModelManifest.xml
_Pvt_Extensions

# Paket dependency manager
.paket/paket.exe
paket-files/

# FAKE - F# Make
.fake/

# CodeRush personal settings
.cr/personal

# Python Tools for Visual Studio (PTVS)
__pycache__/
*.pyc

# Cake - Uncomment if you are using it
# tools/**
# !tools/packages.config

# Tabs Studio
*.tss

# Telerik's JustMock configuration file
*.jmconfig

# BizTalk build output
*.btp.cs
*.btm.cs
*.odx.cs
*.xsd.cs

# OpenCover UI analysis results
OpenCover/

# Azure Stream Analytics local run output
ASALocalRun/

# MSBuild Binary and Structured Log
*.binlog

# NVidia Nsight GPU debugger configuration file
*.nvuser

# MFractors (Xamarin productivity tool) working folder
.mfractor/

# Local History for Visual Studio
.localhistory/

# BeatPulse healthcheck temp database
healthchecksdb

# Backup folder for Package Reference Convert tool in Visual Studio 2017
MigrationBackup/

# Ionide (cross platform F# VS Code tools) working folder
.ionide/

# Fody - auto-generated XML schema
FodyWeavers.xsd

# ============================================
# Projeto especÃ­fico - PDF Processor
# ============================================

# Uploads de usuÃ¡rios (PDFs temporÃ¡rios)
uploads/
temp/
tmp/

# Outputs gerados (PDFs processados, ZIPs, Excel)
outputs/
results/

# Logs da aplicaÃ§Ã£o
logs/
*.log

# Dados de teste
test-data/
sample-files/

# ConfiguraÃ§Ãµes locais
appsettings.Local.json
appsettings.*.local.json

# Secrets (senhas, chaves API)
secrets.json
*.secrets.json

# ============================================
# Docker
# ============================================
docker-compose.override.yml
.dockerignore

# ============================================
# Sistema Operacional
# ============================================

# Windows
Thumbs.db
Thumbs.db:encryptable
ehthumbs.db
ehthumbs_vista.db
*.stackdump
[Dd]esktop.ini
$RECYCLE.BIN/
*.cab
*.msi
*.msix
*.msm
*.msp
*.lnk

# macOS
.DS_Store
.AppleDouble
.LSOverride
Icon
._*
.DocumentRevisions-V100
.fseventsd
.Spotlight-V100
.TemporaryItems
.Trashes
.VolumeIcon.icns
.com.apple.timemachine.donotpresent
.AppleDB
.AppleDesktop
Network Trash Folder
Temporary Items
.apdisk

# Linux
*~
.directory
.Trash-*
.nfs*

# ============================================
# Arquivos temporÃ¡rios e caches
# ============================================
*.swp
*.swo
*.swn
.DS_Store
.env
.env.local
.env.*.local

# ============================================
# IDEs e Editores
# ============================================

# JetBrains Rider
.idea/
*.sln.iml

# Visual Studio Code
.vscode/
!.vscode/extensions.json
!.vscode/launch.json
!.vscode/settings.json
!.vscode/tasks.json

# Sublime Text
*.sublime-workspace
*.sublime-project

# ============================================
# Testes
# ============================================
TestResults/
*.trx
*.coverage

# ============================================
# NPM / Node (caso use para frontend assets)
# ============================================
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*
package-lock.json
yarn.lock

# ============================================
# Outros
# ============================================
*.bak
*.orig
*.rej
*~


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcesor.sln
----------------------------------------


Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.0.31903.59
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "PdfProcessor.API", "PdfProcessor.API\PdfProcessor.API.csproj", "{0EAD8184-B9C5-4CBA-94FE-0F08A2006E8B}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "PdfProcessor.Web", "PdfProcessor.Web\PdfProcessor.Web.csproj", "{3172BBE4-0248-4AD9-8561-36A95BD50564}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "PdfProcessor.Core", "PdfProcessor.Core\PdfProcessor.Core.csproj", "{C13B429F-4139-4F64-96D5-7B6C109DAA5F}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "PdfProcessor.Application", "PdfProcessor.Application\PdfProcessor.Application.csproj", "{702535E7-E7D0-4C63-B762-9D0FE542F1A4}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "PdfProcessor.Infrastructure", "PdfProcessor.Infrastructure\PdfProcessor.Infrastructure.csproj", "{D3A98B57-B916-4F3A-B4FE-53BDB625010D}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "PdfProcessor.Shared", "PdfProcessor.Shared\PdfProcessor.Shared.csproj", "{6D7F6864-4894-4FB2-81A7-1F5332956D95}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "PdfProcessor.UnitTests", "PdfProcessor.UnitTests\PdfProcessor.UnitTests.csproj", "{C1C90B91-8986-49E1-8209-21741FCB7639}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{0EAD8184-B9C5-4CBA-94FE-0F08A2006E8B}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{0EAD8184-B9C5-4CBA-94FE-0F08A2006E8B}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{0EAD8184-B9C5-4CBA-94FE-0F08A2006E8B}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{0EAD8184-B9C5-4CBA-94FE-0F08A2006E8B}.Release|Any CPU.Build.0 = Release|Any CPU
		{3172BBE4-0248-4AD9-8561-36A95BD50564}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{3172BBE4-0248-4AD9-8561-36A95BD50564}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{3172BBE4-0248-4AD9-8561-36A95BD50564}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{3172BBE4-0248-4AD9-8561-36A95BD50564}.Release|Any CPU.Build.0 = Release|Any CPU
		{C13B429F-4139-4F64-96D5-7B6C109DAA5F}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{C13B429F-4139-4F64-96D5-7B6C109DAA5F}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{C13B429F-4139-4F64-96D5-7B6C109DAA5F}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{C13B429F-4139-4F64-96D5-7B6C109DAA5F}.Release|Any CPU.Build.0 = Release|Any CPU
		{702535E7-E7D0-4C63-B762-9D0FE542F1A4}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{702535E7-E7D0-4C63-B762-9D0FE542F1A4}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{702535E7-E7D0-4C63-B762-9D0FE542F1A4}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{702535E7-E7D0-4C63-B762-9D0FE542F1A4}.Release|Any CPU.Build.0 = Release|Any CPU
		{D3A98B57-B916-4F3A-B4FE-53BDB625010D}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{D3A98B57-B916-4F3A-B4FE-53BDB625010D}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{D3A98B57-B916-4F3A-B4FE-53BDB625010D}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{D3A98B57-B916-4F3A-B4FE-53BDB625010D}.Release|Any CPU.Build.0 = Release|Any CPU
		{6D7F6864-4894-4FB2-81A7-1F5332956D95}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{6D7F6864-4894-4FB2-81A7-1F5332956D95}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{6D7F6864-4894-4FB2-81A7-1F5332956D95}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{6D7F6864-4894-4FB2-81A7-1F5332956D95}.Release|Any CPU.Build.0 = Release|Any CPU
		{C1C90B91-8986-49E1-8209-21741FCB7639}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{C1C90B91-8986-49E1-8209-21741FCB7639}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{C1C90B91-8986-49E1-8209-21741FCB7639}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{C1C90B91-8986-49E1-8209-21741FCB7639}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
EndGlobal



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\appsettings.Development.json
----------------------------------------

{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\appsettings.json
----------------------------------------

{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\PdfProcessor.API.csproj
----------------------------------------

<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.AspNetCore.OpenApi" Version="8.0.21" />
    <PackageReference Include="Serilog.AspNetCore" Version="9.0.0" />
    <PackageReference Include="Serilog.Sinks.Console" Version="6.1.1" />
    <PackageReference Include="Serilog.Sinks.File" Version="7.0.0" />
    <PackageReference Include="Swashbuckle.AspNetCore" Version="10.0.1" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\PdfProcessor.Application\PdfProcessor.Application.csproj" />
  </ItemGroup>

</Project>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\PdfProcessor.API.http
----------------------------------------

@PdfProcessor.API_HostAddress = http://localhost:5239

GET {{PdfProcessor.API_HostAddress}}/weatherforecast/
Accept: application/json

###



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Program.cs
----------------------------------------

using PdfProcessor.Core.Interfaces;
using PdfProcessor.Infrastructure.Parsers;
using PdfProcessor.Infrastructure.PdfServices;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddControllers();

// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();

// Registrar serviÃƒÂ§os do PDF Processor
builder.Services.AddScoped<IPdfRotateService, PdfRotateService>();
builder.Services.AddScoped<IPdfCompressService, PdfCompressService>();
builder.Services.AddScoped<IPdfMergeService, PdfMergeService>();
builder.Services.AddScoped<IPdfEditService, PdfEditService>(); // Ã¢Å“â€¦ ADICIONADO
builder.Services.AddScoped<IItauMovimentacaoParser, ItauMovimentacaoParser>();
builder.Services.AddScoped<IItauCashParser, ItauCashParser>();
builder.Services.AddScoped<IBtgParser, BtgParser>();
builder.Services.AddScoped<IUbsParser, UbsParser>();
builder.Services.AddScoped<IMorganStanleyParser, MorganStanleyParser>();
builder.Services.AddScoped<IItauCash2Parser, ItauCash2Parser>();

// Ã¢Å“â€¦ CORS DINÃƒâ€šMICO: Aceita qualquer rede local + localhost
builder.Services.AddCors(options =>
{
    options.AddPolicy("AllowBlazor", policy =>
    {
        policy.SetIsOriginAllowed(origin =>
        {
            // Parse a URL
            if (Uri.TryCreate(origin, UriKind.Absolute, out var uri))
            {
                var host = uri.Host;

                // Ã¢Å“â€¦ Permitir localhost
                if (host == "localhost" || host == "127.0.0.1")
                    return true;

                // Ã¢Å“â€¦ Permitir IPs de rede local (192.168.x.x, 10.x.x.x, 172.16-31.x.x)
                if (System.Net.IPAddress.TryParse(host, out var ip))
                {
                    var bytes = ip.GetAddressBytes();

                    // Rede Classe A: 10.0.0.0/8
                    if (bytes[0] == 10)
                        return true;

                    // Rede Classe B: 172.16.0.0/12
                    if (bytes[0] == 172 && bytes[1] >= 16 && bytes[1] <= 31)
                        return true;

                    // Rede Classe C: 192.168.0.0/16
                    if (bytes[0] == 192 && bytes[1] == 168)
                        return true;
                }
            }

            return false;
        })
        .AllowAnyMethod()
        .AllowAnyHeader();
    });
});

var app = builder.Build();

// Configure the HTTP request pipeline.
if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}

// Comentado para aceitar HTTP
// app.UseHttpsRedirection();

// Ã¢Å“â€¦ IMPORTANTE: CORS deve vir ANTES de MapControllers
app.UseCors("AllowBlazor");

// Mapear controllers
app.MapControllers();

await app.RunAsync();


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\BtgController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using PdfProcessor.Core.Interfaces;
using ClosedXML.Excel;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class BtgController : ControllerBase
{
    private readonly IBtgParser _btgParser;
    private readonly ILogger<BtgController> _logger;

    public BtgController(IBtgParser btgParser, ILogger<BtgController> logger)
    {
        _btgParser = btgParser;
        _logger = logger;
    }

    [HttpPost("batch")]
    public async Task<IActionResult> ProcessBatch([FromForm] IFormFileCollection files)
    {
        try
        {
            if (files == null || files.Count == 0)
            {
                return BadRequest("Nenhum arquivo foi enviado");
            }

            _logger.LogInformation($"ðŸ“¦ Recebidos {files.Count} arquivo(s) BTG Pactual");

            var allTransactions = new List<(string FileName, Core.Models.BtgTransaction Transaction)>();

            // Processar cada PDF
            foreach (var file in files)
            {
                if (file.Length == 0) continue;

                _logger.LogInformation($"ðŸ“„ Processando: {file.FileName}");

                // âœ… CRITICAL: Copiar para MemoryStream como faz o ItauCashController
                using var stream = new MemoryStream();
                await file.CopyToAsync(stream);
                stream.Position = 0;
                
                var transactions = await _btgParser.ParsePdfAsync(stream, file.FileName);

                foreach (var transaction in transactions)
                {
                    allTransactions.Add((file.FileName, transaction));
                }

                _logger.LogInformation($"âœ… {transactions.Count} transaÃ§Ã£o(Ãµes) extraÃ­da(s) de {file.FileName}");
            }

            if (allTransactions.Count == 0)
            {
                return BadRequest("Nenhuma transaÃ§Ã£o foi encontrada nos PDFs");
            }

            _logger.LogInformation($"ðŸ“Š Total: {allTransactions.Count} transaÃ§Ã£o(Ãµes)");

            // Gerar Excel
            var excelBytes = GenerateExcel(allTransactions);

            var timestamp = DateTime.Now.ToString("yyyyMMdd_HHmmss");
            var fileName = $"btg_pactual_{timestamp}.xlsx";

            return File(excelBytes, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", fileName);
        }
        catch (Exception ex)
        {
            _logger.LogError($"âŒ Erro ao processar PDFs: {ex.Message}");
            return StatusCode(500, $"Erro ao processar: {ex.Message}");
        }
    }

    private byte[] GenerateExcel(List<(string FileName, Core.Models.BtgTransaction Transaction)> transactions)
    {
        using var workbook = new XLWorkbook();
        var worksheet = workbook.Worksheets.Add("BTG Pactual - Transactions");

        // CabeÃ§alhos
        var headers = new[]
        {
            "Process/Settlement Date",
            "Trade/Transaction Date",
            "Activity Type",
            "Description",
            "Quantity",
            "Price",
            "Accrued Interest",
            "Amount",
            "Currency"
        };

        for (int i = 0; i < headers.Length; i++)
        {
            var cell = worksheet.Cell(1, i + 1);
            cell.Value = headers[i];
            cell.Style.Font.Bold = true;
            cell.Style.Fill.BackgroundColor = XLColor.FromHtml("#4472C4");
            cell.Style.Font.FontColor = XLColor.White;
            cell.Style.Alignment.Horizontal = XLAlignmentHorizontalValues.Center;
        }

        // Dados
        int row = 2;
        foreach (var (fileName, transaction) in transactions)
        {
            worksheet.Cell(row, 1).Value = transaction.ProcessSettlementDate;
            worksheet.Cell(row, 2).Value = transaction.TradeTransactionDate;
            worksheet.Cell(row, 3).Value = transaction.ActivityType;
            worksheet.Cell(row, 4).Value = transaction.Description;
            worksheet.Cell(row, 5).Value = transaction.Quantity;
            worksheet.Cell(row, 6).Value = transaction.Price;
            worksheet.Cell(row, 7).Value = transaction.AccruedInterest;
            worksheet.Cell(row, 8).Value = transaction.Amount;
            worksheet.Cell(row, 9).Value = transaction.Currency;
            row++;
        }

        // Auto-ajustar colunas
        worksheet.Columns().AdjustToContents();

        // Congelar primeira linha
        worksheet.SheetView.FreezeRows(1);

        using var stream = new MemoryStream();
        workbook.SaveAs(stream);
        return stream.ToArray();
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\CompressPdfController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using PdfProcessor.Core.Interfaces;
using System.IO.Compression;
using CoreCompressionLevel = PdfProcessor.Core.Enums.CompressionLevel;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class CompressPdfController : ControllerBase
{
  private readonly IPdfCompressService _compressService;
  private readonly ILogger<CompressPdfController> _logger;

  public CompressPdfController(
      IPdfCompressService compressService,
      ILogger<CompressPdfController> logger)
  {
    _compressService = compressService;
    _logger = logger;
  }

  /// <summary>
  /// Comprime mÃºltiplos PDFs em lote
  /// POST /api/CompressPdf/batch
  /// </summary>
  [HttpPost("batch")]
  [RequestSizeLimit(100 * 1024 * 1024)] // 100MB total
  public async Task<IActionResult> CompressBatch([FromForm] CompressPdfBatchRequest request)
  {
    try
    {
      if (request.Files == null || request.Files.Count == 0)
        return BadRequest("Nenhum arquivo enviado");

      _logger.LogInformation("Processando {Count} arquivo(s) para compressÃ£o", request.Files.Count);

      // Preparar streams e configuraÃ§Ãµes
      var pdfStreams = new Dictionary<string, Stream>();
      var compressionSettings = new Dictionary<string, CompressionSettings>();

      for (int i = 0; i < request.Files.Count; i++)
      {
        var file = request.Files[i];
        var fileName = file.FileName;

        // Obter configuraÃ§Ãµes para este arquivo
        var level = i < request.CompressionLevels.Count
            ? ParseCompressionLevel(request.CompressionLevels[i])
            : CoreCompressionLevel.Medium;

        var removeImages = i < request.RemoveImages.Count && request.RemoveImages[i];

        pdfStreams[fileName] = file.OpenReadStream();
        compressionSettings[fileName] = new CompressionSettings
        {
          Level = level,
          RemoveImages = removeImages
        };
      }

      // Comprimir PDFs
      var results = await _compressService.CompressBatchAsync(pdfStreams, compressionSettings);

      // Filtrar apenas sucessos
      var successfulResults = results
          .Where(r => r.Value.Success && r.Value.CompressedData != null)
          .ToDictionary(r => r.Key, r => r.Value.CompressedData!);

      if (successfulResults.Count == 0)
      {
        return BadRequest("Nenhum arquivo foi comprimido com sucesso");
      }

      // âœ… CORREÃ‡ÃƒO: Se apenas 1 arquivo, retornar como PDF direto
      if (successfulResults.Count == 1)
      {
        var single = successfulResults.First();
        var originalResult = results[single.Key];
        var outputName = Path.GetFileNameWithoutExtension(single.Key) + "_comprimido.pdf";

        _logger.LogInformation("Retornando PDF Ãºnico comprimido: {FileName} " +
            "({Original} â†’ {Compressed}, {Percentage})",
            outputName,
            originalResult.OriginalSizeMB,
            originalResult.CompressedSizeMB,
            originalResult.CompressionPercentage);

        // âœ… IMPORTANTE: Retornar como application/pdf com extensÃ£o .pdf
        return File(single.Value, "application/pdf", outputName);
      }

      // MÃºltiplos arquivos: criar ZIP
      var zipBytes = CreateZip(successfulResults);
      var zipName = $"pdfs_comprimidos_{DateTime.Now:yyyyMMdd_HHmmss}.zip";

      // Log de resumo
      var totalOriginal = results.Values.Sum(r => r.OriginalSizeBytes);
      var totalCompressed = results.Values.Where(r => r.Success).Sum(r => r.CompressedSizeBytes);
      var overallPercentage = totalOriginal > 0
          ? $"{(1 - (double)totalCompressed / totalOriginal) * 100:F2}%"
          : "0%";

      _logger.LogInformation("ZIP criado com sucesso: {FileName} " +
          "({Original} MB â†’ {Compressed} MB, economia de {Percentage})",
          zipName,
          totalOriginal / 1024.0 / 1024.0,
          totalCompressed / 1024.0 / 1024.0,
          overallPercentage);

      // âœ… IMPORTANTE: Retornar como application/zip com extensÃ£o .zip
      return File(zipBytes, "application/zip", zipName);
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "Erro ao comprimir PDFs");
      return StatusCode(500, $"Erro ao processar: {ex.Message}");
    }
  }

  /// <summary>
  /// ObtÃ©m informaÃ§Ãµes de um PDF (tamanho, pÃ¡ginas, etc.)
  /// POST /api/CompressPdf/info
  /// </summary>
  [HttpPost("info")]
  [RequestSizeLimit(16 * 1024 * 1024)]
  public async Task<IActionResult> GetPdfInfo(IFormFile file)
  {
    try
    {
      if (file == null || file.Length == 0)
        return BadRequest("Nenhum arquivo enviado");

      if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
        return BadRequest("Apenas arquivos PDF sÃ£o permitidos");

      using var stream = file.OpenReadStream();

      // Comprimir temporariamente para estimar tamanho comprimido
      var result = await _compressService.CompressPdfAsync(
          stream,
          CoreCompressionLevel.Medium,
          false,
          file.FileName);

      return Ok(new
      {
        fileName = file.FileName,
        originalSize = file.Length,
        originalSizeMB = $"{file.Length / 1024.0 / 1024.0:F2} MB",
        estimatedCompressedSize = result.CompressedSizeBytes,
        estimatedCompressedSizeMB = result.CompressedSizeMB,
        estimatedSavings = result.CompressionPercentage,
        canCompress = result.Success
      });
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "Erro ao obter informaÃ§Ãµes do PDF");
      return StatusCode(500, "Erro ao processar arquivo");
    }
  }

  /// <summary>
  /// Cria arquivo ZIP com mÃºltiplos PDFs
  /// </summary>
  private static byte[] CreateZip(Dictionary<string, byte[]> files)
  {
    using var zipStream = new MemoryStream();

    using (var archive = new ZipArchive(zipStream, ZipArchiveMode.Create, true))
    {
      foreach (var file in files)
      {
        // Adicionar sufixo "_comprimido" ao nome
        var baseName = Path.GetFileNameWithoutExtension(file.Key);
        var extension = Path.GetExtension(file.Key);
        var newName = $"{baseName}_comprimido{extension}";

        var entry = archive.CreateEntry(newName, CompressionLevel.Optimal);
        using var entryStream = entry.Open();
        entryStream.Write(file.Value, 0, file.Value.Length);
      }
    }

    return zipStream.ToArray();
  }

  /// <summary>
  /// Converte string para CompressionLevel enum
  /// </summary>
  private static CoreCompressionLevel ParseCompressionLevel(string level)
  {
    return level?.ToLower() switch
    {
      "low" or "baixo" => CoreCompressionLevel.Low,
      "medium" or "medio" or "mÃ©dio" => CoreCompressionLevel.Medium,
      "high" or "alto" => CoreCompressionLevel.High,
      _ => CoreCompressionLevel.Medium
    };
  }
}

/// <summary>
/// Request para compressÃ£o em lote
/// </summary>
public class CompressPdfBatchRequest
{
  public List<IFormFile> Files { get; set; } = new();
  public List<string> CompressionLevels { get; set; } = new(); // "low", "medium", "high"
  public List<bool> RemoveImages { get; set; } = new();
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\EditPdfController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Http;
using PdfProcessor.Core.Interfaces;
using System.Text.Json;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class EditPdfController : ControllerBase
{
  private readonly IPdfEditService _pdfEditService;
  private readonly ILogger<EditPdfController> _logger;

  public EditPdfController(
      IPdfEditService pdfEditService,
      ILogger<EditPdfController> logger)
  {
    _pdfEditService = pdfEditService;
    _logger = logger;
  }

  /// <summary>
  /// ObtÃ©m o nÃºmero de pÃ¡ginas de um PDF
  /// </summary>
  [HttpPost("pagecount")]
  [ProducesResponseType(StatusCodes.Status200OK)]
  [ProducesResponseType(StatusCodes.Status400BadRequest)]
  public async Task<IActionResult> GetPageCount(IFormFile file)
  {
    try
    {
      if (file == null || file.Length == 0)
      {
        return BadRequest("Nenhum arquivo enviado");
      }

      _logger.LogInformation("ðŸ“Š Contando pÃ¡ginas: {FileName}", file.FileName);

      using var stream = file.OpenReadStream();
      var pageCount = await _pdfEditService.GetPageCountAsync(stream);

      return Ok(new { pageCount, fileName = file.FileName });
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "âŒ Erro ao contar pÃ¡ginas");
      return StatusCode(500, $"Erro ao processar PDF: {ex.Message}");
    }
  }

  /// <summary>
  /// Gera thumbnail de uma pÃ¡gina especÃ­fica
  /// </summary>
  [HttpPost("thumbnail")]
  [ProducesResponseType(StatusCodes.Status200OK)]
  [ProducesResponseType(StatusCodes.Status400BadRequest)]
  public async Task<IActionResult> GetPageThumbnail(
      IFormFile file,
      [FromForm] int pageNumber)
  {
    try
    {
      if (file == null || file.Length == 0)
      {
        return BadRequest("Nenhum arquivo enviado");
      }

      if (pageNumber < 1)
      {
        return BadRequest("NÃºmero de pÃ¡gina invÃ¡lido");
      }

      _logger.LogDebug("ðŸ–¼ï¸ Gerando thumbnail: {FileName}, pÃ¡gina {PageNumber}",
          file.FileName, pageNumber);

      using var stream = file.OpenReadStream();
      var thumbnail = await _pdfEditService.GeneratePageThumbnailAsync(stream, pageNumber);

      return Ok(new
      {
        pageNumber,
        thumbnail,
        fileName = file.FileName
      });
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "âŒ Erro ao gerar thumbnail da pÃ¡gina {PageNumber}", pageNumber);
      return StatusCode(500, $"Erro ao gerar thumbnail: {ex.Message}");
    }
  }

  /// <summary>
  /// Processa PDF aplicando rotaÃ§Ãµes e removendo pÃ¡ginas
  /// </summary>
  [HttpPost("process")]
  [ProducesResponseType(StatusCodes.Status200OK)]
  [ProducesResponseType(StatusCodes.Status400BadRequest)]
  public async Task<IActionResult> ProcessPdf(
      IFormFile file,
      [FromForm] string pageOperations)
  {
    try
    {
      if (file == null || file.Length == 0)
      {
        return BadRequest("Nenhum arquivo enviado");
      }

      if (string.IsNullOrEmpty(pageOperations))
      {
        return BadRequest("OperaÃ§Ãµes de pÃ¡gina nÃ£o especificadas");
      }

      _logger.LogInformation("ðŸ“ Processando PDF: {FileName}", file.FileName);

      // Deserializar operaÃ§Ãµes
      var operations = JsonSerializer.Deserialize<List<PageOperation>>(
          pageOperations,
          new JsonSerializerOptions { PropertyNameCaseInsensitive = true });

      if (operations == null || operations.Count == 0)
      {
        return BadRequest("Nenhuma operaÃ§Ã£o especificada");
      }

      _logger.LogInformation("ðŸ”§ OperaÃ§Ãµes recebidas: {Count} pÃ¡ginas",
          operations.Count);

      using var stream = file.OpenReadStream();
      var result = await _pdfEditService.ProcessPdfAsync(
          stream,
          operations,
          file.FileName);

      if (!result.Success)
      {
        return StatusCode(500, $"Erro ao processar PDF: {result.ErrorMessage}");
      }

      // Gerar nome do arquivo de saÃ­da
      var outputFileName = Path.GetFileNameWithoutExtension(file.FileName) + "_edited.pdf";

      _logger.LogInformation(
          "âœ… PDF processado: {Original} â†’ {Final} pÃ¡ginas",
          result.OriginalPageCount, result.FinalPageCount);

      return File(
          result.ProcessedPdfData!,
          "application/pdf",
          outputFileName);
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "âŒ Erro ao processar PDF");
      return StatusCode(500, $"Erro ao processar PDF: {ex.Message}");
    }
  }

  /// <summary>
  /// Health check
  /// </summary>
  [HttpGet("health")]
  public IActionResult Health()
  {
    return Ok(new
    {
      service = "EditPdf",
      status = "healthy",
      timestamp = DateTime.UtcNow
    });
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\ItauCash2Controller.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using PdfProcessor.Core.Interfaces;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class ItauCash2Controller : ControllerBase
{
    private readonly IItauCash2Parser _parser;
    private readonly ILogger<ItauCash2Controller> _logger;

    public ItauCash2Controller(IItauCash2Parser parser, ILogger<ItauCash2Controller> logger)
    {
        _parser = parser;
        _logger = logger;
    }

    [HttpPost("process")]
    public async Task<IActionResult> ProcessPdfs([FromForm] IFormFileCollection files, [FromForm] bool debugMode = false)
    {
        try
        {
            if (files == null || files.Count == 0)
            {
                _logger.LogWarning("âš ï¸ Nenhum arquivo recebido");
                return BadRequest(new { error = "Nenhum arquivo foi enviado" });
            }

            _logger.LogInformation($"ðŸ“¥ Recebidos {files.Count} arquivo(s) - Debug: {debugMode}");

            var streams = new List<Stream>();

            foreach (var file in files)
            {
                if (file.Length == 0)
                    continue;

                var stream = new MemoryStream();
                await file.CopyToAsync(stream);
                stream.Position = 0;
                streams.Add(stream);

                _logger.LogInformation($"  ðŸ“„ {file.FileName} ({file.Length} bytes)");
            }

            if (streams.Count == 0)
            {
                return BadRequest(new { error = "Nenhum arquivo vÃ¡lido foi enviado" });
            }

            var excelBytes = await _parser.ProcessBatchAsync(streams, debugMode);

            foreach (var stream in streams)
            {
                stream.Dispose();
            }

            var fileName = debugMode 
                ? $"ItauCash2_DEBUG_{DateTime.Now:yyyyMMdd_HHmmss}.xlsx"
                : $"ItauCash2_Transacoes_{DateTime.Now:yyyyMMdd_HHmmss}.xlsx";

            _logger.LogInformation($"âœ… Processamento concluÃ­do: {fileName}");

            return File(excelBytes, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", fileName);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "âŒ Erro ao processar PDFs ItaÃº Cash 2");
            return StatusCode(500, new { error = $"Erro ao processar arquivos: {ex.Message}" });
        }
    }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\ItauCashController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class ItauCashController : ControllerBase
{
    private readonly IItauCashParser _parser;
    private readonly ILogger<ItauCashController> _logger;

    public ItauCashController(
        IItauCashParser parser,
        ILogger<ItauCashController> logger)
    {
        _parser = parser;
        _logger = logger;
    }

    /// <summary>
    /// Processa mÃºltiplos PDFs de Cash Transactions do ItaÃº
    /// </summary>
    [HttpPost("batch")]
    public async Task<IActionResult> ProcessBatch([FromForm] List<IFormFile> files)
    {
        try
        {
            if (files == null || files.Count == 0)
            {
                return BadRequest("Nenhum arquivo enviado");
            }

            _logger.LogInformation($"ðŸ¦ Processando {files.Count} extrato(s) ItaÃº Cash");

            // Validar arquivos
            foreach (var file in files)
            {
                if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
                {
                    return BadRequest($"Arquivo {file.FileName} nÃ£o Ã© um PDF");
                }

                if (file.Length == 0)
                {
                    return BadRequest($"Arquivo {file.FileName} estÃ¡ vazio");
                }

                if (file.Length > 16 * 1024 * 1024)
                {
                    return BadRequest($"Arquivo {file.FileName} excede 16MB");
                }
            }

            // Converter para streams
            var streams = new List<Stream>();
            
            try
            {
                foreach (var file in files)
                {
                    var stream = new MemoryStream();
                    await file.CopyToAsync(stream);
                    stream.Position = 0;
                    streams.Add(stream);
                }

                // Processar
                var excelBytes = await _parser.ProcessBatchAsync(streams);

                _logger.LogInformation($"âœ… Processamento concluÃ­do: {excelBytes.Length} bytes");

                // Retornar Excel
                var timestamp = DateTime.Now.ToString("yyyyMMdd_HHmmss");
                var fileName = $"itau_cash_{timestamp}.xlsx";

                return File(excelBytes, 
                    "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", 
                    fileName);
            }
            finally
            {
                // Limpar streams
                foreach (var stream in streams)
                {
                    stream?.Dispose();
                }
            }
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "âŒ Erro ao processar extratos");
            return StatusCode(500, $"Erro ao processar: {ex.Message}");
        }
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\ItauMovimentacaoController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class ItauMovimentacaoController : ControllerBase
{
    private readonly IItauMovimentacaoParser _parser;
    private readonly ILogger<ItauMovimentacaoController> _logger;

    public ItauMovimentacaoController(
        IItauMovimentacaoParser parser,
        ILogger<ItauMovimentacaoController> logger)
    {
        _parser = parser;
        _logger = logger;
    }

    /// <summary>
    /// Processa mÃºltiplos PDFs de movimentaÃ§Ã£o bancÃ¡ria ItaÃº
    /// </summary>
    [HttpPost("batch")]
    public async Task<IActionResult> ProcessBatch([FromForm] List<IFormFile> files)
    {
        try
        {
            if (files == null || files.Count == 0)
            {
                return BadRequest("Nenhum arquivo enviado");
            }

            _logger.LogInformation($"ðŸ’³ Processando {files.Count} extrato(s) ItaÃº");

            // Validar arquivos
            foreach (var file in files)
            {
                if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
                {
                    return BadRequest($"Arquivo {file.FileName} nÃ£o Ã© um PDF");
                }

                if (file.Length == 0)
                {
                    return BadRequest($"Arquivo {file.FileName} estÃ¡ vazio");
                }

                if (file.Length > 16 * 1024 * 1024)
                {
                    return BadRequest($"Arquivo {file.FileName} excede 16MB");
                }
            }

            // Converter para streams
            var streams = new List<Stream>();
            
            try
            {
                foreach (var file in files)
                {
                    var stream = new MemoryStream();
                    await file.CopyToAsync(stream);
                    stream.Position = 0;
                    streams.Add(stream);
                }

                // Processar
                var excelBytes = await _parser.ProcessBatchAsync(streams);

                _logger.LogInformation($"âœ… Processamento concluÃ­do: {excelBytes.Length} bytes");

                // Retornar Excel
                var timestamp = DateTime.Now.ToString("yyyyMMdd_HHmmss");
                var fileName = $"movimentacao_itau_{timestamp}.xlsx";

                return File(excelBytes, 
                    "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", 
                    fileName);
            }
            finally
            {
                // Limpar streams
                foreach (var stream in streams)
                {
                    stream?.Dispose();
                }
            }
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "âŒ Erro ao processar extratos");
            return StatusCode(500, $"Erro ao processar: {ex.Message}");
        }
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\MergePdfController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using PdfProcessor.Core.Interfaces;
using PdfSharp.Pdf.IO;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class MergePdfController : ControllerBase
{
    private readonly IPdfMergeService _mergeService;
    private readonly ILogger<MergePdfController> _logger;

    public MergePdfController(
        IPdfMergeService mergeService,
        ILogger<MergePdfController> logger)
    {
        _mergeService = mergeService;
        _logger = logger;
    }

    /// <summary>
    /// Mescla mÃºltiplos PDFs em um Ãºnico arquivo
    /// </summary>
    [HttpPost("batch")]
    public async Task<IActionResult> MergeBatch(
        [FromForm] List<IFormFile> files,
        [FromForm] List<string>? pageRanges = null)
    {
        try
        {
            if (files == null || files.Count < 2)
            {
                return BadRequest("Envie pelo menos 2 arquivos PDF");
            }

            _logger.LogInformation($"ðŸ”— Mesclando {files.Count} arquivo(s)");

            // Validar arquivos
            foreach (var file in files)
            {
                if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
                {
                    return BadRequest($"Arquivo {file.FileName} nÃ£o Ã© um PDF");
                }

                if (file.Length == 0)
                {
                    return BadRequest($"Arquivo {file.FileName} estÃ¡ vazio");
                }

                if (file.Length > 16 * 1024 * 1024) // 16MB
                {
                    return BadRequest($"Arquivo {file.FileName} excede 16MB");
                }
            }

            // Preparar streams e ranges
            var fileStreams = new Dictionary<string, Stream>();
            var rangeDict = new Dictionary<string, string>();

            try
            {
                for (int i = 0; i < files.Count; i++)
                {
                    var file = files[i];
                    var stream = new MemoryStream();
                    await file.CopyToAsync(stream);
                    stream.Position = 0;

                    fileStreams[file.FileName] = stream;

                    // Adicionar range se fornecido
                    if (pageRanges != null && i < pageRanges.Count && !string.IsNullOrWhiteSpace(pageRanges[i]))
                    {
                        rangeDict[file.FileName] = pageRanges[i];
                    }
                }

                // Mesclar PDFs
                var mergedPdf = await _mergeService.MergePdfsAsync(fileStreams, rangeDict);

                _logger.LogInformation($"âœ… Mesclagem concluÃ­da: {mergedPdf.Length} bytes");

                // Retornar PDF mesclado
                var timestamp = DateTime.Now.ToString("yyyyMMdd_HHmmss");
                var fileName = $"pdf_mesclado_{timestamp}.pdf";

                return File(mergedPdf, "application/pdf", fileName);
            }
            finally
            {
                // Limpar streams
                foreach (var stream in fileStreams.Values)
                {
                    stream.Dispose();
                }
            }
        }
        catch (ArgumentException ex)
        {
            _logger.LogWarning($"âš ï¸ Erro de validaÃ§Ã£o: {ex.Message}");
            return BadRequest(ex.Message);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "âŒ Erro ao mesclar PDFs");
            return StatusCode(500, $"Erro ao mesclar PDFs: {ex.Message}");
        }
    }

    /// <summary>
    /// Conta o nÃºmero de pÃ¡ginas de um PDF
    /// </summary>
    [HttpPost("pagecount")]
    public async Task<IActionResult> GetPageCount([FromForm] IFormFile file)
    {
        try
        {
            if (file == null || file.Length == 0)
            {
                return BadRequest("Arquivo nÃ£o fornecido");
            }

            if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
            {
                return BadRequest("Arquivo nÃ£o Ã© um PDF");
            }

            _logger.LogInformation($"ðŸ“„ Contando pÃ¡ginas de: {file.FileName}");

            using var stream = new MemoryStream();
            await file.CopyToAsync(stream);
            stream.Position = 0;

            // Abrir PDF e contar pÃ¡ginas
            using var document = PdfReader.Open(stream, PdfDocumentOpenMode.InformationOnly);
            var pageCount = document.PageCount;

            _logger.LogInformation($"âœ… {file.FileName}: {pageCount} pÃ¡gina(s)");

            return Ok(new { fileName = file.FileName, pageCount });
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, $"âŒ Erro ao contar pÃ¡ginas de {file?.FileName}");
            return StatusCode(500, $"Erro ao contar pÃ¡ginas: {ex.Message}");
        }
    }

    /// <summary>
    /// Extrai pÃ¡ginas especÃ­ficas de um PDF
    /// </summary>
    [HttpPost("extract")]
    public async Task<IActionResult> ExtractPages(
        [FromForm] IFormFile file,
        [FromForm] string pageRange)
    {
        try
        {
            if (file == null || file.Length == 0)
            {
                return BadRequest("Arquivo nÃ£o fornecido");
            }

            if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
            {
                return BadRequest("Arquivo nÃ£o Ã© um PDF");
            }

            if (string.IsNullOrWhiteSpace(pageRange))
            {
                return BadRequest("Range de pÃ¡ginas nÃ£o fornecido");
            }

            _logger.LogInformation($"âœ‚ï¸ Extraindo pÃ¡ginas de: {file.FileName} (range: {pageRange})");

            using var stream = new MemoryStream();
            await file.CopyToAsync(stream);
            stream.Position = 0;

            // Contar pÃ¡ginas primeiro
            int totalPages;
            using (var document = PdfReader.Open(stream, PdfDocumentOpenMode.InformationOnly))
            {
                totalPages = document.PageCount;
            }

            // Parsear range
            var pageNumbers = _mergeService.ParsePageRange(pageRange, totalPages);

            // Extrair pÃ¡ginas
            stream.Position = 0;
            var extractedPdf = await _mergeService.ExtractPagesAsync(stream, pageNumbers);

            _logger.LogInformation($"âœ… {pageNumbers.Count} pÃ¡gina(s) extraÃ­da(s)");

            var fileName = $"{Path.GetFileNameWithoutExtension(file.FileName)}_paginas_{pageRange.Replace(",", "_").Replace("-", "a")}.pdf";

            return File(extractedPdf, "application/pdf", fileName);
        }
        catch (ArgumentException ex)
        {
            _logger.LogWarning($"âš ï¸ Erro de validaÃ§Ã£o: {ex.Message}");
            return BadRequest(ex.Message);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "âŒ Erro ao extrair pÃ¡ginas");
            return StatusCode(500, $"Erro ao extrair pÃ¡ginas: {ex.Message}");
        }
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\MorganStanleyController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;
using ClosedXML.Excel;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/morgan-stanley")]
public class MorganStanleyController : ControllerBase
{
    private readonly IMorganStanleyParser _parser;
    private readonly ILogger<MorganStanleyController> _logger;

    public MorganStanleyController(IMorganStanleyParser parser, ILogger<MorganStanleyController> logger)
    {
        _parser = parser;
        _logger = logger;
    }

    [HttpPost("batch")]
    public async Task<IActionResult> ProcessBatch([FromForm] List<IFormFile> files)
    {
        try
        {
            if (files == null || files.Count == 0)
            {
                return BadRequest("Nenhum arquivo enviado");
            }

            _logger.LogInformation($"ðŸ¦ Processando {files.Count} arquivo(s) Morgan Stanley");

            var allTransactions = new List<(string FileName, Core.Models.MorganStanleyTransaction Transaction)>();

            // Processar cada PDF
            foreach (var file in files)
            {
                if (file.Length == 0) continue;

                _logger.LogInformation($"ðŸ“„ Processando: {file.FileName}");

                // âœ… Copiar para MemoryStream (padrÃ£o)
                using var stream = new MemoryStream();
                await file.CopyToAsync(stream);
                stream.Position = 0;
                
                var transactions = await _parser.ParsePdfAsync(stream, file.FileName);

                foreach (var transaction in transactions)
                {
                    allTransactions.Add((file.FileName, transaction));
                }

                _logger.LogInformation($"âœ… {transactions.Count} transaÃ§Ã£o(Ãµes) extraÃ­da(s) de {file.FileName}");
            }

            if (allTransactions.Count == 0)
            {
                return BadRequest("Nenhuma transaÃ§Ã£o encontrada nos PDFs");
            }

            _logger.LogInformation($"ðŸ“Š Total: {allTransactions.Count} transaÃ§Ã£o(Ãµes)");

            // Gerar Excel
            var excelBytes = GenerateExcel(allTransactions);

            var timestamp = DateTime.Now.ToString("yyyyMMdd_HHmmss");
            var fileName = $"morgan_stanley_{timestamp}.xlsx";

            return File(excelBytes, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", fileName);
        }
        catch (Exception ex)
        {
            _logger.LogError($"âŒ Erro ao processar PDFs: {ex.Message}");
            return StatusCode(500, $"Erro ao processar: {ex.Message}");
        }
    }

    private byte[] GenerateExcel(List<(string FileName, Core.Models.MorganStanleyTransaction Transaction)> transactions)
    {
        using var workbook = new XLWorkbook();

        // âœ… AGRUPAR POR ACCOUNT NUMBER (cada conta = uma aba)
        var groupedByAccount = transactions
            .GroupBy(t => t.Transaction.AccountNumber)
            .OrderBy(g => g.Key)
            .ToList();

        foreach (var accountGroup in groupedByAccount)
        {
            var accountNumber = accountGroup.Key;
            
            // Criar nome da aba (usar account number)
            var sheetName = string.IsNullOrWhiteSpace(accountNumber) 
                ? "Morgan Stanley" 
                : accountNumber.Length > 31 
                    ? accountNumber.Substring(0, 31) 
                    : accountNumber;
            
            // Remover caracteres invÃ¡lidos
            sheetName = sheetName.Replace("/", "-").Replace("\\", "-").Replace(":", "-")
                                 .Replace("*", "").Replace("?", "").Replace("[", "").Replace("]", "");
            
            var worksheet = workbook.Worksheets.Add(sheetName);

            // âœ… CABEÃ‡ALHOS (8 colunas - sem Account Number)
            var headers = new[]
            {
                "Activity Date",
                "Settlement Date",
                "Activity Type",
                "Description",
                "Comments",
                "Quantity",
                "Price",
                "Credits/(Debits)"
            };

            for (int i = 0; i < headers.Length; i++)
            {
                var cell = worksheet.Cell(1, i + 1);
                cell.Value = headers[i];
                cell.Style.Font.Bold = true;
                cell.Style.Fill.BackgroundColor = XLColor.FromHtml("#003D7A"); // Azul Morgan Stanley
                cell.Style.Font.FontColor = XLColor.White;
                cell.Style.Alignment.Horizontal = XLAlignmentHorizontalValues.Center;
            }

            // âœ… DADOS (8 colunas)
            int row = 2;
            foreach (var (fileName, transaction) in accountGroup)
            {
                worksheet.Cell(row, 1).Value = transaction.ActivityDate;
                worksheet.Cell(row, 2).Value = transaction.SettlementDate;
                worksheet.Cell(row, 3).Value = transaction.ActivityType;
                worksheet.Cell(row, 4).Value = transaction.Description;
                worksheet.Cell(row, 5).Value = transaction.Comments;
                worksheet.Cell(row, 6).Value = transaction.Quantity;
                worksheet.Cell(row, 7).Value = transaction.Price;
                worksheet.Cell(row, 8).Value = transaction.CreditsDebits;
                row++;
            }

            // Auto-ajustar colunas
            worksheet.Columns().AdjustToContents();

            // Congelar primeira linha
            worksheet.SheetView.FreezeRows(1);
        }

        using var stream = new MemoryStream();
        workbook.SaveAs(stream);
        return stream.ToArray();
    }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\RotatePdfController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Enums;
using System.IO.Compression;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class RotatePdfController : ControllerBase
{
  private readonly IPdfRotateService _rotateService;
  private readonly ILogger<RotatePdfController> _logger;

  public RotatePdfController(
      IPdfRotateService rotateService,
      ILogger<RotatePdfController> logger)
  {
    _rotateService = rotateService;
    _logger = logger;
  }

  /// <summary>
  /// Gera miniatura de um PDF
  /// </summary>
  [HttpPost("thumbnail")]
  [RequestSizeLimit(16 * 1024 * 1024)] // 16MB
  public async Task<IActionResult> GenerateThumbnail(IFormFile file)
  {
    try
    {
      if (file == null || file.Length == 0)
        return BadRequest("Nenhum arquivo enviado");

      if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
        return BadRequest("Apenas arquivos PDF sÃ£o permitidos");

      _logger.LogInformation("Gerando thumbnail para: {FileName}", file.FileName);

      using var stream = file.OpenReadStream();
      var thumbnailBytes = await _rotateService.GenerateThumbnailAsync(stream);

      // Converter bytes para base64
      var thumbnailBase64 = Convert.ToBase64String(thumbnailBytes);

      // âœ… CORREÃ‡ÃƒO: Usar image/png ao invÃ©s de image/svg+xml
      var dataUrl = $"data:image/png;base64,{thumbnailBase64}";

      _logger.LogInformation("Thumbnail gerado com sucesso: {Size} bytes", thumbnailBytes.Length);

      return Ok(new { thumbnail = dataUrl, fileName = file.FileName });
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "Erro ao gerar miniatura");
      return StatusCode(500, "Erro ao processar arquivo");
    }
  }

  /// <summary>
  /// ObtÃ©m informaÃ§Ãµes de um PDF
  /// </summary>
  [HttpPost("info")]
  [RequestSizeLimit(16 * 1024 * 1024)]
  public async Task<IActionResult> GetPdfInfo(IFormFile file)
  {
    try
    {
      if (file == null || file.Length == 0)
        return BadRequest("Nenhum arquivo enviado");

      if (!file.FileName.EndsWith(".pdf", StringComparison.OrdinalIgnoreCase))
        return BadRequest("Apenas arquivos PDF sÃ£o permitidos");

      using var stream = file.OpenReadStream();
      var info = await _rotateService.GetPdfInfoAsync(stream);
      info.FileName = file.FileName;

      return Ok(info);
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "Erro ao obter informaÃ§Ãµes do PDF");
      return StatusCode(500, "Erro ao processar arquivo");
    }
  }

  /// <summary>
  /// Rotaciona mÃºltiplos PDFs
  /// POST /api/RotatePdf/batch
  /// </summary>
  [HttpPost("batch")]
  [RequestSizeLimit(100 * 1024 * 1024)] // 100MB total
  public async Task<IActionResult> RotateBatch([FromForm] RotatePdfBatchRequest request)
  {
    try
    {
      if (request.Files == null || request.Files.Count == 0)
        return BadRequest("Nenhum arquivo enviado");

      _logger.LogInformation("Processando {Count} arquivo(s) para rotaÃ§Ã£o", request.Files.Count);

      // Preparar streams e rotaÃ§Ãµes
      var pdfStreams = new Dictionary<string, Stream>();
      var rotations = new Dictionary<string, RotationAngle>();

      for (int i = 0; i < request.Files.Count; i++)
      {
        var file = request.Files[i];
        var fileName = file.FileName;

        // Converter graus para RotationAngle enum
        var degrees = i < request.Rotations.Count ? request.Rotations[i] : 0;
        var rotationAngle = ConvertDegreesToRotationAngle(degrees);

        if (rotationAngle != RotationAngle.None)
        {
          pdfStreams[fileName] = file.OpenReadStream();
          rotations[fileName] = rotationAngle;
        }
      }

      if (pdfStreams.Count == 0)
      {
        return BadRequest("Nenhum arquivo com rotaÃ§Ã£o definida");
      }

      // Rotacionar PDFs
      var rotatedFiles = await _rotateService.RotateBatchAsync(pdfStreams, rotations);

      // Se apenas 1 arquivo, retornar diretamente
      if (rotatedFiles.Count == 1)
      {
        var single = rotatedFiles.First();
        var outputName = Path.GetFileNameWithoutExtension(single.Key) + "_rotacionado.pdf";

        return File(single.Value, "application/pdf", outputName);
      }

      // MÃºltiplos arquivos: criar ZIP
      var zipBytes = CreateZip(rotatedFiles);
      var zipName = $"pdfs_rotacionados_{DateTime.Now:yyyyMMdd_HHmmss}.zip";

      _logger.LogInformation("ZIP criado com sucesso: {FileName}", zipName);

      return File(zipBytes, "application/zip", zipName);
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "Erro ao rotacionar PDFs");
      return StatusCode(500, $"Erro ao processar: {ex.Message}");
    }
  }

  /// <summary>
  /// Cria arquivo ZIP com mÃºltiplos PDFs
  /// </summary>
  private static byte[] CreateZip(Dictionary<string, byte[]> files)
  {
    using var zipStream = new MemoryStream();

    // Usar CompressionLevel do System.IO.Compression explicitamente
    using (var archive = new ZipArchive(zipStream, ZipArchiveMode.Create, true))
    {
      foreach (var file in files)
      {
        var entry = archive.CreateEntry(file.Key, System.IO.Compression.CompressionLevel.Optimal);
        using var entryStream = entry.Open();
        entryStream.Write(file.Value, 0, file.Value.Length);
      }
    }

    return zipStream.ToArray();
  }

  /// <summary>
  /// Converte graus para RotationAngle enum
  /// </summary>
  private static RotationAngle ConvertDegreesToRotationAngle(int degrees)
  {
    // Normalizar
    degrees = degrees % 360;
    if (degrees < 0) degrees += 360;

    return degrees switch
    {
      0 => RotationAngle.None,
      90 => RotationAngle.Rotate90,
      180 => RotationAngle.Rotate180,
      270 => RotationAngle.Rotate270,
      _ => RotationAngle.None
    };
  }
}

/// <summary>
/// Request para rotaÃ§Ã£o em lote
/// </summary>
public class RotatePdfBatchRequest
{
  public List<IFormFile> Files { get; set; } = new();
  public List<int> Rotations { get; set; } = new();
  public List<int> Indices { get; set; } = new();
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Controllers\UbsController.cs
----------------------------------------

using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;
using ClosedXML.Excel;

namespace PdfProcessor.API.Controllers;

[ApiController]
[Route("api/[controller]")]
public class UbsController : ControllerBase
{
  private readonly IUbsParser _parser;
  private readonly ILogger<UbsController> _logger;

  public UbsController(IUbsParser parser, ILogger<UbsController> logger)
  {
    _parser = parser;
    _logger = logger;
  }

  [HttpPost("batch")]
  public async Task<IActionResult> ProcessBatch([FromForm] List<IFormFile> files)
  {
    try
    {
      if (files == null || files.Count == 0)
      {
        return BadRequest("Nenhum arquivo enviado");
      }

      _logger.LogInformation($"ðŸ¦ Processando {files.Count} arquivo(s) UBS Switzerland");

      var allTransactions = new List<(string FileName, Core.Models.UbsTransaction Transaction)>();

      // Processar cada PDF
      foreach (var file in files)
      {
        if (file.Length == 0) continue;

        _logger.LogInformation($"ðŸ“„ Processando: {file.FileName}");

        // âœ… Copiar para MemoryStream (padrÃ£o do ItaÃº/BTG)
        using var stream = new MemoryStream();
        await file.CopyToAsync(stream);
        stream.Position = 0;

        var transactions = await _parser.ParsePdfAsync(stream, file.FileName);

        foreach (var transaction in transactions)
        {
          allTransactions.Add((file.FileName, transaction));
        }

        _logger.LogInformation($"âœ… {transactions.Count} transaÃ§Ã£o(Ãµes) extraÃ­da(s) de {file.FileName}");
      }

      if (allTransactions.Count == 0)
      {
        return BadRequest("Nenhuma transaÃ§Ã£o encontrada nos PDFs");
      }

      _logger.LogInformation($"ðŸ“Š Total: {allTransactions.Count} transaÃ§Ã£o(Ãµes)");

      // Gerar Excel
      var excelBytes = GenerateExcel(allTransactions);

      var timestamp = DateTime.Now.ToString("yyyyMMdd_HHmmss");
      var fileName = $"ubs_switzerland_{timestamp}.xlsx";

      return File(excelBytes, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", fileName);
    }
    catch (Exception ex)
    {
      _logger.LogError($"âŒ Erro ao processar PDFs: {ex.Message}");
      return StatusCode(500, $"Erro ao processar: {ex.Message}");
    }
  }

  private byte[] GenerateExcel(List<(string FileName, Core.Models.UbsTransaction Transaction)> transactions)
  {
    using var workbook = new XLWorkbook();

    // âœ… AGRUPAR POR IBAN (cada IBAN = uma aba)
    var groupedByIban = transactions
        .GroupBy(t => t.Transaction.AccountIban)
        .OrderBy(g => g.Key)
        .ToList();

    foreach (var ibanGroup in groupedByIban)
    {
      var iban = ibanGroup.Key;

      // Criar nome da aba (Ãºltimos caracteres do IBAN)
      var sheetName = string.IsNullOrWhiteSpace(iban)
          ? "UBS"
          : iban.Length > 20
              ? iban.Substring(iban.Length - 20)
              : iban;

      // Remover caracteres invÃ¡lidos
      sheetName = sheetName.Replace("/", "-").Replace("\\", "-").Replace(":", "-");

      var worksheet = workbook.Worksheets.Add(sheetName);

      // âœ… CABEÃ‡ALHOS (SEM "Account IBAN")
      var headers = new[]
      {
                "Date",
                "Information",
                "Debits",
                "Credits",
                "Value Date",
                "Balance"
            };

      for (int i = 0; i < headers.Length; i++)
      {
        var cell = worksheet.Cell(1, i + 1);
        cell.Value = headers[i];
        cell.Style.Font.Bold = true;
        cell.Style.Fill.BackgroundColor = XLColor.FromHtml("#1E3A8A"); // Azul UBS
        cell.Style.Font.FontColor = XLColor.White;
        cell.Style.Alignment.Horizontal = XLAlignmentHorizontalValues.Center;
      }

      // âœ… DADOS (SEM coluna Account IBAN)
      int row = 2;
      foreach (var (fileName, transaction) in ibanGroup)
      {
        worksheet.Cell(row, 1).Value = transaction.Date;
        worksheet.Cell(row, 2).Value = transaction.Information;
        worksheet.Cell(row, 3).Value = transaction.Debits;
        worksheet.Cell(row, 4).Value = transaction.Credits;
        worksheet.Cell(row, 5).Value = transaction.ValueDate;
        worksheet.Cell(row, 6).Value = transaction.Balance;
        row++;
      }

      // Auto-ajustar colunas
      worksheet.Columns().AdjustToContents();

      // Congelar primeira linha
      worksheet.SheetView.FreezeRows(1);
    }

    using var stream = new MemoryStream();
    workbook.SaveAs(stream);
    return stream.ToArray();
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.API\Properties\launchSettings.json
----------------------------------------

{
  "$schema": "http://json.schemastore.org/launchsettings.json",
  "profiles": {
    "http": {
      "commandName": "Project",
      "dotnetRunMessages": true,
      "launchBrowser": false,
      "applicationUrl": "http://0.0.0.0:5239",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    }
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Application\Class1.cs
----------------------------------------

namespace PdfProcessor.Application;

public class Class1
{

}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Application\PdfProcessor.Application.csproj
----------------------------------------

<Project Sdk="Microsoft.NET.Sdk">

  <ItemGroup>
    <ProjectReference Include="..\PdfProcessor.Core\PdfProcessor.Core.csproj" />
    <ProjectReference Include="..\PdfProcessor.Infrastructure\PdfProcessor.Infrastructure.csproj" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="AutoMapper" Version="13.0.1" />
    <PackageReference Include="FluentValidation" Version="12.1.0" />
    <PackageReference Include="FluentValidation.DependencyInjectionExtensions" Version="12.1.0" />
    <PackageReference Include="MediatR" Version="13.1.0" />
    <PackageReference Include="Microsoft.AspNetCore.Http.Features" Version="5.0.17" />
  </ItemGroup>

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Application\DTOs\RequestDtos.cs
----------------------------------------

using System;
using System.Collections.Generic;

namespace PdfProcessor.Application.DTOs;

/// <summary>
/// DTO base para requisiÃ§Ãµes de upload
/// Application Layer nÃ£o deve depender de IFormFile (infraestrutura web)
/// </summary>
public class UploadRequestDto
{
  public List<FileUploadDto> Files { get; set; } = new();
  public string BankType { get; set; } = string.Empty;
}

/// <summary>
/// DTO para representar arquivo uploaded (independente de framework web)
/// </summary>
public class FileUploadDto
{
  public string FileName { get; set; } = string.Empty;
  public string ContentType { get; set; } = string.Empty;
  public long Length { get; set; }
  public Stream Content { get; set; } = Stream.Null;
}

/// <summary>
/// DTO para rotaÃ§Ã£o de PDFs
/// </summary>
public class RotatePdfRequestDto
{
  public List<FileUploadDto> Files { get; set; } = new();
  public List<int> RotationAngles { get; set; } = new(); // 90, 180, 270
  public List<int> FileIndices { get; set; } = new();
}

/// <summary>
/// DTO para mesclagem de PDFs
/// </summary>
public class MergePdfRequestDto
{
  public List<FileUploadDto> Files { get; set; } = new();
  public List<int> Order { get; set; } = new();
  public List<string> PageRanges { get; set; } = new(); // "1-5", "all", "1,3,5"
}

/// <summary>
/// DTO para compressÃ£o de PDFs
/// </summary>
public class CompressPdfRequestDto
{
  public List<FileUploadDto> Files { get; set; } = new();
  public List<string> CompressionLevels { get; set; } = new(); // "low", "medium", "high"
  public List<bool> RemoveImages { get; set; } = new();
}

/// <summary>
/// DTO para extraÃ§Ã£o ItaÃº Cash Transactions
/// </summary>
public class ItauCashTransactionsRequestDto
{
  public List<FileUploadDto> Files { get; set; } = new();
}

/// <summary>
/// DTO para extraÃ§Ã£o ItaÃº MovimentaÃ§Ã£o
/// </summary>
public class ItauMovimentacaoRequestDto
{
  public List<FileUploadDto> Files { get; set; } = new();
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Application\DTOs\ResponseDtos.cs
----------------------------------------

namespace PdfProcessor.Application.DTOs;

/// <summary>
/// DTO base para respostas
/// </summary>
public abstract class BaseResponseDto
{
  public bool Success { get; set; }
  public string? Message { get; set; }
  public List<string> Errors { get; set; } = new();
  public List<string> Warnings { get; set; } = new();
}

/// <summary>
/// DTO de resposta para processamento de arquivos
/// </summary>
public class FileProcessingResponseDto : BaseResponseDto
{
  public int ProcessedFiles { get; set; }
  public int FailedFiles { get; set; }
  public byte[]? FileData { get; set; }
  public string? FileName { get; set; }
  public string? ContentType { get; set; }
  public long? FileSizeBytes { get; set; }
  public TimeSpan ProcessingTime { get; set; }
}

/// <summary>
/// DTO de resposta para extraÃ§Ã£o bancÃ¡ria
/// </summary>
public class BankExtractionResponseDto : BaseResponseDto
{
  public byte[] ExcelData { get; set; } = Array.Empty<byte>();
  public string FileName { get; set; } = string.Empty;
  public int TotalAccounts { get; set; }
  public int TotalTransactions { get; set; }
  public Dictionary<string, int> TransactionsByAccount { get; set; } = new();
  public TimeSpan ProcessingTime { get; set; }
}

/// <summary>
/// DTO de resposta para informaÃ§Ãµes de PDF
/// </summary>
public class PdfInfoResponseDto : BaseResponseDto
{
  public int PageCount { get; set; }
  public string FileSize { get; set; } = string.Empty;
  public string? Author { get; set; }
  public string? Title { get; set; }
  public DateTime? CreationDate { get; set; }
  public DateTime? ModificationDate { get; set; }
  public byte[]? ThumbnailData { get; set; }
}

/// <summary>
/// DTO de resposta para rotaÃ§Ã£o de PDFs
/// </summary>
public class RotatePdfResponseDto : BaseResponseDto
{
  public byte[] ZipData { get; set; } = Array.Empty<byte>();
  public string ZipFileName { get; set; } = string.Empty;
  public int RotatedFiles { get; set; }
  public Dictionary<string, string> RotationDetails { get; set; } = new();
}

/// <summary>
/// DTO de resposta para mesclagem de PDFs
/// </summary>
public class MergePdfResponseDto : BaseResponseDto
{
  public byte[] PdfData { get; set; } = Array.Empty<byte>();
  public string FileName { get; set; } = string.Empty;
  public int MergedFiles { get; set; }
  public int TotalPages { get; set; }
  public long FileSizeBytes { get; set; }
}

/// <summary>
/// DTO de resposta para compressÃ£o de PDFs
/// </summary>
public class CompressPdfResponseDto : BaseResponseDto
{
  public byte[] ZipData { get; set; } = Array.Empty<byte>();
  public string ZipFileName { get; set; } = string.Empty;
  public int CompressedFiles { get; set; }
  public long OriginalTotalSize { get; set; }
  public long CompressedTotalSize { get; set; }
  public double AverageCompressionRatio { get; set; }
  public Dictionary<string, CompressionDetailDto> CompressionDetails { get; set; } = new();
}

/// <summary>
/// Detalhes de compressÃ£o de um arquivo
/// </summary>
public class CompressionDetailDto
{
  public long OriginalSize { get; set; }
  public long CompressedSize { get; set; }
  public string CompressionPercentage { get; set; } = string.Empty;
  public bool Success { get; set; }
  public string? ErrorMessage { get; set; }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Class1.cs
----------------------------------------

namespace PdfProcessor.Core;

public class Class1
{

}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\PdfProcessor.Core.csproj
----------------------------------------

<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Entities\BankAccount.cs
----------------------------------------

namespace PdfProcessor.Core.Entities;

/// <summary>
/// Representa uma conta bancÃ¡ria com suas transaÃ§Ãµes
/// </summary>
public class BankAccount
{
    /// <summary>
    /// NÃºmero da conta
    /// </summary>
    public string AccountNumber { get; set; } = string.Empty;

    /// <summary>
    /// Moeda da conta
    /// </summary>
    public string Currency { get; set; } = string.Empty;

    /// <summary>
    /// AgÃªncia (quando aplicÃ¡vel)
    /// </summary>
    public string? Branch { get; set; }

    /// <summary>
    /// Lista de transaÃ§Ãµes da conta
    /// </summary>
    public List<Transaction> Transactions { get; set; } = new();

    /// <summary>
    /// Saldo inicial da conta (se disponÃ­vel)
    /// </summary>
    public decimal? OpeningBalance { get; set; }

    /// <summary>
    /// Saldo final da conta (se disponÃ­vel)
    /// </summary>
    public decimal? ClosingBalance { get; set; }

    /// <summary>
    /// PerÃ­odo inicial das transaÃ§Ãµes
    /// </summary>
    public DateTime? PeriodStart { get; set; }

    /// <summary>
    /// PerÃ­odo final das transaÃ§Ãµes
    /// </summary>
    public DateTime? PeriodEnd { get; set; }

    /// <summary>
    /// Nome completo da conta (ex: "ag 7816 cc 01990-0 - BRL")
    /// </summary>
    public string DisplayName => $"{AccountNumber} - {Currency}";

    /// <summary>
    /// Total de transaÃ§Ãµes
    /// </summary>
    public int TransactionCount => Transactions.Count;

    /// <summary>
    /// Total de crÃ©ditos
    /// </summary>
    public decimal TotalCredits => Transactions.Where(t => t.IsCredit).Sum(t => t.Credit ?? 0);

    /// <summary>
    /// Total de dÃ©bitos
    /// </summary>
    public decimal TotalDebits => Transactions.Where(t => t.IsDebit).Sum(t => t.Debit ?? 0);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Entities\ProcessingResult.cs
----------------------------------------

namespace PdfProcessor.Core.Entities;

/// <summary>
/// Resultado genÃ©rico de processamento com suporte a dados, erros e avisos
/// </summary>
/// <typeparam name="T">Tipo de dados retornado</typeparam>
public class ProcessingResult<T>
{
    /// <summary>
    /// Indica se o processamento foi bem-sucedido
    /// </summary>
    public bool Success { get; set; }

    /// <summary>
    /// Dados resultantes do processamento
    /// </summary>
    public T? Data { get; set; }

    /// <summary>
    /// Lista de erros encontrados
    /// </summary>
    public List<string> Errors { get; set; } = new();

    /// <summary>
    /// Lista de avisos (nÃ£o impedem o processamento)
    /// </summary>
    public List<string> Warnings { get; set; } = new();

    /// <summary>
    /// Quantidade de arquivos processados
    /// </summary>
    public int ProcessedFiles { get; set; }

    /// <summary>
    /// Quantidade de arquivos com erro
    /// </summary>
    public int FailedFiles { get; set; }

    /// <summary>
    /// Tempo de processamento
    /// </summary>
    public TimeSpan ProcessingTime { get; set; }

    /// <summary>
    /// Mensagem adicional de contexto
    /// </summary>
    public string? Message { get; set; }

    /// <summary>
    /// Indica se hÃ¡ erros
    /// </summary>
    public bool HasErrors => Errors.Any();

    /// <summary>
    /// Indica se hÃ¡ avisos
    /// </summary>
    public bool HasWarnings => Warnings.Any();

    /// <summary>
    /// Cria um resultado de sucesso
    /// </summary>
    public static ProcessingResult<T> SuccessResult(T data, string? message = null)
    {
        return new ProcessingResult<T>
        {
            Success = true,
            Data = data,
            Message = message
        };
    }

    /// <summary>
    /// Cria um resultado de erro
    /// </summary>
    public static ProcessingResult<T> ErrorResult(string error, string? message = null)
    {
        return new ProcessingResult<T>
        {
            Success = false,
            Errors = new List<string> { error },
            Message = message
        };
    }

    /// <summary>
    /// Cria um resultado de erro com mÃºltiplos erros
    /// </summary>
    public static ProcessingResult<T> ErrorResult(List<string> errors, string? message = null)
    {
        return new ProcessingResult<T>
        {
            Success = false,
            Errors = errors,
            Message = message
        };
    }

    /// <summary>
    /// Adiciona um erro
    /// </summary>
    public void AddError(string error)
    {
        Errors.Add(error);
        Success = false;
    }

    /// <summary>
    /// Adiciona um aviso
    /// </summary>
    public void AddWarning(string warning)
    {
        Warnings.Add(warning);
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Entities\Transaction.cs
----------------------------------------

namespace PdfProcessor.Core.Entities;

/// <summary>
/// Representa uma transaÃ§Ã£o bancÃ¡ria extraÃ­da de PDF
/// </summary>
public class Transaction
{
    /// <summary>
    /// Data da transaÃ§Ã£o
    /// </summary>
    public DateTime Date { get; set; }

    /// <summary>
    /// DescriÃ§Ã£o/histÃ³rico da transaÃ§Ã£o
    /// </summary>
    public string Description { get; set; } = string.Empty;

    /// <summary>
    /// Valor de dÃ©bito (saÃ­da)
    /// </summary>
    public decimal? Debit { get; set; }

    /// <summary>
    /// Valor de crÃ©dito (entrada)
    /// </summary>
    public decimal? Credit { get; set; }

    /// <summary>
    /// Saldo apÃ³s a transaÃ§Ã£o
    /// </summary>
    public decimal Balance { get; set; }

    /// <summary>
    /// Moeda da transaÃ§Ã£o (USD, BRL, EUR, etc.)
    /// </summary>
    public string Currency { get; set; } = string.Empty;

    /// <summary>
    /// NÃºmero da conta associada
    /// </summary>
    public string AccountNumber { get; set; } = string.Empty;

    /// <summary>
    /// Nome do arquivo de origem
    /// </summary>
    public string SourceFileName { get; set; } = string.Empty;

    /// <summary>
    /// ObtÃ©m o valor da transaÃ§Ã£o (dÃ©bito ou crÃ©dito)
    /// </summary>
    public decimal Amount => Credit ?? Debit ?? 0;

    /// <summary>
    /// Indica se Ã© uma transaÃ§Ã£o de crÃ©dito (entrada)
    /// </summary>
    public bool IsCredit => Credit.HasValue && Credit.Value > 0;

    /// <summary>
    /// Indica se Ã© uma transaÃ§Ã£o de dÃ©bito (saÃ­da)
    /// </summary>
    public bool IsDebit => Debit.HasValue && Debit.Value > 0;
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Enums\BankType.cs
----------------------------------------

namespace PdfProcessor.Core.Enums;

/// <summary>
/// Tipos de bancos suportados pelo sistema
/// </summary>
public enum BankType
{
  /// <summary>
  /// Banco ItaÃº - Cash Transactions
  /// </summary>
  ItauCashTransactions = 1,

  /// <summary>
  /// Banco ItaÃº - MovimentaÃ§Ã£o BancÃ¡ria
  /// </summary>
  ItauMovimentacao = 2,

  /// <summary>
  /// Morgan Stanley
  /// </summary>
  MorganStanley = 3,

  /// <summary>
  /// Julius Baer
  /// </summary>
  JuliusBaer = 4,

  /// <summary>
  /// Julius Bar
  /// </summary>
  JuliusBar = 5,

  /// <summary>
  /// Raymond James
  /// </summary>
  RaymondJames = 6
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Enums\CompressionLevel.cs
----------------------------------------

namespace PdfProcessor.Core.Enums;

/// <summary>
/// NÃ­veis de compressÃ£o de PDF
/// </summary>
public enum CompressionLevel
{
  /// <summary>
  /// CompressÃ£o baixa (maior qualidade)
  /// </summary>
  Low = 1,

  /// <summary>
  /// CompressÃ£o mÃ©dia (balanceado)
  /// </summary>
  Medium = 2,

  /// <summary>
  /// CompressÃ£o alta (menor tamanho)
  /// </summary>
  High = 3
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Enums\RotationAngle.cs
----------------------------------------

namespace PdfProcessor.Core.Enums;

/// <summary>
/// Ã‚ngulos de rotaÃ§Ã£o suportados
/// </summary>
public enum RotationAngle
{
  /// <summary>
  /// Sem rotaÃ§Ã£o
  /// </summary>
  None = 0,

  /// <summary>
  /// 90 graus (sentido horÃ¡rio)
  /// </summary>
  Rotate90 = 90,

  /// <summary>
  /// 180 graus
  /// </summary>
  Rotate180 = 180,

  /// <summary>
  /// 270 graus (90 graus anti-horÃ¡rio)
  /// </summary>
  Rotate270 = 270
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Exceptions\PdfProcessingExceptions.cs
----------------------------------------

namespace PdfProcessor.Core.Exceptions;

/// <summary>
/// ExceÃ§Ã£o base para erros de processamento de PDF
/// </summary>
public class PdfProcessingException : Exception
{
  public string? FileName { get; set; }
  public string? Details { get; set; }

  public PdfProcessingException(string message) : base(message)
  {
  }

  public PdfProcessingException(string message, Exception innerException)
      : base(message, innerException)
  {
  }

  public PdfProcessingException(string message, string fileName) : base(message)
  {
    FileName = fileName;
  }

  public PdfProcessingException(string message, string fileName, string details)
      : base(message)
  {
    FileName = fileName;
    Details = details;
  }
}

/// <summary>
/// ExceÃ§Ã£o para erros no parsing de dados bancÃ¡rios
/// </summary>
public class ParserException : PdfProcessingException
{
  public string? BankName { get; set; }
  public string? Section { get; set; }

  public ParserException(string message) : base(message)
  {
  }

  public ParserException(string message, string bankName, string fileName)
      : base(message, fileName)
  {
    BankName = bankName;
  }

  public ParserException(string message, Exception innerException)
      : base(message, innerException)
  {
  }
}

/// <summary>
/// ExceÃ§Ã£o para PDFs invÃ¡lidos ou corrompidos
/// </summary>
public class InvalidPdfException : PdfProcessingException
{
  public InvalidPdfException(string message) : base(message)
  {
  }

  public InvalidPdfException(string message, string fileName)
      : base(message, fileName)
  {
  }

  public InvalidPdfException(string message, Exception innerException)
      : base(message, innerException)
  {
  }
}

/// <summary>
/// ExceÃ§Ã£o para arquivos muito grandes
/// </summary>
public class FileTooLargeException : PdfProcessingException
{
  public long FileSize { get; set; }
  public long MaxSize { get; set; }

  public FileTooLargeException(string fileName, long fileSize, long maxSize)
      : base($"File '{fileName}' is too large. Size: {fileSize / 1024 / 1024}MB, Max: {maxSize / 1024 / 1024}MB", fileName)
  {
    FileSize = fileSize;
    MaxSize = maxSize;
  }
}

/// <summary>
/// ExceÃ§Ã£o para formato de arquivo nÃ£o suportado
/// </summary>
public class UnsupportedFormatException : PdfProcessingException
{
  public string? ProvidedFormat { get; set; }
  public string[]? SupportedFormats { get; set; }

  public UnsupportedFormatException(string message) : base(message)
  {
  }

  public UnsupportedFormatException(string fileName, string providedFormat, string[] supportedFormats)
      : base($"File '{fileName}' has unsupported format '{providedFormat}'. Supported: {string.Join(", ", supportedFormats)}", fileName)
  {
    ProvidedFormat = providedFormat;
    SupportedFormats = supportedFormats;
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IBankParser.cs
----------------------------------------

namespace PdfProcessor.Core.Interfaces;

using PdfProcessor.Core.Entities;

/// <summary>
/// Interface base para parsers de bancos especÃ­ficos
/// </summary>
/// <typeparam name="T">Tipo de dado extraÃ­do (geralmente BankAccount ou Transaction)</typeparam>
public interface IBankParser<T>
{
  /// <summary>
  /// Nome do banco
  /// </summary>
  string BankName { get; }

  /// <summary>
  /// Formatos/seÃ§Ãµes suportados pelo parser
  /// </summary>
  string[] SupportedFormats { get; }

  /// <summary>
  /// Processa um Ãºnico PDF
  /// </summary>
  /// <param name="pdfStream">Stream do arquivo PDF</param>
  /// <param name="fileName">Nome do arquivo</param>
  /// <returns>Resultado do processamento</returns>
  Task<ProcessingResult<List<T>>> ParseAsync(Stream pdfStream, string fileName);

  /// <summary>
  /// Processa mÃºltiplos PDFs em lote
  /// </summary>
  /// <param name="files">DicionÃ¡rio com nome do arquivo e stream</param>
  /// <returns>Resultado consolidado do processamento</returns>
  Task<ProcessingResult<Dictionary<string, List<T>>>> ParseBatchAsync(
      Dictionary<string, Stream> files);

  /// <summary>
  /// Valida se o PDF pode ser processado por este parser
  /// </summary>
  /// <param name="pdfStream">Stream do arquivo PDF</param>
  /// <returns>True se o parser pode processar o PDF</returns>
  Task<bool> CanParseAsync(Stream pdfStream);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IBtgParser.cs
----------------------------------------

using PdfProcessor.Core.Models;

namespace PdfProcessor.Core.Interfaces;

public interface IBtgParser
{
    Task<List<BtgTransaction>> ParsePdfAsync(Stream pdfStream, string fileName);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IExcelGeneratorService.cs
----------------------------------------

namespace PdfProcessor.Core.Interfaces;

using PdfProcessor.Core.Entities;

/// <summary>
/// ServiÃ§o para geraÃ§Ã£o de arquivos Excel
/// </summary>
public interface IExcelGeneratorService
{
  /// <summary>
  /// Gera um arquivo Excel com mÃºltiplas abas
  /// </summary>
  /// <typeparam name="T">Tipo dos dados a serem exportados</typeparam>
  /// <param name="dataBySheet">DicionÃ¡rio com nome da aba e lista de dados</param>
  /// <param name="sheetOptions">OpÃ§Ãµes de formataÃ§Ã£o por aba</param>
  /// <returns>Array de bytes do arquivo Excel</returns>
  Task<byte[]> GenerateExcelAsync<T>(
      Dictionary<string, List<T>> dataBySheet,
      Dictionary<string, ExcelSheetOptions>? sheetOptions = null) where T : class;

  /// <summary>
  /// Gera Excel a partir de contas bancÃ¡rias
  /// </summary>
  /// <param name="accounts">DicionÃ¡rio com identificador da conta e dados</param>
  /// <param name="bankName">Nome do banco (para tÃ­tulo)</param>
  /// <returns>Array de bytes do arquivo Excel</returns>
  Task<byte[]> GenerateBankAccountsExcelAsync(
      Dictionary<string, BankAccount> accounts,
      string bankName = "Bank Statement");

  /// <summary>
  /// Gera Excel a partir de transaÃ§Ãµes agrupadas
  /// </summary>
  /// <param name="transactionsByAccount">TransaÃ§Ãµes agrupadas por conta</param>
  /// <param name="bankName">Nome do banco</param>
  /// <returns>Array de bytes do arquivo Excel</returns>
  Task<byte[]> GenerateTransactionsExcelAsync(
      Dictionary<string, List<Transaction>> transactionsByAccount,
      string bankName = "Transactions");
}

/// <summary>
/// OpÃ§Ãµes de formataÃ§Ã£o para uma aba do Excel
/// </summary>
public class ExcelSheetOptions
{
  /// <summary>
  /// TÃ­tulo da aba (se diferente do nome)
  /// </summary>
  public string? Title { get; set; }

  /// <summary>
  /// Aplicar auto-filtro nas colunas
  /// </summary>
  public bool AutoFilter { get; set; } = true;

  /// <summary>
  /// Congelar primeira linha (cabeÃ§alho)
  /// </summary>
  public bool FreezeHeaderRow { get; set; } = true;

  /// <summary>
  /// Ajustar largura das colunas automaticamente
  /// </summary>
  public bool AutoFitColumns { get; set; } = true;

  /// <summary>
  /// Aplicar formataÃ§Ã£o de tabela
  /// </summary>
  public bool FormatAsTable { get; set; } = true;

  /// <summary>
  /// Incluir linha de totais
  /// </summary>
  public bool IncludeTotalsRow { get; set; } = false;

  /// <summary>
  /// Colunas numÃ©ricas para formatar como moeda
  /// </summary>
  public List<string> CurrencyColumns { get; set; } = new();

  /// <summary>
  /// Colunas de data para formatar
  /// </summary>
  public List<string> DateColumns { get; set; } = new();
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IItauCash2Parser.cs
----------------------------------------

using PdfProcessor.Core.Models;

namespace PdfProcessor.Core.Interfaces;

public interface IItauCash2Parser
{
    Task<byte[]> ProcessBatchAsync(List<Stream> pdfStreams, bool debugMode = false);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IItauCashParser.cs
----------------------------------------

using PdfProcessor.Core.Models;

namespace PdfProcessor.Core.Interfaces;

/// <summary>
/// Interface para parser de Cash Transactions do ItaÃº
/// </summary>
public interface IItauCashParser
{
    /// <summary>
    /// Processa mÃºltiplos PDFs de Cash Transactions do ItaÃº
    /// </summary>
    /// <param name="pdfStreams">Lista de streams dos PDFs</param>
    /// <returns>Bytes do Excel consolidado com mÃºltiplas abas (uma por conta/moeda)</returns>
    Task<byte[]> ProcessBatchAsync(List<Stream> pdfStreams);
    
    /// <summary>
    /// Extrai Cash Transactions de um Ãºnico PDF
    /// </summary>
    /// <param name="pdfStream">Stream do PDF</param>
    /// <returns>DicionÃ¡rio com chave = "NUMERO_MOEDA" (ex: "6086454001_USD") e valor = lista de transaÃ§Ãµes</returns>
    Task<Dictionary<string, List<ItauCashTransaction>>> ExtractCashTransactionsAsync(Stream pdfStream);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IItauMovimentacaoParser.cs
----------------------------------------

using PdfProcessor.Core.Models;

namespace PdfProcessor.Core.Interfaces;

public interface IItauMovimentacaoParser
{
    /// <summary>
    /// Processa mÃºltiplos PDFs de movimentaÃ§Ã£o do ItaÃº
    /// </summary>
    /// <param name="pdfStreams">Lista de streams dos PDFs</param>
    /// <returns>Bytes do Excel consolidado com mÃºltiplas abas</returns>
    Task<byte[]> ProcessBatchAsync(List<Stream> pdfStreams);
    
    /// <summary>
    /// Extrai movimentaÃ§Ãµes de um Ãºnico PDF
    /// </summary>
    /// <param name="pdfStream">Stream do PDF</param>
    /// <returns>DicionÃ¡rio com chave = "AG XXXX - CC XXXXX" e valor = lista de transaÃ§Ãµes</returns>
    Task<Dictionary<string, List<ItauTransaction>>> ExtractMovimentacaoAsync(Stream pdfStream);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IMorganStanleyParser.cs
----------------------------------------

using PdfProcessor.Core.Models;

namespace PdfProcessor.Core.Interfaces;

public interface IMorganStanleyParser
{
  Task<List<MorganStanleyTransaction>> ParsePdfAsync(Stream pdfStream, string fileName);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IPdfCompressService.cs
----------------------------------------

namespace PdfProcessor.Core.Interfaces;

using PdfProcessor.Core.Enums;

/// <summary>
/// ServiÃ§o para compressÃ£o de arquivos PDF
/// </summary>
public interface IPdfCompressService
{
  /// <summary>
  /// Comprime um Ãºnico PDF
  /// </summary>
  /// <param name="pdfStream">Stream do PDF</param>
  /// <param name="compressionLevel">NÃ­vel de compressÃ£o</param>
  /// <param name="removeImages">Se true, remove todas as imagens</param>
  /// <param name="fileName">Nome do arquivo original</param>
  /// <returns>Resultado da compressÃ£o</returns>
  Task<CompressionResult> CompressPdfAsync(
      Stream pdfStream,
      CompressionLevel compressionLevel,
      bool removeImages = false,
      string fileName = "");

  /// <summary>
  /// Comprime mÃºltiplos PDFs
  /// </summary>
  /// <param name="files">DicionÃ¡rio com nome e stream dos arquivos</param>
  /// <param name="compressionSettings">ConfiguraÃ§Ãµes de compressÃ£o por arquivo</param>
  /// <returns>DicionÃ¡rio com resultados da compressÃ£o</returns>
  Task<Dictionary<string, CompressionResult>> CompressBatchAsync(
      Dictionary<string, Stream> files,
      Dictionary<string, CompressionSettings> compressionSettings);
}

/// <summary>
/// Resultado de uma operaÃ§Ã£o de compressÃ£o
/// </summary>
public class CompressionResult
{
  public bool Success { get; set; }
  public byte[]? CompressedData { get; set; }
  public long OriginalSizeBytes { get; set; }
  public long CompressedSizeBytes { get; set; }
  public double CompressionRatio => OriginalSizeBytes > 0
      ? (double)CompressedSizeBytes / OriginalSizeBytes
      : 0;
  public string CompressionPercentage => $"{(1 - CompressionRatio) * 100:F2}%";
  public string OriginalSizeMB => $"{OriginalSizeBytes / 1024.0 / 1024.0:F2} MB";
  public string CompressedSizeMB => $"{CompressedSizeBytes / 1024.0 / 1024.0:F2} MB";
  public string? ErrorMessage { get; set; }
}

/// <summary>
/// ConfiguraÃ§Ãµes de compressÃ£o para um arquivo
/// </summary>
public class CompressionSettings
{
  public CompressionLevel Level { get; set; } = CompressionLevel.Medium;
  public bool RemoveImages { get; set; } = false;
  public int? ImageQuality { get; set; } = 85; // 1-100
  public int? MaxImageDpi { get; set; } = 150;
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IPdfEditService.cs
----------------------------------------

namespace PdfProcessor.Core.Interfaces;

/// <summary>
/// ServiÃ§o para ediÃ§Ã£o de PDFs (rotaÃ§Ã£o e remoÃ§Ã£o de pÃ¡ginas)
/// </summary>
public interface IPdfEditService
{
  /// <summary>
  /// Gera thumbnail de uma pÃ¡gina especÃ­fica do PDF
  /// </summary>
  /// <param name="pdfStream">Stream do PDF</param>
  /// <param name="pageNumber">NÃºmero da pÃ¡gina (1-based)</param>
  /// <param name="maxWidth">Largura mÃ¡xima da thumbnail</param>
  /// <returns>Thumbnail em base64</returns>
  Task<string> GeneratePageThumbnailAsync(Stream pdfStream, int pageNumber, int maxWidth = 200);

  /// <summary>
  /// ObtÃ©m o nÃºmero total de pÃ¡ginas do PDF
  /// </summary>
  /// <param name="pdfStream">Stream do PDF</param>
  /// <returns>NÃºmero de pÃ¡ginas</returns>
  Task<int> GetPageCountAsync(Stream pdfStream);

  /// <summary>
  /// Processa PDF aplicando rotaÃ§Ãµes e removendo pÃ¡ginas
  /// </summary>
  /// <param name="pdfStream">Stream do PDF original</param>
  /// <param name="pageOperations">Lista de operaÃ§Ãµes por pÃ¡gina</param>
  /// <param name="originalFileName">Nome do arquivo original</param>
  /// <returns>Resultado do processamento</returns>
  Task<PdfEditResult> ProcessPdfAsync(
      Stream pdfStream,
      List<PageOperation> pageOperations,
      string originalFileName = "");
}

/// <summary>
/// OperaÃ§Ã£o a ser aplicada em uma pÃ¡gina especÃ­fica
/// </summary>
public class PageOperation
{
  /// <summary>
  /// NÃºmero da pÃ¡gina (1-based)
  /// </summary>
  public int PageNumber { get; set; }

  /// <summary>
  /// RotaÃ§Ã£o a ser aplicada (0, 90, 180, 270)
  /// </summary>
  public int Rotation { get; set; }

  /// <summary>
  /// Se true, mantÃ©m a pÃ¡gina; se false, remove
  /// </summary>
  public bool Keep { get; set; }
}

/// <summary>
/// Resultado do processamento de ediÃ§Ã£o
/// </summary>
public class PdfEditResult
{
  public bool Success { get; set; }
  public byte[]? ProcessedPdfData { get; set; }
  public int OriginalPageCount { get; set; }
  public int FinalPageCount { get; set; }
  public int PagesRotated { get; set; }
  public int PagesRemoved { get; set; }
  public string? ErrorMessage { get; set; }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IPdfMergeService.cs
----------------------------------------

namespace PdfProcessor.Core.Interfaces;

/// <summary>
/// ServiÃ§o para mesclar/unir arquivos PDF
/// </summary>
public interface IPdfMergeService
{
  /// <summary>
  /// Mescla mÃºltiplos PDFs em um Ãºnico arquivo
  /// </summary>
  /// <param name="files">DicionÃ¡rio ordenado com nome e stream dos arquivos</param>
  /// <param name="pageRanges">Ranges de pÃ¡ginas para cada arquivo (opcional)</param>
  /// <returns>Array de bytes do PDF mesclado</returns>
  Task<byte[]> MergePdfsAsync(
      Dictionary<string, Stream> files,
      Dictionary<string, string>? pageRanges = null);

  /// <summary>
  /// Valida um range de pÃ¡ginas (ex: "1-5", "1,3,5", "all")
  /// </summary>
  /// <param name="pageRange">Range de pÃ¡ginas</param>
  /// <param name="totalPages">Total de pÃ¡ginas do PDF</param>
  /// <returns>Lista de nÃºmeros de pÃ¡ginas vÃ¡lidas</returns>
  List<int> ParsePageRange(string pageRange, int totalPages);

  /// <summary>
  /// Extrai pÃ¡ginas especÃ­ficas de um PDF
  /// </summary>
  /// <param name="pdfStream">Stream do PDF</param>
  /// <param name="pageNumbers">NÃºmeros das pÃ¡ginas a extrair (1-indexed)</param>
  /// <returns>Array de bytes do PDF com as pÃ¡ginas extraÃ­das</returns>
  Task<byte[]> ExtractPagesAsync(Stream pdfStream, List<int> pageNumbers);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IPdfRotateService.cs
----------------------------------------

namespace PdfProcessor.Core.Interfaces;

using PdfProcessor.Core.Enums;

/// <summary>
/// ServiÃ§o para rotaÃ§Ã£o de arquivos PDF
/// </summary>
public interface IPdfRotateService
{
  /// <summary>
  /// Rotaciona um Ãºnico PDF
  /// </summary>
  /// <param name="pdfStream">Stream do PDF</param>
  /// <param name="rotationAngle">Ã‚ngulo de rotaÃ§Ã£o</param>
  /// <param name="fileName">Nome do arquivo original</param>
  /// <returns>Array de bytes do PDF rotacionado</returns>
  Task<byte[]> RotatePdfAsync(Stream pdfStream, RotationAngle rotationAngle, string fileName);

  /// <summary>
  /// Rotaciona mÃºltiplos PDFs com diferentes Ã¢ngulos
  /// </summary>
  /// <param name="files">DicionÃ¡rio com nome e stream dos arquivos</param>
  /// <param name="rotations">DicionÃ¡rio com nome e Ã¢ngulo de rotaÃ§Ã£o</param>
  /// <returns>DicionÃ¡rio com nome e bytes dos PDFs rotacionados</returns>
  Task<Dictionary<string, byte[]>> RotateBatchAsync(
      Dictionary<string, Stream> files,
      Dictionary<string, RotationAngle> rotations);

  /// <summary>
  /// Gera miniatura (thumbnail) da primeira pÃ¡gina do PDF
  /// </summary>
  /// <param name="pdfStream">Stream do PDF</param>
  /// <param name="width">Largura da miniatura em pixels</param>
  /// <param name="height">Altura da miniatura em pixels</param>
  /// <returns>Array de bytes da imagem PNG</returns>
  Task<byte[]> GenerateThumbnailAsync(Stream pdfStream, int width = 200, int height = 200);

  /// <summary>
  /// ObtÃ©m informaÃ§Ãµes do PDF (nÃºmero de pÃ¡ginas, tamanho, etc.)
  /// </summary>
  /// <param name="pdfStream">Stream do PDF</param>
  /// <returns>InformaÃ§Ãµes do PDF</returns>
  Task<PdfInfo> GetPdfInfoAsync(Stream pdfStream);
}

/// <summary>
/// InformaÃ§Ãµes de um arquivo PDF
/// </summary>
public class PdfInfo
{
  public int PageCount { get; set; }
  public long FileSizeBytes { get; set; }
  public string FileSizeMB => $"{FileSizeBytes / 1024.0 / 1024.0:F2} MB";
  public DateTime? CreationDate { get; set; }
  public DateTime? ModificationDate { get; set; }
  public string? Author { get; set; }
  public string? Title { get; set; }
  public string? Subject { get; set; }
  public string? FileName { get; set; }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Interfaces\IUbsParser.cs
----------------------------------------

using PdfProcessor.Core.Models;

namespace PdfProcessor.Core.Interfaces;

public interface IUbsParser
{
  Task<List<UbsTransaction>> ParsePdfAsync(Stream pdfStream, string fileName);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Models\BtgTransaction.cs
----------------------------------------

namespace PdfProcessor.Core.Models;

public class BtgTransaction
{
    public string ProcessSettlementDate { get; set; } = string.Empty;
    public string TradeTransactionDate { get; set; } = string.Empty;
    public string ActivityType { get; set; } = string.Empty;
    public string Description { get; set; } = string.Empty;
    public string Quantity { get; set; } = string.Empty;
    public string Price { get; set; } = string.Empty;
    public string AccruedInterest { get; set; } = string.Empty;
    public string Amount { get; set; } = string.Empty;
    public string Currency { get; set; } = string.Empty;
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Models\ItauCash2Transaction.cs
----------------------------------------

namespace PdfProcessor.Core.Models;

public class ItauCash2Transaction
{
    public string OperationDate { get; set; } = "";
    public string ValueDate { get; set; } = "";
    public string Description { get; set; } = "";
    public string Value { get; set; } = "";
    public string AccountBalance { get; set; } = "";
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Models\ItauCashTransaction.cs
----------------------------------------

namespace PdfProcessor.Core.Models;

/// <summary>
/// Representa uma transaÃ§Ã£o de cash do extrato ItaÃº
/// </summary>
public class ItauCashTransaction
{
    /// <summary>
    /// Data da operaÃ§Ã£o (formato: DD/MM/YYYY)
    /// </summary>
    public string OperationDate { get; set; } = string.Empty;
    
    /// <summary>
    /// Data do valor (formato: DD/MM/YYYY)
    /// </summary>
    public string ValueDate { get; set; } = string.Empty;
    
    /// <summary>
    /// DescriÃ§Ã£o da transaÃ§Ã£o
    /// </summary>
    public string Description { get; set; } = string.Empty;
    
    /// <summary>
    /// Valor da transaÃ§Ã£o (pode ser negativo)
    /// </summary>
    public string Value { get; set; } = string.Empty;
    
    /// <summary>
    /// Saldo da conta apÃ³s a transaÃ§Ã£o
    /// </summary>
    public string AccountBalance { get; set; } = string.Empty;
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Models\ItauTransaction.cs
----------------------------------------

namespace PdfProcessor.Core.Models;

/// <summary>
/// Representa uma transaÃ§Ã£o bancÃ¡ria do extrato ItaÃº
/// </summary>
public class ItauTransaction
{
    /// <summary>
    /// Data da transaÃ§Ã£o (formato: dd/MM)
    /// </summary>
    public string Data { get; set; } = string.Empty;
    
    /// <summary>
    /// DescriÃ§Ã£o da movimentaÃ§Ã£o
    /// </summary>
    public string Descricao { get; set; } = string.Empty;
    
    /// <summary>
    /// Valor de entrada/crÃ©dito (formato: "1.234,56")
    /// </summary>
    public string EntradasRS { get; set; } = string.Empty;
    
    /// <summary>
    /// Valor de saÃ­da/dÃ©bito (formato: "1.234,56-")
    /// </summary>
    public string SaidasRS { get; set; } = string.Empty;
    
    /// <summary>
    /// Saldo apÃ³s a transaÃ§Ã£o (formato: "1.234,56")
    /// </summary>
    public string SaldoRS { get; set; } = string.Empty;
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Models\MorganStanleyTransaction.cs
----------------------------------------

namespace PdfProcessor.Core.Models;

public class MorganStanleyTransaction
{
  public string AccountNumber { get; set; } = "";
  public string ActivityDate { get; set; } = "";
  public string SettlementDate { get; set; } = "";
  public string ActivityType { get; set; } = "";
  public string Description { get; set; } = "";
  public string Comments { get; set; } = "";
  public string Quantity { get; set; } = "";
  public string Price { get; set; } = "";
  public string CreditsDebits { get; set; } = "";
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Core\Models\UbsTransaction.cs
----------------------------------------

namespace PdfProcessor.Core.Models;

public class UbsTransaction
{
  public string AccountIban { get; set; } = "";
  public string Date { get; set; } = "";
  public string Information { get; set; } = "";
  public string Debits { get; set; } = "";
  public string Credits { get; set; } = "";
  public string ValueDate { get; set; } = "";
  public string Balance { get; set; } = "";
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\Class1.cs
----------------------------------------

namespace PdfProcessor.Infrastructure;

public class Class1
{

}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\PdfProcessor.Infrastructure.csproj
----------------------------------------

<Project Sdk="Microsoft.NET.Sdk">

  <ItemGroup>
    <ProjectReference Include="..\PdfProcessor.Core\PdfProcessor.Core.csproj" />
    <ProjectReference Include="..\PdfProcessor.Shared\PdfProcessor.Shared.csproj" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="ClosedXML" Version="0.102.1" />
    <PackageReference Include="Docnet.Core" Version="2.6.0" />
    <PackageReference Include="itext7" Version="8.0.2" />
    <PackageReference Include="SkiaSharp" Version="2.88.8" />
    <PackageReference Include="iTextSharp" Version="5.5.13.3" />
    <PackageReference Include="PdfSharp" Version="6.2.2" />
    <PackageReference Include="SixLabors.ImageSharp" Version="3.1.7" />
    <PackageReference Include="itext7.bouncy-castle-adapter" Version="8.0.2" />
  </ItemGroup>

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\Parsers\BtgParser.cs
----------------------------------------

using iTextSharp.text.pdf;
using iTextSharp.text.pdf.parser;
using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Models;
using System.Text.RegularExpressions;

namespace PdfProcessor.Infrastructure.Parsers;

public class BtgParser : IBtgParser
{
    // âœ… POSIÃ‡Ã•ES CORRETAS (ajustadas manualmente)
    private class ColumnRanges
    {
        public float ProcessDateStart = 30;
        public float ProcessDateEnd = 74;
        
        public float TradeDateStart = 74;
        public float TradeDateEnd = 112;
        
        public float ActivityStart = 112;
        public float ActivityEnd = 252;
        
        public float DescriptionStart = 252;
        public float DescriptionEnd = 400;
        
        public float QuantityStart = 400;
        public float QuantityEnd = 465;
        
        public float PriceStart = 465;
        public float PriceEnd = 533;
        
        public float AccruedStart = 534;
        public float AccruedEnd = 640;
        
        public float AmountStart = 640;
        public float AmountEnd = 701;
        
        public float CurrencyStart = 701;
        public float CurrencyEnd = 800;
    }

    public async Task<List<BtgTransaction>> ParsePdfAsync(Stream pdfStream, string fileName)
    {
        var transactions = new List<BtgTransaction>();

        return await Task.Run(() =>
        {
            try
            {
                Console.WriteLine($"ðŸ“„ Processando {fileName}");
                
                pdfStream.Position = 0;
                using var pdfReader = new PdfReader(pdfStream);
                
                int totalPages = pdfReader.NumberOfPages;

                for (int pageNum = 1; pageNum <= totalPages; pageNum++)
                {
                    var text = PdfTextExtractor.GetTextFromPage(pdfReader, pageNum);

                    if (!text.Contains("Transactions in Date Sequence"))
                    {
                        continue;
                    }

                    Console.WriteLine($"\nðŸ“„ === PÃGINA {pageNum} ===");
                    
                    var pageTransactions = ExtractTransactionsWithPosition(pdfReader, pageNum);
                    transactions.AddRange(pageTransactions);

                    Console.WriteLine($"âœ… {pageTransactions.Count} transaÃ§Ã£o(Ãµes) extraÃ­da(s)");
                }

                Console.WriteLine($"\nâœ… Total: {transactions.Count} transaÃ§Ã£o(Ãµes)");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"âŒ Erro: {ex.Message}");
                throw;
            }

            return transactions;
        });
    }

    private List<BtgTransaction> ExtractTransactionsWithPosition(PdfReader reader, int pageNum)
    {
        var transactions = new List<BtgTransaction>();
        var columns = new ColumnRanges();

        try
        {
            var strategy = new LocationTextExtractionStrategyEx();
            var pageText = PdfTextExtractor.GetTextFromPage(reader, pageNum, strategy);
            
            var chunks = strategy.GetTextChunks();

            // Agrupar por linha (Y)
            var lineGroups = chunks
                .GroupBy(c => Math.Round(c.Y, 1))
                .OrderByDescending(g => g.Key)
                .ToList();

            bool inTableSection = false;
            BtgTransaction? currentTransaction = null;

            foreach (var lineGroup in lineGroups)
            {
                var lineChunks = lineGroup.OrderBy(c => c.X).ToList();
                var lineText = string.Join("", lineChunks.Select(c => c.Text));

                // Detectar inÃ­cio
                if (lineText.Contains("Transactions in Date Sequence"))
                {
                    inTableSection = true;
                    continue;
                }

                // Detectar fim
                if (lineText.Contains("Total Value of Transactions"))
                {
                    break;
                }

                // Pular cabeÃ§alhos
                if (lineText.Contains("Process") && lineText.Contains("Activity Type"))
                {
                    continue;
                }

                if (!inTableSection)
                {
                    continue;
                }

                // âœ… VERIFICAR SE Ã‰ NOVA TRANSAÃ‡ÃƒO OU CONTINUAÃ‡ÃƒO
                var processDate = GetTextInRange(lineChunks, columns.ProcessDateStart, columns.ProcessDateEnd);
                
                // Se tem data = NOVA transaÃ§Ã£o
                if (!string.IsNullOrWhiteSpace(processDate) && Regex.IsMatch(processDate, @"\d{2}/\d{2}/\d{2}"))
                {
                    // Salvar transaÃ§Ã£o anterior se existir
                    if (currentTransaction != null)
                    {
                        transactions.Add(currentTransaction);
                    }
                    
                    // Criar nova transaÃ§Ã£o
                    currentTransaction = new BtgTransaction();
                    currentTransaction.ProcessSettlementDate = processDate;
                    currentTransaction.TradeTransactionDate = GetTextInRange(lineChunks, columns.TradeDateStart, columns.TradeDateEnd);
                    currentTransaction.ActivityType = GetTextInRange(lineChunks, columns.ActivityStart, columns.ActivityEnd);
                    currentTransaction.Description = GetTextInRange(lineChunks, columns.DescriptionStart, columns.DescriptionEnd);
                    currentTransaction.Quantity = GetTextInRange(lineChunks, columns.QuantityStart, columns.QuantityEnd);
                    currentTransaction.Price = GetTextInRange(lineChunks, columns.PriceStart, columns.PriceEnd);
                    currentTransaction.AccruedInterest = GetTextInRange(lineChunks, columns.AccruedStart, columns.AccruedEnd);
                    currentTransaction.Amount = GetTextInRange(lineChunks, columns.AmountStart, columns.AmountEnd);
                    currentTransaction.Currency = GetTextInRange(lineChunks, columns.CurrencyStart, columns.CurrencyEnd);
                    
                    Console.WriteLine($"   âœ“ Nova: {currentTransaction.ProcessSettlementDate} | {currentTransaction.ActivityType}");
                }
                // Se NÃƒO tem data = CONTINUAÃ‡ÃƒO da anterior
                else if (currentTransaction != null)
                {
                    var activityContinuation = GetTextInRange(lineChunks, columns.ActivityStart, columns.ActivityEnd);
                    var descriptionContinuation = GetTextInRange(lineChunks, columns.DescriptionStart, columns.DescriptionEnd);
                    
                    if (!string.IsNullOrWhiteSpace(activityContinuation))
                    {
                        currentTransaction.ActivityType += " " + activityContinuation;
                        Console.WriteLine($"     + Activity: {activityContinuation}");
                    }
                    
                    if (!string.IsNullOrWhiteSpace(descriptionContinuation))
                    {
                        currentTransaction.Description += " " + descriptionContinuation;
                        Console.WriteLine($"     + Description: {descriptionContinuation}");
                    }
                }
            }
            
            // âœ… Adicionar Ãºltima transaÃ§Ã£o
            if (currentTransaction != null)
            {
                transactions.Add(currentTransaction);
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"âŒ Erro ao processar pÃ¡gina {pageNum}: {ex.Message}");
        }

        return transactions;
    }

    private string GetTextInRange(List<TextChunkEx> chunks, float startX, float endX)
    {
        var textsInRange = chunks
            .Where(c => c.X >= startX && c.X < endX)
            .OrderBy(c => c.X)
            .Select(c => c.Text)
            .ToList();

        return string.Join(" ", textsInRange).Trim();
    }

    private class TextChunkEx
    {
        public string Text { get; set; } = "";
        public float X { get; set; }
        public float Y { get; set; }
    }

    private class LocationTextExtractionStrategyEx : LocationTextExtractionStrategy
    {
        private List<TextChunkEx> chunks = new List<TextChunkEx>();

        public override void RenderText(TextRenderInfo renderInfo)
        {
            base.RenderText(renderInfo);

            var bottomLeft = renderInfo.GetBaseline().GetStartPoint();
            var text = renderInfo.GetText();

            if (!string.IsNullOrWhiteSpace(text))
            {
                chunks.Add(new TextChunkEx
                {
                    Text = text,
                    X = bottomLeft[iTextSharp.text.pdf.parser.Vector.I1],
                    Y = bottomLeft[iTextSharp.text.pdf.parser.Vector.I2]
                });
            }
        }

        public List<TextChunkEx> GetTextChunks()
        {
            return chunks;
        }
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\Parsers\ItauCash2Parser.cs
----------------------------------------

using iText.Kernel.Pdf;
using iText.Kernel.Pdf.Canvas.Parser;
using iText.Kernel.Pdf.Canvas.Parser.Listener;
using ClosedXML.Excel;
using System.Text;
using System.Text.RegularExpressions;
using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Models;

namespace PdfProcessor.Infrastructure.Parsers;

public class ItauCash2Parser : IItauCash2Parser
{
    private readonly ILogger<ItauCash2Parser> _logger;

    // ðŸ”§ COORDENADAS - SerÃ£o ajustadas apÃ³s anÃ¡lise do modo DEBUG
    private const float OPERATION_DATE_X_MIN = 0f;
    private const float OPERATION_DATE_X_MAX = 100f;
    
    private const float VALUE_DATE_X_MIN = 100f;
    private const float VALUE_DATE_X_MAX = 180f;
    
    private const float DESCRIPTION_X_MIN = 180f;
    private const float DESCRIPTION_X_MAX = 450f;
    
    private const float VALUE_X_MIN = 450f;
    private const float VALUE_X_MAX = 530f;
    
    private const float BALANCE_X_MIN = 530f;
    private const float BALANCE_X_MAX = 650f;

    public ItauCash2Parser(ILogger<ItauCash2Parser> logger)
    {
        _logger = logger;
    }

    public async Task<byte[]> ProcessBatchAsync(List<Stream> pdfStreams, bool debugMode = false)
    {
        _logger.LogInformation($"ðŸ¦ Processando {pdfStreams.Count} PDF(s) ItaÃº Cash 2.0 - Modo: {(debugMode ? "DEBUG" : "PRODUÃ‡ÃƒO")}");

        if (debugMode)
        {
            return await GenerateDebugReportAsync(pdfStreams);
        }

        // MODO PRODUÃ‡ÃƒO
        var allAccountsData = new Dictionary<string, List<ItauCash2Transaction>>();

        for (int i = 0; i < pdfStreams.Count; i++)
        {
            _logger.LogInformation($"ðŸ“„ PDF {i + 1}/{pdfStreams.Count}");

            var accounts = await ExtractTransactionsAsync(pdfStreams[i]);

            foreach (var (accountId, transactions) in accounts)
            {
                if (!allAccountsData.ContainsKey(accountId))
                    allAccountsData[accountId] = new List<ItauCash2Transaction>();

                allAccountsData[accountId].AddRange(transactions);
                _logger.LogInformation($"  ðŸ¦ {accountId}: {transactions.Count} transaÃ§Ã£o(Ãµes)");
            }
        }

        _logger.LogInformation($"âœ… Total: {allAccountsData.Count} conta(s), {allAccountsData.Sum(x => x.Value.Count)} transaÃ§Ã£o(Ãµes)");

        return await CreateExcelAsync(allAccountsData);
    }

    private async Task<Dictionary<string, List<ItauCash2Transaction>>> ExtractTransactionsAsync(Stream pdfStream)
    {
        return await Task.Run(() =>
        {
            pdfStream.Position = 0;

            using var pdfReader = new PdfReader(pdfStream);
            using var pdfDocument = new PdfDocument(pdfReader);

            var accountsData = new Dictionary<string, List<ItauCash2Transaction>>();
            string? currentAccount = null;

            for (int pageNum = 1; pageNum <= pdfDocument.GetNumberOfPages(); pageNum++)
            {
                var page = pdfDocument.GetPage(pageNum);
                var pageText = PdfTextExtractor.GetTextFromPage(page);

                if (!pageText.Contains("Cash Transactions"))
                    continue;

                _logger.LogInformation($"ðŸ“„ PÃ¡gina {pageNum}: Cash Transactions");

                var strategy = new LocationTextExtractionStrategy();
                PdfTextExtractor.GetTextFromPage(page, strategy);

                var chunks = GetAllTextChunks(strategy);
                var sortedChunks = chunks.OrderBy(c => -c.Y).ThenBy(c => c.X).ToList();

                var lines = GroupChunksByLine(sortedChunks);

                foreach (var line in lines)
                {
                    var lineText = string.Join(" ", line.Select(c => c.Text));

                    // Detectar conta
                    var accountMatch = Regex.Match(lineText, @"Opening Balance Account[:\s]*(\d+)\s*([A-Z]{3})", RegexOptions.IgnoreCase);
                    if (accountMatch.Success)
                    {
                        currentAccount = $"{accountMatch.Groups[1].Value}_{accountMatch.Groups[2].Value}";
                        _logger.LogInformation($"ðŸ¦ Conta: {currentAccount}");

                        if (!accountsData.ContainsKey(currentAccount))
                            accountsData[currentAccount] = new List<ItauCash2Transaction>();

                        continue;
                    }

                    // Fim da conta
                    if (lineText.Contains("Closing Balance"))
                    {
                        currentAccount = null;
                        continue;
                    }

                    // Processar transaÃ§Ã£o
                    if (currentAccount != null)
                    {
                        var transaction = ParseTransactionLine(line);
                        if (transaction != null)
                        {
                            accountsData[currentAccount].Add(transaction);
                        }
                    }
                }
            }

            return accountsData;
        });
    }

    private ItauCash2Transaction? ParseTransactionLine(List<TextChunk> lineChunks)
    {
        var lineText = string.Join(" ", lineChunks.Select(c => c.Text));

        // Filtrar headers
        var headers = new[] { "Operation Date", "Value Date", "Description", "Value", "Account Balance", "Opening", "Closing" };
        if (headers.Any(h => lineText.Contains(h, StringComparison.OrdinalIgnoreCase)))
            return null;

        // Buscar datas
        var datePattern = @"\d{2}/\d{2}/\d{4}";
        var dateChunks = lineChunks.Where(c => Regex.IsMatch(c.Text, datePattern)).ToList();

        if (dateChunks.Count == 0)
            return null;

        // Extrair por posiÃ§Ã£o X
        var operationDate = dateChunks.FirstOrDefault()?.Text ?? "";
        var valueDate = dateChunks.Count > 1 ? dateChunks[1].Text : operationDate;

        var descChunks = lineChunks.Where(c => c.X >= DESCRIPTION_X_MIN && c.X < DESCRIPTION_X_MAX).OrderBy(c => c.X);
        var description = string.Join(" ", descChunks.Select(c => c.Text)).Trim();

        // Valores monetÃ¡rios
        var moneyPattern = @"-?\d{1,3}(?:,\d{3})*\.\d{2}";
        var moneyChunks = lineChunks.Where(c => Regex.IsMatch(c.Text, moneyPattern) && c.X >= VALUE_X_MIN).OrderBy(c => c.X).ToList();

        if (moneyChunks.Count < 2)
            return null;

        var value = moneyChunks[0].Text;
        var balance = moneyChunks[1].Text;

        if (string.IsNullOrWhiteSpace(description))
            return null;

        return new ItauCash2Transaction
        {
            OperationDate = operationDate,
            ValueDate = valueDate,
            Description = description,
            Value = value,
            AccountBalance = balance
        };
    }

    private async Task<byte[]> GenerateDebugReportAsync(List<Stream> pdfStreams)
    {
        return await Task.Run(() =>
        {
            _logger.LogInformation("ðŸ” Gerando relatÃ³rio DEBUG");

            using var workbook = new XLWorkbook();
            var worksheet = workbook.Worksheets.Add("DEBUG");

            int row = 1;

            worksheet.Cell(row, 1).Value = "ITAÃš CASH 2.0 - MODO DEBUG";
            worksheet.Cell(row, 1).Style.Font.Bold = true;
            worksheet.Cell(row, 1).Style.Font.FontSize = 16;
            row += 2;

            foreach (var pdfStream in pdfStreams)
            {
                pdfStream.Position = 0;

                using var pdfReader = new PdfReader(pdfStream);
                using var pdfDocument = new PdfDocument(pdfReader);

                for (int pageNum = 1; pageNum <= pdfDocument.GetNumberOfPages(); pageNum++)
                {
                    var page = pdfDocument.GetPage(pageNum);
                    var pageText = PdfTextExtractor.GetTextFromPage(page);

                    if (!pageText.Contains("Cash Transactions"))
                        continue;

                    worksheet.Cell(row, 1).Value = $"PÃGINA {pageNum} - Cash Transactions";
                    worksheet.Cell(row, 1).Style.Font.Bold = true;
                    row += 2;

                    // Headers
                    worksheet.Cell(row, 1).Value = "X";
                    worksheet.Cell(row, 2).Value = "Y";
                    worksheet.Cell(row, 3).Value = "Texto";
                    worksheet.Cell(row, 4).Value = "Tags";
                    
                    var headerRange = worksheet.Range(row, 1, row, 4);
                    headerRange.Style.Font.Bold = true;
                    headerRange.Style.Fill.BackgroundColor = XLColor.LightGray;
                    row++;

                    var strategy = new LocationTextExtractionStrategy();
                    PdfTextExtractor.GetTextFromPage(page, strategy);

                    var chunks = GetAllTextChunks(strategy);
                    var sortedChunks = chunks.OrderBy(c => -c.Y).ThenBy(c => c.X).ToList();

                    bool inSection = false;
                    foreach (var chunk in sortedChunks)
                    {
                        if (chunk.Text.Contains("Cash Transactions"))
                            inSection = true;

                        if (chunk.Text.Contains("Closing Balance"))
                            break;

                        if (!inSection)
                            continue;

                        var isDate = Regex.IsMatch(chunk.Text, @"\d{2}/\d{2}/\d{4}");
                        var isMoney = Regex.IsMatch(chunk.Text, @"-?\d{1,3}(?:,\d{3})*\.\d{2}");

                        var tags = new List<string>();
                        if (isDate) tags.Add("DATA");
                        if (isMoney) tags.Add("VALOR");

                        worksheet.Cell(row, 1).Value = chunk.X;
                        worksheet.Cell(row, 2).Value = chunk.Y;
                        worksheet.Cell(row, 3).Value = chunk.Text;
                        worksheet.Cell(row, 4).Value = string.Join(", ", tags);

                        if (isDate || isMoney)
                        {
                            worksheet.Row(row).Style.Fill.BackgroundColor = XLColor.LightYellow;
                        }

                        row++;
                    }

                    row += 2;
                }
            }

            worksheet.Columns().AdjustToContents();

            _logger.LogInformation($"âœ… RelatÃ³rio DEBUG gerado: {row} linhas");

            using var stream = new MemoryStream();
            workbook.SaveAs(stream);
            return stream.ToArray();
        });
    }

    private async Task<byte[]> CreateExcelAsync(Dictionary<string, List<ItauCash2Transaction>> accountsData)
    {
        return await Task.Run(() =>
        {
            _logger.LogInformation("ðŸ“Š Criando Excel");

            using var workbook = new XLWorkbook();

            foreach (var (accountId, transactions) in accountsData)
            {
                if (transactions.Count == 0)
                    continue;

                var sheetName = accountId.Length > 31 ? accountId.Substring(0, 31) : accountId;
                var worksheet = workbook.Worksheets.Add(sheetName);

                worksheet.Cell(1, 1).Value = "Operation Date";
                worksheet.Cell(1, 2).Value = "Value Date";
                worksheet.Cell(1, 3).Value = "Description";
                worksheet.Cell(1, 4).Value = "Value";
                worksheet.Cell(1, 5).Value = "Account Balance";

                var headerRange = worksheet.Range(1, 1, 1, 5);
                headerRange.Style.Font.Bold = true;
                headerRange.Style.Fill.BackgroundColor = XLColor.FromHtml("#FFA500");

                for (int i = 0; i < transactions.Count; i++)
                {
                    var t = transactions[i];
                    worksheet.Cell(i + 2, 1).Value = t.OperationDate;
                    worksheet.Cell(i + 2, 2).Value = t.ValueDate;
                    worksheet.Cell(i + 2, 3).Value = t.Description;
                    worksheet.Cell(i + 2, 4).Value = t.Value;
                    worksheet.Cell(i + 2, 5).Value = t.AccountBalance;
                }

                worksheet.Columns().AdjustToContents();

                _logger.LogInformation($"  âœ… {sheetName}: {transactions.Count} transaÃ§Ãµes");
            }

            using var stream = new MemoryStream();
            workbook.SaveAs(stream);
            return stream.ToArray();
        });
    }

    // Helper methods
    private List<TextChunk> GetAllTextChunks(LocationTextExtractionStrategy strategy)
    {
        var result = new List<TextChunk>();

        var resultantTextType = strategy.GetType();
        var locationalResultField = resultantTextType.GetField("locationalResult",
            System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);

        if (locationalResultField == null)
            return result;

        var locationalResult = locationalResultField.GetValue(strategy);
        if (locationalResult == null)
            return result;

        var textChunksField = locationalResult.GetType().GetField("textChunks",
            System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);

        if (textChunksField == null)
            return result;

        dynamic? textChunks = textChunksField.GetValue(locationalResult);
        if (textChunks == null)
            return result;

        foreach (dynamic chunk in textChunks)
        {
            try
            {
                var location = chunk.GetLocation();
                var startLocation = location.GetStartLocation();
                var text = chunk.GetText();

                result.Add(new TextChunk
                {
                    X = startLocation.Get(0),
                    Y = startLocation.Get(1),
                    Text = text
                });
            }
            catch { }
        }

        return result;
    }

    private List<List<TextChunk>> GroupChunksByLine(List<TextChunk> chunks)
    {
        var lines = new List<List<TextChunk>>();
        var currentLine = new List<TextChunk>();
        float? lastY = null;

        foreach (var chunk in chunks)
        {
            if (lastY == null || Math.Abs(chunk.Y - lastY.Value) < 2)
            {
                currentLine.Add(chunk);
            }
            else
            {
                if (currentLine.Any())
                    lines.Add(new List<TextChunk>(currentLine));
                currentLine.Clear();
                currentLine.Add(chunk);
            }

            lastY = chunk.Y;
        }

        if (currentLine.Any())
            lines.Add(currentLine);

        return lines;
    }

    private class TextChunk
    {
        public float X { get; set; }
        public float Y { get; set; }
        public string Text { get; set; } = "";
    }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\Parsers\ItauCashParser.cs
----------------------------------------

using iText.Kernel.Pdf;
using iText.Kernel.Pdf.Canvas.Parser;
using ClosedXML.Excel;
using System.Text;
using System.Text.RegularExpressions;
using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Models;

namespace PdfProcessor.Infrastructure.Parsers;

public class ItauCashParser : IItauCashParser
{
    private readonly ILogger<ItauCashParser> _logger;
    
    public ItauCashParser(ILogger<ItauCashParser> logger)
    {
        _logger = logger;
    }
    
    public async Task<byte[]> ProcessBatchAsync(List<Stream> pdfStreams)
    {
        _logger.LogInformation($"ðŸ¦ Processando {pdfStreams.Count} PDF(s) ItaÃº Cash");
        
        // 1. Extrair transaÃ§Ãµes de cada PDF
        var allAccountsData = new Dictionary<string, List<ItauCashTransaction>>();
        
        for (int i = 0; i < pdfStreams.Count; i++)
        {
            _logger.LogInformation($"ðŸ“„ Processando PDF {i + 1}/{pdfStreams.Count}");
            
            var accounts = await ExtractCashTransactionsAsync(pdfStreams[i]);
            
            // 2. Consolidar contas
            foreach (var (accountId, transactions) in accounts)
            {
                if (!allAccountsData.ContainsKey(accountId))
                    allAccountsData[accountId] = new List<ItauCashTransaction>();
                
                allAccountsData[accountId].AddRange(transactions);
                _logger.LogInformation($"  ðŸ¦ {accountId}: {transactions.Count} transaÃ§Ã£o(Ãµes)");
            }
        }
        
        _logger.LogInformation($"âœ… Total: {allAccountsData.Count} conta(s), {allAccountsData.Sum(x => x.Value.Count)} transaÃ§Ã£o(Ãµes)");
        
        // 3. Criar Excel
        return await CreateExcelAsync(allAccountsData);
    }
    
    public async Task<Dictionary<string, List<ItauCashTransaction>>> ExtractCashTransactionsAsync(Stream pdfStream)
    {
        return await Task.Run(() =>
        {
            pdfStream.Position = 0;
            
            using var pdfReader = new PdfReader(pdfStream);
            using var pdfDocument = new PdfDocument(pdfReader);
            
            var fullText = new StringBuilder();
            
            for (int i = 1; i <= pdfDocument.GetNumberOfPages(); i++)
            {
                var page = pdfDocument.GetPage(i);
                var text = PdfTextExtractor.GetTextFromPage(page);
                fullText.AppendLine($"\n=== PÃGINA {i} ===\n");
                fullText.AppendLine(text);
                _logger.LogInformation($"  ðŸ“„ PÃ¡gina {i}: {text?.Length ?? 0} caracteres");
            }
            
            // Parse do texto
            return ParseCashTransactions(fullText.ToString());
        });
    }
    
    private Dictionary<string, List<ItauCashTransaction>> ParseCashTransactions(string fullText)
    {
        _logger.LogInformation("ðŸ” Parseando Cash Transactions");
        
        var accountsData = new Dictionary<string, List<ItauCashTransaction>>();
        var lines = fullText.Split('\n');
        
        string? currentAccount = null;
        bool inCashTransactionsSection = false;
        bool inTransactionsTable = false;
        ItauCashTransaction? pendingTransaction = null;
        
        _logger.LogInformation($"ðŸ“‹ Total de linhas: {lines.Length}");
        
        for (int i = 0; i < lines.Length; i++)
        {
            var line = lines[i].Trim();
            
            if (string.IsNullOrWhiteSpace(line))
                continue;
            
            // 1. DETECTAR SEÃ‡ÃƒO CASH TRANSACTIONS
            if (line.Contains("Cash Transactions") && !inCashTransactionsSection)
            {
                inCashTransactionsSection = true;
                _logger.LogInformation($"ðŸŽ¯ SeÃ§Ã£o Cash Transactions encontrada na linha {i}");
                continue;
            }
            
            // SÃ“ PROCESSAR SE ESTIVERMOS NA SEÃ‡ÃƒO CORRETA
            if (!inCashTransactionsSection)
                continue;
            
            // 2. DETECTAR OPENING BALANCE (NOVA CONTA)
            var openingPatterns = new[]
            {
                @"Opening Balance Account[:\s]*(\d+)\s*([A-Z]{3})",
                @"Opening Balance Account:\s*(\d+)\s*([A-Z]{3})",
                @"Opening Balance\s+Account:\s*(\d+)\s*([A-Z]{3})"
            };
            
            Match? openingMatch = null;
            foreach (var pattern in openingPatterns)
            {
                openingMatch = Regex.Match(line, pattern, RegexOptions.IgnoreCase);
                if (openingMatch.Success)
                {
                    // FINALIZAR CONTA ANTERIOR SE EXISTIR
                    if (pendingTransaction != null && currentAccount != null)
                    {
                        if (!accountsData.ContainsKey(currentAccount))
                            accountsData[currentAccount] = new List<ItauCashTransaction>();
                        
                        accountsData[currentAccount].Add(pendingTransaction);
                        _logger.LogInformation($"  âœ… Ãšltima transaÃ§Ã£o da conta anterior finalizada");
                    }
                    
                    // INICIAR NOVA CONTA
                    var accountNumber = openingMatch.Groups[1].Value;
                    var currency = openingMatch.Groups[2].Value;
                    currentAccount = $"{accountNumber}_{currency}";
                    inTransactionsTable = true;
                    pendingTransaction = null;
                    
                    _logger.LogInformation($"ðŸ¦ NOVA CONTA: {currentAccount}");
                    
                    if (!accountsData.ContainsKey(currentAccount))
                        accountsData[currentAccount] = new List<ItauCashTransaction>();
                    
                    break;
                }
            }
            
            if (openingMatch?.Success == true)
                continue;
            
            // 3. DETECTAR CLOSING BALANCE (FIM DA CONTA ATUAL)
            if (line.Contains("Closing Balance") && inTransactionsTable && currentAccount != null)
            {
                _logger.LogInformation($"ðŸ Closing Balance encontrado");
                
                // Finalizar transaÃ§Ã£o pendente
                if (pendingTransaction != null)
                {
                    accountsData[currentAccount].Add(pendingTransaction);
                    _logger.LogInformation($"  âœ… Ãšltima transaÃ§Ã£o finalizada");
                }
                
                _logger.LogInformation($"  ðŸ“Š Total de transaÃ§Ãµes para {currentAccount}: {accountsData[currentAccount].Count}");
                
                // RESETAR APENAS O ESTADO DA TABELA, NÃƒO DA SEÃ‡ÃƒO
                // (pode haver mais contas no mesmo PDF)
                inTransactionsTable = false;
                currentAccount = null;
                pendingTransaction = null;
                continue;
            }
            
            // 4. PROCESSAR TRANSAÃ‡ÃƒO
            if (inTransactionsTable && currentAccount != null)
            {
                var transaction = ParseTransactionLine(line, i);
                
                if (transaction != null)
                {
                    // Nova transaÃ§Ã£o com data
                    if (pendingTransaction != null)
                    {
                        // Finalizar anterior
                        accountsData[currentAccount].Add(pendingTransaction);
                    }
                    
                    pendingTransaction = transaction;
                }
                else if (pendingTransaction != null && line.Length > 5)
                {
                    // PossÃ­vel continuaÃ§Ã£o da descriÃ§Ã£o
                    // Verificar se Ã© realmente continuaÃ§Ã£o (nÃ£o tem valores grandes no final)
                    if (!Regex.IsMatch(line, @"\d{1,3}(?:,\d{3})*\.\d{2}$"))
                    {
                        pendingTransaction.Description += $" {line}";
                    }
                }
            }
        }
        
        // Finalizar Ãºltima transaÃ§Ã£o pendente
        if (pendingTransaction != null && currentAccount != null)
        {
            if (!accountsData.ContainsKey(currentAccount))
                accountsData[currentAccount] = new List<ItauCashTransaction>();
            
            accountsData[currentAccount].Add(pendingTransaction);
        }
        
        return accountsData;
    }
    
    private ItauCashTransaction? ParseTransactionLine(string line, int lineNum)
    {
        // Procurar datas no formato DD/MM/YYYY - OBRIGATÃ“RIO
        var datePattern = @"\b(\d{2}/\d{2}/\d{4})\b";
        var dates = Regex.Matches(line, datePattern);
        
        // Deve ter pelo menos uma data
        if (dates.Count < 1)
            return null;
        
        // FILTRAR cabeÃ§alhos
        var headerIndicators = new[]
        {
            "Operation Date", "Value Date", "Description", "Value", "Account Balance",
            "Transactions", "Transaction", "PÃGINA", "===", "Closing Balance",
            "Opening Balance", "Portfolio", "Assets", "Future Cash Flow", "Benchmarks"
        };
        
        if (headerIndicators.Any(h => line.Contains(h, StringComparison.OrdinalIgnoreCase)))
            return null;
        
        // ESTRATÃ‰GIA: IDENTIFICAR Value e Balance PELA POSIÃ‡ÃƒO NO FINAL DA LINHA
        // PadrÃ£o: DD/MM/YYYY DD/MM/YYYY DescriÃ§Ã£o... VALUE BALANCE
        // Os 2 ÃšLTIMOS nÃºmeros grandes sÃ£o sempre Value e Balance
        
        // Regex para capturar TODOS os nÃºmeros monetÃ¡rios
        var moneyPattern = @"-?\d{1,3}(?:,\d{3})*(?:\.\d{2})?";
        var moneyMatches = Regex.Matches(line, moneyPattern);
        
        // Deve ter pelo menos 2 valores: Value + Balance
        if (moneyMatches.Count < 2)
            return null;
        
        // PEGAR OS 2 ÃšLTIMOS VALORES
        var value = moneyMatches[moneyMatches.Count - 2].Value;
        var balance = moneyMatches[moneyMatches.Count - 1].Value;
        
        // CONSTRUIR DESCRIÃ‡ÃƒO: remover datas e os 2 Ãºltimos valores
        var description = line;
        
        // 1. Remover datas
        foreach (Match dateMatch in dates)
        {
            description = description.Replace(dateMatch.Value, "");
        }
        
        // 2. Remover APENAS os valores identificados como Value/Balance
        var lastValueIndex = description.LastIndexOf(value);
        if (lastValueIndex != -1)
            description = description.Substring(0, lastValueIndex) + description.Substring(lastValueIndex + value.Length);
        
        var lastBalanceIndex = description.LastIndexOf(balance);
        if (lastBalanceIndex != -1)
            description = description.Substring(0, lastBalanceIndex) + description.Substring(lastBalanceIndex + balance.Length);
        
        // 3. Limpar espaÃ§os extras
        description = Regex.Replace(description, @"\s+", " ").Trim();
        
        // 4. ValidaÃ§Ã£o
        if (string.IsNullOrWhiteSpace(description) || description.Length < 3)
            description = "TransaÃ§Ã£o";
        
        // Extrair datas
        var operationDate = dates[0].Value;
        var valueDate = dates.Count > 1 ? dates[1].Value : operationDate;
        
        return new ItauCashTransaction
        {
            OperationDate = operationDate,
            ValueDate = valueDate,
            Description = description,
            Value = value,
            AccountBalance = balance
        };
    }
    
    private async Task<byte[]> CreateExcelAsync(Dictionary<string, List<ItauCashTransaction>> accountsData)
    {
        return await Task.Run(() =>
        {
            _logger.LogInformation("ðŸ“Š Criando arquivo Excel");
            
            using var workbook = new XLWorkbook();
            
            foreach (var (accountId, transactions) in accountsData)
            {
                if (transactions.Count == 0)
                    continue;
                
                // Nome da aba (mÃ¡ximo 31 caracteres)
                var sheetName = accountId.Length > 31 ? accountId.Substring(0, 31) : accountId;
                var worksheet = workbook.Worksheets.Add(sheetName);
                
                // Headers
                worksheet.Cell(1, 1).Value = "Operation Date";
                worksheet.Cell(1, 2).Value = "Value Date";
                worksheet.Cell(1, 3).Value = "Description";
                worksheet.Cell(1, 4).Value = "Value";
                worksheet.Cell(1, 5).Value = "Account Balance";
                
                // Estilo do header
                var headerRange = worksheet.Range(1, 1, 1, 5);
                headerRange.Style.Font.Bold = true;
                headerRange.Style.Fill.BackgroundColor = XLColor.LightGray;
                
                // Dados
                for (int i = 0; i < transactions.Count; i++)
                {
                    var t = transactions[i];
                    worksheet.Cell(i + 2, 1).Value = t.OperationDate;
                    worksheet.Cell(i + 2, 2).Value = t.ValueDate;
                    worksheet.Cell(i + 2, 3).Value = t.Description;
                    worksheet.Cell(i + 2, 4).Value = t.Value;
                    worksheet.Cell(i + 2, 5).Value = t.AccountBalance;
                }
                
                // Auto-fit colunas
                worksheet.Columns().AdjustToContents();
                
                _logger.LogInformation($"  âœ… Aba '{sheetName}': {transactions.Count} transaÃ§Ã£o(Ãµes)");
            }
            
            using var stream = new MemoryStream();
            workbook.SaveAs(stream);
            
            _logger.LogInformation($"âœ… Excel criado: {stream.Length} bytes");
            
            return stream.ToArray();
        });
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\Parsers\ItauMovimentacaoParser.cs
----------------------------------------

using iText.Kernel.Pdf;
using iText.Kernel.Pdf.Canvas.Parser;
using ClosedXML.Excel;
using System.Text;
using System.Text.RegularExpressions;
using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Models;

namespace PdfProcessor.Infrastructure.Parsers;

public class ItauMovimentacaoParser : IItauMovimentacaoParser
{
    private readonly ILogger<ItauMovimentacaoParser> _logger;
    
    public ItauMovimentacaoParser(ILogger<ItauMovimentacaoParser> logger)
    {
        _logger = logger;
    }
    
    public async Task<byte[]> ProcessBatchAsync(List<Stream> pdfStreams)
    {
        _logger.LogInformation($"ðŸ’³ Processando {pdfStreams.Count} PDF(s)");
        
        // 1. Extrair transaÃ§Ãµes de cada PDF
        var allAccountsData = new Dictionary<string, List<ItauTransaction>>();
        
        for (int i = 0; i < pdfStreams.Count; i++)
        {
            _logger.LogInformation($"ðŸ“„ Processando PDF {i + 1}/{pdfStreams.Count}");
            
            var accounts = await ExtractMovimentacaoAsync(pdfStreams[i]);
            
            // 2. Consolidar contas
            foreach (var (accountId, transactions) in accounts)
            {
                if (!allAccountsData.ContainsKey(accountId))
                    allAccountsData[accountId] = new List<ItauTransaction>();
                
                allAccountsData[accountId].AddRange(transactions);
                _logger.LogInformation($"  ðŸ¦ {accountId}: {transactions.Count} transaÃ§Ã£o(Ãµes)");
            }
        }
        
        _logger.LogInformation($"âœ… Total: {allAccountsData.Count} conta(s), {allAccountsData.Sum(x => x.Value.Count)} transaÃ§Ã£o(Ãµes)");
        
        // 3. Criar Excel
        return await CreateExcelAsync(allAccountsData);
    }
    
    public async Task<Dictionary<string, List<ItauTransaction>>> ExtractMovimentacaoAsync(Stream pdfStream)
    {
        return await Task.Run(() =>
        {
            pdfStream.Position = 0;
            
            using var pdfReader = new PdfReader(pdfStream);
            using var pdfDocument = new PdfDocument(pdfReader);
            
            var fullText = new StringBuilder();
            
            for (int i = 1; i <= pdfDocument.GetNumberOfPages(); i++)
            {
                var page = pdfDocument.GetPage(i);
                var text = PdfTextExtractor.GetTextFromPage(page);
                fullText.AppendLine($"\n=== PÃGINA {i} ===\n");
                fullText.AppendLine(text);
                _logger.LogInformation($"  ðŸ“„ PÃ¡gina {i}: {text?.Length ?? 0} caracteres");
            }
            
            // Parse do texto
            return ParseMovimentacao(fullText.ToString());
        });
    }
    
    private Dictionary<string, List<ItauTransaction>> ParseMovimentacao(string fullText)
    {
        _logger.LogInformation("ðŸ” Parseando movimentaÃ§Ã£o bancÃ¡ria");
        
        var accounts = new Dictionary<string, List<ItauTransaction>>();
        var lines = fullText.Split('\n');
        
        string? currentAccount = null;
        bool inMovimentacaoSection = false;
        bool inTransactionsTable = false;
        string? currentDate = null;
        
        _logger.LogInformation($"ðŸ“‹ Total de linhas: {lines.Length}");
        
        for (int i = 0; i < lines.Length; i++)
        {
            var line = lines[i].Trim();
            
            if (string.IsNullOrWhiteSpace(line))
                continue;
            
            // 1. Detectar agÃªncia e conta
            var accountMatch = Regex.Match(line, @"ag\s+(\d+)\s+cc\s+([0-9\-]+)", RegexOptions.IgnoreCase);
            if (accountMatch.Success)
            {
                var agencia = accountMatch.Groups[1].Value;
                var conta = accountMatch.Groups[2].Value;
                currentAccount = $"AG {agencia} - CC {conta}";
                
                if (!accounts.ContainsKey(currentAccount))
                    accounts[currentAccount] = new List<ItauTransaction>();
                
                _logger.LogInformation($"ðŸ¦ Conta detectada: {currentAccount}");
                continue;
            }
            
            // 2. Detectar inÃ­cio da seÃ§Ã£o movimentaÃ§Ã£o
            if (line.Contains("Conta Corrente") && line.Contains("MovimentaÃ§Ã£o"))
            {
                inMovimentacaoSection = true;
                _logger.LogInformation("ðŸ“Š SeÃ§Ã£o de movimentaÃ§Ã£o encontrada");
                continue;
            }
            
            // 3. Detectar inÃ­cio da tabela
            if (inMovimentacaoSection && 
                line.Contains("data", StringComparison.OrdinalIgnoreCase) && 
                line.Contains("descriÃ§Ã£o", StringComparison.OrdinalIgnoreCase))
            {
                inTransactionsTable = true;
                _logger.LogInformation("ðŸ“‹ InÃ­cio da tabela de transaÃ§Ãµes");
                continue;
            }
            
            // 4. Parse de transaÃ§Ãµes
            if (inTransactionsTable && currentAccount != null)
            {
                var transaction = ParseTransactionLine(line, ref currentDate, i + 1);
                
                if (transaction != null)
                {
                    accounts[currentAccount].Add(transaction);
                }
            }
            
            // 5. Detectar fim da tabela
            if (line.Contains("totalizador", StringComparison.OrdinalIgnoreCase) || 
                line.Contains("Saldo final", StringComparison.OrdinalIgnoreCase))
            {
                inTransactionsTable = false;
                inMovimentacaoSection = false;
                _logger.LogInformation("ðŸ Fim da tabela de transaÃ§Ãµes");
            }
        }
        
        return accounts;
    }
    
    private ItauTransaction? ParseTransactionLine(string line, ref string? currentDate, int lineNumber)
    {
        // Filtros de linhas a ignorar
        var ignorePatterns = new[]
        {
            "Saldo Aplic Aut Mais",
            "totalizador",
            "Saldo final",
            "===",
            "PÃGINA",
            "data.*descriÃ§Ã£o",
            "Para demais siglas"
        };
        
        if (ignorePatterns.Any(p => Regex.IsMatch(line, p, RegexOptions.IgnoreCase)))
            return null;
        
        // 1. Extrair data (dd/MM)
        var dateMatch = Regex.Match(line, @"^(\d{1,2}/\d{1,2})\s*(.*)$");
        string data;
        string remainingText;
        
        if (dateMatch.Success)
        {
            data = dateMatch.Groups[1].Value;
            currentDate = data; // Salvar Ãºltima data vÃ¡lida
            remainingText = dateMatch.Groups[2].Value.Trim();
        }
        else
        {
            data = currentDate ?? "";
            remainingText = line.Trim();
        }
        
        // 2. Encontrar valores monetÃ¡rios com suas posiÃ§Ãµes
        var moneyMatches = Regex.Matches(line, @"\d{1,3}(?:\.\d{3})*,\d{2}[-]?");
        
        if (moneyMatches.Count == 0)
            return null;
        
        // 3. Classificar valores (entrada, saÃ­da, saldo)
        string entrada = "";
        string saida = "";
        string saldo = "";
        
        if (moneyMatches.Count == 1)
        {
            var value = moneyMatches[0].Value;
            var position = moneyMatches[0].Index;
            
            // Se estÃ¡ muito Ã  direita (posiÃ§Ã£o > 100), provavelmente Ã© saldo
            if (position > 100)
            {
                saldo = value;
            }
            else
            {
                if (value.EndsWith('-'))
                    saida = value;
                else
                    entrada = value;
            }
        }
        else if (moneyMatches.Count == 2)
        {
            // O valor mais Ã  direita Ã© sempre o saldo
            saldo = moneyMatches[1].Value;
            
            if (moneyMatches[0].Value.EndsWith('-'))
                saida = moneyMatches[0].Value;
            else
                entrada = moneyMatches[0].Value;
        }
        else if (moneyMatches.Count >= 3)
        {
            // Ãšltimo valor Ã© sempre saldo
            saldo = moneyMatches[moneyMatches.Count - 1].Value;
            
            // Analisar valores anteriores
            for (int i = 0; i < moneyMatches.Count - 1; i++)
            {
                var value = moneyMatches[i].Value;
                if (value.EndsWith('-'))
                {
                    if (string.IsNullOrEmpty(saida))
                        saida = value;
                }
                else
                {
                    if (string.IsNullOrEmpty(entrada))
                        entrada = value;
                }
            }
        }
        
        // 4. Extrair descriÃ§Ã£o (remover valores)
        var descricao = remainingText;
        foreach (Match match in moneyMatches)
        {
            descricao = descricao.Replace(match.Value, "");
        }
        descricao = Regex.Replace(descricao, @"\s+", " ").Trim();
        
        // 5. ValidaÃ§Ãµes
        if (string.IsNullOrWhiteSpace(descricao) || descricao.Length < 2)
            return null;
        
        // Filtros especÃ­ficos
        if (descricao.Contains("Saldo Aplic Aut Mais") && string.IsNullOrEmpty(entrada) && string.IsNullOrEmpty(saida))
            return null;
        
        if (descricao.Contains("Res Aplic Aut Mais") && string.IsNullOrEmpty(entrada) && string.IsNullOrEmpty(saida))
            return null;
        
        return new ItauTransaction
        {
            Data = data,
            Descricao = descricao,
            EntradasRS = entrada,
            SaidasRS = saida,
            SaldoRS = saldo
        };
    }
    
    private async Task<byte[]> CreateExcelAsync(Dictionary<string, List<ItauTransaction>> accountsData)
    {
        return await Task.Run(() =>
        {
            _logger.LogInformation("ðŸ“Š Criando arquivo Excel");
            
            using var workbook = new XLWorkbook();
            
            foreach (var (accountId, transactions) in accountsData)
            {
                if (transactions.Count == 0)
                    continue;
                
                // Nome da aba (mÃ¡ximo 31 caracteres)
                var sheetName = accountId.Length > 31 ? accountId.Substring(0, 31) : accountId;
                var worksheet = workbook.Worksheets.Add(sheetName);
                
                // Headers
                worksheet.Cell(1, 1).Value = "data";
                worksheet.Cell(1, 2).Value = "descriÃ§Ã£o";
                worksheet.Cell(1, 3).Value = "entradas R$ (crÃ©ditos)";
                worksheet.Cell(1, 4).Value = "saÃ­das R$ (dÃ©bitos)";
                worksheet.Cell(1, 5).Value = "saldo R$";
                
                // Estilo do header
                var headerRange = worksheet.Range(1, 1, 1, 5);
                headerRange.Style.Font.Bold = true;
                headerRange.Style.Fill.BackgroundColor = XLColor.LightGray;
                
                // Dados
                for (int i = 0; i < transactions.Count; i++)
                {
                    var t = transactions[i];
                    worksheet.Cell(i + 2, 1).Value = t.Data;
                    worksheet.Cell(i + 2, 2).Value = t.Descricao;
                    worksheet.Cell(i + 2, 3).Value = t.EntradasRS;
                    worksheet.Cell(i + 2, 4).Value = t.SaidasRS;
                    worksheet.Cell(i + 2, 5).Value = t.SaldoRS;
                }
                
                // Auto-fit colunas
                worksheet.Columns().AdjustToContents();
                
                _logger.LogInformation($"  âœ… Aba '{sheetName}': {transactions.Count} transaÃ§Ã£o(Ãµes)");
            }
            
            using var stream = new MemoryStream();
            workbook.SaveAs(stream);
            
            _logger.LogInformation($"âœ… Excel criado: {stream.Length} bytes");
            
            return stream.ToArray();
        });
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\Parsers\MorganStanleyParser.cs
----------------------------------------

using iTextSharp.text.pdf;
using iTextSharp.text.pdf.parser;
using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Models;
using System.Text.RegularExpressions;

namespace PdfProcessor.Infrastructure.Parsers;

public class MorganStanleyParser : IMorganStanleyParser
{
  // âœ… POSIÃ‡Ã•ES REAIS detectadas no DEBUG
  private class ColumnRanges
  {
    public float ActivityDateStart = 30;
    public float ActivityDateEnd = 75;

    public float SettlementDateStart = 75;
    public float SettlementDateEnd = 113;

    public float ActivityTypeStart = 113;
    public float ActivityTypeEnd = 210;

    public float DescriptionStart = 210;
    public float DescriptionEnd = 364;

    public float CommentsStart = 364;
    public float CommentsEnd = 567;

    public float QuantityStart = 567;
    public float QuantityEnd = 613;

    public float PriceStart = 613;
    public float PriceEnd = 700;

    public float CreditsDebitsStart = 720;
    public float CreditsDebitsEnd = 800;
  }

  public async Task<List<MorganStanleyTransaction>> ParsePdfAsync(Stream pdfStream, string fileName)
  {
    var transactions = new List<MorganStanleyTransaction>();

    return await Task.Run(() =>
    {
      try
      {
        Console.WriteLine($"ðŸ“„ Processando {fileName}");

        pdfStream.Position = 0;
        using var pdfReader = new PdfReader(pdfStream);

        int totalPages = pdfReader.NumberOfPages;
        string currentAccountNumber = "";

        for (int pageNum = 1; pageNum <= totalPages; pageNum++)
        {
          var text = PdfTextExtractor.GetTextFromPage(pdfReader, pageNum);

          // âœ… DETECTAR ACCOUNT NUMBER
          var lines = text.Split(new[] { '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries);
          for (int i = 0; i < lines.Length; i++)
          {
            if (lines[i].Contains("Select UMA Active Assets Account") && i + 1 < lines.Length)
            {
              // PrÃ³xima linha tem o account number
              var accountLine = lines[i + 1];
              // Extrair nÃºmero (formato: 442-084511-943)
              var match = Regex.Match(accountLine, @"(\d{3}-\d{6}-\d{3})");
              if (match.Success)
              {
                currentAccountNumber = match.Groups[1].Value;
                Console.WriteLine($"ðŸ¦ Account detectado: {currentAccountNumber}");
              }
              break;
            }
          }

          // âœ… VERIFICAR SE TEM TABELA
          if (!text.Contains("CASH FLOW ACTIVITY BY DATE"))
          {
            continue;
          }

          Console.WriteLine($"\nðŸ“„ === PÃGINA {pageNum} ===");

          var pageTransactions = ExtractTransactionsWithPosition(pdfReader, pageNum, currentAccountNumber);
          transactions.AddRange(pageTransactions);

          Console.WriteLine($"âœ… {pageTransactions.Count} transaÃ§Ã£o(Ãµes) extraÃ­da(s)");
        }

        Console.WriteLine($"\nâœ… Total: {transactions.Count} transaÃ§Ã£o(Ãµes)");
      }
      catch (Exception ex)
      {
        Console.WriteLine($"âŒ Erro: {ex.Message}");
        throw;
      }

      return transactions;
    });
  }

  private List<MorganStanleyTransaction> ExtractTransactionsWithPosition(PdfReader reader, int pageNum, string accountNumber)
  {
    var transactions = new List<MorganStanleyTransaction>();
    var columns = new ColumnRanges();

    try
    {
      var strategy = new LocationTextExtractionStrategyEx();
      var pageText = PdfTextExtractor.GetTextFromPage(reader, pageNum, strategy);

      var chunks = strategy.GetTextChunks();

      var lineGroups = chunks
          .GroupBy(c => Math.Round(c.Y, 1))
          .OrderByDescending(g => g.Key)
          .ToList();

      bool inTableSection = false;
      MorganStanleyTransaction? currentTransaction = null;

      foreach (var lineGroup in lineGroups)
      {
        var lineChunks = lineGroup.OrderBy(c => c.X).ToList();
        var lineText = string.Join("", lineChunks.Select(c => c.Text));

        // Detectar inÃ­cio
        if (lineText.Contains("CASH FLOW ACTIVITY BY DATE"))
        {
          inTableSection = true;
          Console.WriteLine("âœ… InÃ­cio da tabela detectado");
          continue;
        }

        // Pular cabeÃ§alho das colunas
        if (lineText.Contains("Activity") && lineText.Contains("Date") && lineText.Contains("Type"))
        {
          continue;
        }

        // Detectar fim
        if (lineText.Contains("NET CREDITS/(DEBITS)"))
        {
          if (currentTransaction != null)
          {
            transactions.Add(currentTransaction);
            currentTransaction = null;
          }
          Console.WriteLine("âœ… Fim da tabela detectado");
          break;
        }

        if (!inTableSection)
        {
          continue;
        }

        // âœ… VERIFICAR SE Ã‰ NOVA TRANSAÃ‡ÃƒO OU CONTINUAÃ‡ÃƒO
        var activityDate = GetTextInRange(lineChunks, columns.ActivityDateStart, columns.ActivityDateEnd);
        var settlementDate = GetTextInRange(lineChunks, columns.SettlementDateStart, columns.SettlementDateEnd);

        // Se TEM data (activity ou settlement) = NOVA transaÃ§Ã£o
        bool hasDate = !string.IsNullOrWhiteSpace(activityDate) && Regex.IsMatch(activityDate, @"\d+/\d+");

        if (hasDate)
        {
          // Salvar transaÃ§Ã£o anterior
          if (currentTransaction != null)
          {
            transactions.Add(currentTransaction);
          }

          // Criar nova transaÃ§Ã£o
          currentTransaction = new MorganStanleyTransaction();
          currentTransaction.AccountNumber = accountNumber;
          currentTransaction.ActivityDate = activityDate;
          currentTransaction.SettlementDate = settlementDate;
          currentTransaction.ActivityType = GetTextInRange(lineChunks, columns.ActivityTypeStart, columns.ActivityTypeEnd);
          currentTransaction.Description = GetTextInRange(lineChunks, columns.DescriptionStart, columns.DescriptionEnd);
          currentTransaction.Comments = GetTextInRange(lineChunks, columns.CommentsStart, columns.CommentsEnd);
          currentTransaction.Quantity = GetTextInRange(lineChunks, columns.QuantityStart, columns.QuantityEnd);
          currentTransaction.Price = GetTextInRange(lineChunks, columns.PriceStart, columns.PriceEnd);
          currentTransaction.CreditsDebits = GetTextInRange(lineChunks, columns.CreditsDebitsStart, columns.CreditsDebitsEnd);

          Console.WriteLine($"   âœ“ {currentTransaction.ActivityDate} | {currentTransaction.ActivityType}");
        }
        // Se NÃƒO tem data = CONTINUAÃ‡ÃƒO (multilinha)
        else if (currentTransaction != null)
        {
          var activityTypeExtra = GetTextInRange(lineChunks, columns.ActivityTypeStart, columns.ActivityTypeEnd);
          var descriptionExtra = GetTextInRange(lineChunks, columns.DescriptionStart, columns.DescriptionEnd);
          var commentsExtra = GetTextInRange(lineChunks, columns.CommentsStart, columns.CommentsEnd);

          if (!string.IsNullOrWhiteSpace(activityTypeExtra))
          {
            currentTransaction.ActivityType += " " + activityTypeExtra;
          }

          if (!string.IsNullOrWhiteSpace(descriptionExtra))
          {
            currentTransaction.Description += " " + descriptionExtra;
          }

          if (!string.IsNullOrWhiteSpace(commentsExtra))
          {
            currentTransaction.Comments += " " + commentsExtra;
          }
        }
      }

      // Adicionar Ãºltima transaÃ§Ã£o
      if (currentTransaction != null)
      {
        transactions.Add(currentTransaction);
      }
    }
    catch (Exception ex)
    {
      Console.WriteLine($"âŒ Erro ao processar pÃ¡gina {pageNum}: {ex.Message}");
    }

    return transactions;
  }

  private string GetTextInRange(List<TextChunkEx> chunks, float startX, float endX)
  {
    var textsInRange = chunks
        .Where(c => c.X >= startX && c.X < endX)
        .OrderBy(c => c.X)
        .Select(c => c.Text)
        .ToList();

    return string.Join(" ", textsInRange).Trim();
  }

  private class TextChunkEx
  {
    public string Text { get; set; } = "";
    public float X { get; set; }
    public float Y { get; set; }
  }

  private class LocationTextExtractionStrategyEx : LocationTextExtractionStrategy
  {
    private List<TextChunkEx> chunks = new List<TextChunkEx>();

    public override void RenderText(TextRenderInfo renderInfo)
    {
      base.RenderText(renderInfo);

      var bottomLeft = renderInfo.GetBaseline().GetStartPoint();
      var text = renderInfo.GetText();

      if (!string.IsNullOrWhiteSpace(text))
      {
        chunks.Add(new TextChunkEx
        {
          Text = text,
          X = bottomLeft[iTextSharp.text.pdf.parser.Vector.I1],
          Y = bottomLeft[iTextSharp.text.pdf.parser.Vector.I2]
        });
      }
    }

    public List<TextChunkEx> GetTextChunks()
    {
      return chunks;
    }
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\Parsers\UbsParser.cs
----------------------------------------

using iTextSharp.text.pdf;
using iTextSharp.text.pdf.parser;
using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Models;
using System.Text.RegularExpressions;

namespace PdfProcessor.Infrastructure.Parsers;

public class UbsParser : IUbsParser
{
  // âœ… POSIÃ‡Ã•ES CORRETAS (ajustadas manualmente)
  private class ColumnRanges
  {
    public float DateStart = 40;
    public float DateEnd = 92;

    public float InformationStart = 92;
    public float InformationEnd = 210;

    public float DebitsStart = 210;
    public float DebitsEnd = 309;

    public float CreditsStart = 309;
    public float CreditsEnd = 391;

    public float ValueDateStart = 438;
    public float ValueDateEnd = 490;

    public float BalanceStart = 490;
    public float BalanceEnd = 600;
  }

  public async Task<List<UbsTransaction>> ParsePdfAsync(Stream pdfStream, string fileName)
  {
    var transactions = new List<UbsTransaction>();

    return await Task.Run(() =>
    {
      try
      {
        Console.WriteLine($"ðŸ“„ Processando {fileName}");

        pdfStream.Position = 0;
        using var pdfReader = new PdfReader(pdfStream);

        int totalPages = pdfReader.NumberOfPages;

        for (int pageNum = 1; pageNum <= totalPages; pageNum++)
        {
          Console.WriteLine($"\nðŸ“„ === PÃGINA {pageNum} ===");

          var text = PdfTextExtractor.GetTextFromPage(pdfReader, pageNum);

          // âœ… DETECTAR IBAN - aceita com ou sem espaÃ§os
          string currentIban = "";

          var lines = text.Split(new[] { '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries);
          for (int i = 0; i < lines.Length; i++)
          {
            if (lines[i].Contains("UBS current account"))
            {
              // Procurar IBAN nas prÃ³ximas 5 linhas
              for (int j = i + 1; j < Math.Min(i + 6, lines.Length); j++)
              {
                // âœ… REGEX FLEXÃVEL: aceita espaÃ§os opcionais
                // PadrÃ£o: IBAN CH + 2 dÃ­gitos + resto (com ou sem espaÃ§os)
                var ibanMatch = Regex.Match(lines[j], @"IBAN\s+(CH\d{2}[\s\d]{4,}[\dA-Z\s]+)");

                if (ibanMatch.Success)
                {
                  currentIban = ibanMatch.Groups[1].Value.Trim();
                  Console.WriteLine($"ðŸ¦ IBAN detectado: {currentIban}");
                  break;
                }

                // Fallback: pegar linha inteira se comeÃ§a com CH
                if (lines[j].Trim().StartsWith("IBAN CH"))
                {
                  currentIban = lines[j].Replace("IBAN", "").Trim();
                  Console.WriteLine($"ðŸ¦ IBAN detectado (fallback): {currentIban}");
                  break;
                }
              }
              if (!string.IsNullOrWhiteSpace(currentIban)) break;
            }
          }

          if (!text.Contains("Account Statement"))
          {
            Console.WriteLine("â­ï¸ PÃ¡gina sem Account Statement");
            continue;
          }

          var pageTransactions = ExtractTransactionsWithPosition(pdfReader, pageNum, currentIban);
          transactions.AddRange(pageTransactions);

          Console.WriteLine($"âœ… {pageTransactions.Count} transaÃ§Ã£o(Ãµes) extraÃ­da(s)");
        }

        Console.WriteLine($"\nâœ… Total: {transactions.Count} transaÃ§Ã£o(Ãµes)");
      }
      catch (Exception ex)
      {
        Console.WriteLine($"âŒ Erro: {ex.Message}");
        throw;
      }

      return transactions;
    });
  }

  private List<UbsTransaction> ExtractTransactionsWithPosition(PdfReader reader, int pageNum, string accountIban)
  {
    var transactions = new List<UbsTransaction>();
    var columns = new ColumnRanges();

    try
    {
      var strategy = new LocationTextExtractionStrategyEx();
      var pageText = PdfTextExtractor.GetTextFromPage(reader, pageNum, strategy);

      var chunks = strategy.GetTextChunks();

      var lineGroups = chunks
          .GroupBy(c => Math.Round(c.Y, 1))
          .OrderByDescending(g => g.Key)
          .ToList();

      bool inTableSection = false;
      UbsTransaction? currentTransaction = null;

      foreach (var lineGroup in lineGroups)
      {
        var lineChunks = lineGroup.OrderBy(c => c.X).ToList();
        var lineText = string.Join("", lineChunks.Select(c => c.Text));

        if (lineText.Contains("Date") && lineText.Contains("Information") && lineText.Contains("Balance"))
        {
          inTableSection = true;
          Console.WriteLine("âœ… InÃ­cio da tabela detectado");
          continue;
        }

        if (lineText.Contains("Closing balance") || lineText.Contains("Balance of closing"))
        {
          if (currentTransaction != null)
          {
            transactions.Add(currentTransaction);
            currentTransaction = null;
          }
          Console.WriteLine("âœ… Fim da tabela detectado");
          break;
        }

        if (!inTableSection)
        {
          continue;
        }

        var date = GetTextInRange(lineChunks, columns.DateStart, columns.DateEnd);

        if (!string.IsNullOrWhiteSpace(date) && Regex.IsMatch(date, @"\d{2}\.\d{2}\.\d{2}"))
        {
          if (currentTransaction != null)
          {
            transactions.Add(currentTransaction);
          }

          currentTransaction = new UbsTransaction();
          currentTransaction.AccountIban = accountIban;
          currentTransaction.Date = date;
          currentTransaction.Information = GetTextInRange(lineChunks, columns.InformationStart, columns.InformationEnd);
          currentTransaction.Debits = GetTextInRange(lineChunks, columns.DebitsStart, columns.DebitsEnd);
          currentTransaction.Credits = GetTextInRange(lineChunks, columns.CreditsStart, columns.CreditsEnd);
          currentTransaction.ValueDate = GetTextInRange(lineChunks, columns.ValueDateStart, columns.ValueDateEnd);
          currentTransaction.Balance = GetTextInRange(lineChunks, columns.BalanceStart, columns.BalanceEnd);

          Console.WriteLine($"   âœ“ {currentTransaction.Date} | {currentTransaction.Information}");
        }
        else if (currentTransaction != null)
        {
          var informationExtra = GetTextInRange(lineChunks, columns.InformationStart, columns.InformationEnd);

          if (!string.IsNullOrWhiteSpace(informationExtra))
          {
            currentTransaction.Information += " " + informationExtra;
            Console.WriteLine($"     + Info: {informationExtra}");
          }
        }
      }

      if (currentTransaction != null)
      {
        transactions.Add(currentTransaction);
      }
    }
    catch (Exception ex)
    {
      Console.WriteLine($"âŒ Erro ao processar pÃ¡gina {pageNum}: {ex.Message}");
    }

    return transactions;
  }

  private string GetTextInRange(List<TextChunkEx> chunks, float startX, float endX)
  {
    var textsInRange = chunks
        .Where(c => c.X >= startX && c.X < endX)
        .OrderBy(c => c.X)
        .Select(c => c.Text)
        .ToList();

    return string.Join(" ", textsInRange).Trim();
  }

  private class TextChunkEx
  {
    public string Text { get; set; } = "";
    public float X { get; set; }
    public float Y { get; set; }
  }

  private class LocationTextExtractionStrategyEx : LocationTextExtractionStrategy
  {
    private List<TextChunkEx> chunks = new List<TextChunkEx>();

    public override void RenderText(TextRenderInfo renderInfo)
    {
      base.RenderText(renderInfo);

      var bottomLeft = renderInfo.GetBaseline().GetStartPoint();
      var text = renderInfo.GetText();

      if (!string.IsNullOrWhiteSpace(text))
      {
        chunks.Add(new TextChunkEx
        {
          Text = text,
          X = bottomLeft[iTextSharp.text.pdf.parser.Vector.I1],
          Y = bottomLeft[iTextSharp.text.pdf.parser.Vector.I2]
        });
      }
    }

    public List<TextChunkEx> GetTextChunks()
    {
      return chunks;
    }
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\PdfServices\PdfCompressService.cs
----------------------------------------

using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Enums;
using Microsoft.Extensions.Logging;
using System.Diagnostics;

namespace PdfProcessor.Infrastructure.PdfServices;

/// <summary>
/// ServiÃ§o para compressÃ£o de PDFs usando Ghostscript via Process
/// </summary>
public class PdfCompressService : IPdfCompressService
{
  private readonly ILogger<PdfCompressService> _logger;

  public PdfCompressService(ILogger<PdfCompressService> logger)
  {
    _logger = logger;
  }

  /// <summary>
  /// Comprime um Ãºnico PDF usando Ghostscript
  /// </summary>
  public async Task<CompressionResult> CompressPdfAsync(
      Stream pdfStream,
      CompressionLevel compressionLevel,
      bool removeImages = false,
      string fileName = "")
  {
    return await Task.Run(() =>
    {
      var result = new CompressionResult();
      string? tempInputPath = null;
      string? tempOutputPath = null;

      try
      {
        pdfStream.Position = 0;
        result.OriginalSizeBytes = pdfStream.Length;

        _logger.LogInformation("ðŸ—œï¸ Comprimindo PDF: {FileName} ({Size} bytes) - NÃ­vel: {Level}",
            fileName, result.OriginalSizeBytes, compressionLevel);

        // Verificar se Ghostscript estÃ¡ disponÃ­vel
        var gsPath = FindGhostscript();
        if (string.IsNullOrEmpty(gsPath))
        {
          throw new Exception("Ghostscript nÃ£o encontrado no sistema. Instale com: sudo apt-get install ghostscript");
        }

        _logger.LogInformation("âœ… Ghostscript encontrado em: {Path}", gsPath);

        // Criar arquivos temporÃ¡rios
        tempInputPath = Path.Combine(Path.GetTempPath(), $"compress_input_{Guid.NewGuid()}.pdf");
        tempOutputPath = Path.Combine(Path.GetTempPath(), $"compress_output_{Guid.NewGuid()}.pdf");

        _logger.LogDebug("ðŸ“ Input temp: {Input}", tempInputPath);
        _logger.LogDebug("ðŸ“ Output temp: {Output}", tempOutputPath);

        // Salvar stream para arquivo temporÃ¡rio
        using (var fileStream = File.Create(tempInputPath))
        {
          pdfStream.CopyTo(fileStream);
        }

        var inputSize = new FileInfo(tempInputPath).Length;
        _logger.LogDebug("âœ… Arquivo temporÃ¡rio criado: {Size} bytes", inputSize);

        // Comprimir usando Ghostscript
        CompressWithGhostscript(gsPath, tempInputPath, tempOutputPath, compressionLevel, removeImages);

        // Verificar se arquivo de saÃ­da foi criado
        if (!File.Exists(tempOutputPath))
        {
          throw new Exception("Ghostscript nÃ£o gerou arquivo de saÃ­da");
        }

        var outputInfo = new FileInfo(tempOutputPath);
        if (outputInfo.Length == 0)
        {
          throw new Exception("Ghostscript gerou arquivo vazio");
        }

        // Ler arquivo comprimido
        result.CompressedData = File.ReadAllBytes(tempOutputPath);
        result.CompressedSizeBytes = result.CompressedData.Length;
        result.Success = true;

        var savings = ((1 - (double)result.CompressedSizeBytes / result.OriginalSizeBytes) * 100);

        _logger.LogInformation("âœ… PDF comprimido: {Original} â†’ {Compressed} (economia de {Savings:F2}%)",
            result.OriginalSizeMB, result.CompressedSizeMB, savings);

        return result;
      }
      catch (Exception ex)
      {
        _logger.LogError(ex, "âŒ Erro ao comprimir PDF: {FileName}", fileName);

        // Em caso de erro, retornar o arquivo original
        try
        {
          pdfStream.Position = 0;
          using var ms = new MemoryStream();
          pdfStream.CopyTo(ms);

          result.CompressedData = ms.ToArray();
          result.CompressedSizeBytes = result.CompressedData.Length;
          result.Success = true;
          result.ErrorMessage = $"Aviso: PDF retornado sem compressÃ£o. {ex.Message}";

          _logger.LogWarning("âš ï¸ Retornando PDF original sem compressÃ£o");
        }
        catch
        {
          result.Success = false;
          result.ErrorMessage = ex.Message;
        }

        return result;
      }
      finally
      {
        // Limpar arquivos temporÃ¡rios
        try
        {
          if (tempInputPath != null && File.Exists(tempInputPath))
          {
            File.Delete(tempInputPath);
            _logger.LogDebug("ðŸ—‘ï¸ Arquivo temporÃ¡rio removido: {Path}", tempInputPath);
          }
          if (tempOutputPath != null && File.Exists(tempOutputPath))
          {
            File.Delete(tempOutputPath);
            _logger.LogDebug("ðŸ—‘ï¸ Arquivo temporÃ¡rio removido: {Path}", tempOutputPath);
          }
        }
        catch (Exception ex)
        {
          _logger.LogWarning(ex, "âš ï¸ Erro ao limpar arquivos temporÃ¡rios");
        }
      }
    });
  }

  /// <summary>
  /// Comprime mÃºltiplos PDFs
  /// </summary>
  public async Task<Dictionary<string, CompressionResult>> CompressBatchAsync(
      Dictionary<string, Stream> files,
      Dictionary<string, CompressionSettings> compressionSettings)
  {
    var results = new Dictionary<string, CompressionResult>();

    foreach (var file in files)
    {
      var fileName = file.Key;
      var stream = file.Value;

      var settings = compressionSettings.ContainsKey(fileName)
          ? compressionSettings[fileName]
          : new CompressionSettings();

      var result = await CompressPdfAsync(
          stream,
          settings.Level,
          settings.RemoveImages,
          fileName);

      results[fileName] = result;
    }

    return results;
  }

  /// <summary>
  /// Encontra o executÃ¡vel do Ghostscript
  /// </summary>
  private string? FindGhostscript()
  {
    var possiblePaths = new[]
    {
      "/usr/bin/gs",              // Linux padrÃ£o
      "/usr/local/bin/gs",        // Linux local
      "/bin/gs",                  // Linux alternativo
      "gs"                        // PATH
    };

    foreach (var path in possiblePaths)
    {
      try
      {
        var process = new Process
        {
          StartInfo = new ProcessStartInfo
          {
            FileName = path,
            Arguments = "--version",
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            UseShellExecute = false,
            CreateNoWindow = true
          }
        };

        process.Start();
        process.WaitForExit();

        if (process.ExitCode == 0)
        {
          return path;
        }
      }
      catch
      {
        continue;
      }
    }

    return null;
  }

  /// <summary>
  /// Comprime PDF usando Ghostscript via Process
  /// </summary>
  private void CompressWithGhostscript(
      string gsPath,
      string inputPath,
      string outputPath,
      CompressionLevel level,
      bool removeImages)
  {
    try
    {
      var (dPDFSettings, imageResolution) = GetQualitySettings(level);

      // Construir argumentos
      var args = new List<string>
      {
        "-sDEVICE=pdfwrite",
        "-dCompatibilityLevel=1.4",
        $"-dPDFSETTINGS=/{dPDFSettings}",
        "-dNOPAUSE",
        "-dQUIET",
        "-dBATCH",
        "-dSAFER",
        "-dDetectDuplicateImages=true",
        "-dCompressFonts=true",
        "-dCompressPages=true",
        "-dEmbedAllFonts=true",
        "-dSubsetFonts=true",
        "-dAutoRotatePages=/None",
        $"-dColorImageDownsampleType=/Bicubic",
        $"-dColorImageResolution={imageResolution}",
        $"-dGrayImageDownsampleType=/Bicubic",
        $"-dGrayImageResolution={imageResolution}",
        $"-dMonoImageDownsampleType=/Bicubic",
        $"-dMonoImageResolution={imageResolution}",
        $"-sOutputFile={outputPath}",
        inputPath
      };

      if (removeImages)
      {
        args.Insert(8, "-dFILTERIMAGE");
      }

      var argumentString = string.Join(" ", args);
      _logger.LogDebug("ðŸ”§ Comando Ghostscript: {Command} {Args}", gsPath, argumentString);

      // Executar processo
      var process = new Process
      {
        StartInfo = new ProcessStartInfo
        {
          FileName = gsPath,
          Arguments = argumentString,
          RedirectStandardOutput = true,
          RedirectStandardError = true,
          UseShellExecute = false,
          CreateNoWindow = true
        }
      };

      var output = new System.Text.StringBuilder();
      var error = new System.Text.StringBuilder();

      process.OutputDataReceived += (sender, e) =>
      {
        if (!string.IsNullOrEmpty(e.Data))
          output.AppendLine(e.Data);
      };

      process.ErrorDataReceived += (sender, e) =>
      {
        if (!string.IsNullOrEmpty(e.Data))
          error.AppendLine(e.Data);
      };

      process.Start();
      process.BeginOutputReadLine();
      process.BeginErrorReadLine();
      process.WaitForExit();

      if (process.ExitCode != 0)
      {
        var errorMessage = error.ToString();
        _logger.LogError("âŒ Ghostscript falhou (exit code {Code}): {Error}",
            process.ExitCode, errorMessage);
        throw new Exception($"Ghostscript falhou: {errorMessage}");
      }

      _logger.LogDebug("âœ… Ghostscript executado com sucesso");

      if (output.Length > 0)
      {
        _logger.LogDebug("ðŸ“ Output: {Output}", output.ToString());
      }
    }
    catch (Exception ex)
    {
      _logger.LogError(ex, "âŒ Erro ao executar Ghostscript");
      throw;
    }
  }

  /// <summary>
  /// ObtÃ©m configuraÃ§Ãµes de qualidade
  /// </summary>
  private (string dPDFSettings, int imageResolution) GetQualitySettings(CompressionLevel level)
  {
    return level switch
    {
      CompressionLevel.Low => ("printer", 300),
      CompressionLevel.Medium => ("ebook", 150),
      CompressionLevel.High => ("screen", 72),
      _ => ("ebook", 150)
    };
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\PdfServices\PdfEditService.cs
----------------------------------------

using PdfProcessor.Core.Interfaces;
using Microsoft.Extensions.Logging;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;
using System.Text;
using SixLabors.ImageSharp;
using SixLabors.ImageSharp.PixelFormats;
using SixLabors.ImageSharp.Processing;
using Docnet.Core;

namespace PdfProcessor.Infrastructure.PdfServices;

public class PdfEditService : IPdfEditService
{
  private readonly ILogger<PdfEditService> _logger;

  public PdfEditService(ILogger<PdfEditService> logger)
  {
    _logger = logger;
  }

  public async Task<string> GeneratePageThumbnailAsync(Stream pdfStream, int pageNumber, int maxWidth = 200)
  {
    return await Task.Run(() =>
    {
      try
      {
        pdfStream.Position = 0;

        // Copiar stream para array de bytes (Docnet precisa de byte[])
        byte[] pdfBytes;
        using (var ms = new MemoryStream())
        {
          pdfStream.CopyTo(ms);
          pdfBytes = ms.ToArray();
        }

        // Usar Docnet.Core para renderizar a pÃ¡gina especÃ­fica
        using var library = DocLib.Instance;
        using var docReader = library.GetDocReader(pdfBytes, new Docnet.Core.Models.PageDimensions(1024, 1024));

        if (docReader.GetPageCount() < pageNumber)
        {
          throw new ArgumentException($"PÃ¡gina {pageNumber} invÃ¡lida. PDF tem {docReader.GetPageCount()} pÃ¡ginas.");
        }

        // Renderizar pÃ¡gina (pageNumber - 1 porque Docnet usa Ã­ndice 0-based)
        using var pageReader = docReader.GetPageReader(pageNumber - 1);
        var rawBytes = pageReader.GetImage();
        var pageWidth = pageReader.GetPageWidth();
        var pageHeight = pageReader.GetPageHeight();

        // Converter raw bytes para imagem usando ImageSharp
        using var image = Image.LoadPixelData<Bgra32>(rawBytes, pageWidth, pageHeight);

        // Calcular dimensÃµes proporcionais
        var width = maxWidth;
        var height = (int)((double)pageHeight / pageWidth * maxWidth);

        // Redimensionar mantendo proporÃ§Ã£o
        image.Mutate(x => x.Resize(new ResizeOptions
        {
          Size = new Size(width, height),
          Mode = ResizeMode.Max
        }));

        // Converter para PNG em base64
        using var outputStream = new MemoryStream();
        image.SaveAsPng(outputStream);
        var base64 = Convert.ToBase64String(outputStream.ToArray());

        return $"data:image/png;base64,{base64}";
      }
      catch (Exception ex)
      {
        _logger.LogError(ex, "Erro ao gerar thumbnail da pÃ¡gina {PageNumber}", pageNumber);
        return GenerateErrorThumbnail(pageNumber);
      }
    });
  }

  private string GenerateErrorThumbnail(int pageNumber)
  {
    try
    {
      // Criar imagem de erro 200x250
      using var image = new Image<Rgba32>(200, 250);
      
      image.Mutate(x => x.BackgroundColor(Color.FromRgb(255, 245, 245)));

      using var outputStream = new MemoryStream();
      image.SaveAsPng(outputStream);
      var base64 = Convert.ToBase64String(outputStream.ToArray());

      return $"data:image/png;base64,{base64}";
    }
    catch
    {
      // Fallback para SVG se ImageSharp falhar
      var svg = $@"<svg xmlns='http://www.w3.org/2000/svg' width='200' height='250'>
  <rect width='100%' height='100%' fill='#fff5f5' stroke='#fc8181' stroke-width='2' rx='4'/>
  <text x='50%' y='50%' font-family='system-ui' font-size='16' fill='#e53e3e' text-anchor='middle'>Erro ao carregar</text>
  <text x='50%' y='65%' font-family='system-ui' font-size='12' fill='#fc8181' text-anchor='middle'>PÃ¡gina {pageNumber}</text>
</svg>";

      var svgBytes = Encoding.UTF8.GetBytes(svg);
      return $"data:image/svg+xml;base64,{Convert.ToBase64String(svgBytes)}";
    }
  }

  public async Task<int> GetPageCountAsync(Stream pdfStream)
  {
    return await Task.Run(() =>
    {
      try
      {
        pdfStream.Position = 0;
        using var pdfDoc = PdfReader.Open(pdfStream, PdfDocumentOpenMode.Import);
        var count = pdfDoc.PageCount;

        _logger.LogInformation("ðŸ“Š PDF tem {PageCount} pÃ¡ginas", count);

        return count;
      }
      catch (Exception ex)
      {
        _logger.LogError(ex, "Erro ao contar pÃ¡ginas do PDF");
        throw;
      }
    });
  }

  public async Task<PdfEditResult> ProcessPdfAsync(
      Stream pdfStream,
      List<PageOperation> pageOperations,
      string originalFileName = "")
  {
    return await Task.Run(() =>
    {
      var result = new PdfEditResult();

      try
      {
        pdfStream.Position = 0;

        using var inputPdfDoc = PdfReader.Open(pdfStream, PdfDocumentOpenMode.Import);
        result.OriginalPageCount = inputPdfDoc.PageCount;

        _logger.LogInformation("ðŸ“ Editando PDF: {FileName} ({PageCount} pÃ¡ginas)",
                originalFileName, result.OriginalPageCount);

        int pagesRotated = 0;
        int pagesKept = 0;

        using var outputPdfDoc = new PdfDocument();

        foreach (var operation in pageOperations.OrderBy(o => o.PageNumber))
        {
          if (operation.PageNumber < 1 || operation.PageNumber > result.OriginalPageCount)
          {
            _logger.LogWarning("âš ï¸ PÃ¡gina {PageNumber} invÃ¡lida, ignorando", operation.PageNumber);
            continue;
          }

          if (!operation.Keep)
          {
            _logger.LogDebug("ðŸ—‘ï¸ Removendo pÃ¡gina {PageNumber}", operation.PageNumber);
            continue;
          }

          // COPIAR PÃGINA (PdfSharp usa Ã­ndice 0-based)
          var sourcePage = inputPdfDoc.Pages[operation.PageNumber - 1];
          var copiedPage = outputPdfDoc.AddPage(sourcePage);

          // APLICAR ROTAÃ‡ÃƒO
          if (operation.Rotation != 0)
          {
            var currentRotation = (int)copiedPage.Rotate;
            var newRotation = (currentRotation + operation.Rotation) % 360;

            if (newRotation < 0) newRotation += 360;

            copiedPage.Rotate = newRotation;
            pagesRotated++;

            _logger.LogDebug("ðŸ”„ PÃ¡gina {PageNumber}: {Current}Â° â†’ {New}Â°",
                    operation.PageNumber, currentRotation, newRotation);
          }

          pagesKept++;
        }

        if (outputPdfDoc.PageCount == 0)
        {
          throw new InvalidOperationException("Nenhuma pÃ¡gina foi adicionada ao PDF editado");
        }

        // SALVAR PDF
        using var ms = new MemoryStream();
        outputPdfDoc.Save(ms, false);
        result.ProcessedPdfData = ms.ToArray();

        result.FinalPageCount = pagesKept;
        result.PagesRotated = pagesRotated;
        result.PagesRemoved = result.OriginalPageCount - pagesKept;
        result.Success = true;

        _logger.LogInformation("âœ… PDF editado: {Original} â†’ {Final} pÃ¡ginas ({Rotated} rot, {Removed} rem) - {Bytes} bytes",
                result.OriginalPageCount, result.FinalPageCount, result.PagesRotated, result.PagesRemoved, result.ProcessedPdfData.Length);

        return result;
      }
      catch (Exception ex)
      {
        _logger.LogError(ex, "âŒ Erro ao processar PDF: {FileName}", originalFileName);
        result.Success = false;
        result.ErrorMessage = ex.Message;
        return result;
      }
    });
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\PdfServices\PdfMergeService.cs
----------------------------------------

using Microsoft.Extensions.Logging;
using PdfProcessor.Core.Interfaces;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;

namespace PdfProcessor.Infrastructure.PdfServices;

public class PdfMergeService : IPdfMergeService
{
    private readonly ILogger<PdfMergeService> _logger;

    public PdfMergeService(ILogger<PdfMergeService> logger)
    {
        _logger = logger;
    }

    public async Task<byte[]> MergePdfsAsync(
        Dictionary<string, Stream> files,
        Dictionary<string, string>? pageRanges = null)
    {
        _logger.LogInformation($"ðŸ”— Iniciando mesclagem de {files.Count} arquivo(s)");

        return await Task.Run(() =>
        {
            using var outputDocument = new PdfDocument();

            int fileIndex = 0;
            foreach (var (fileName, stream) in files)
            {
                try
                {
                    _logger.LogInformation($"ðŸ“„ Processando arquivo {fileIndex + 1}/{files.Count}: {fileName}");

                    stream.Position = 0;
                    using var inputDocument = PdfReader.Open(stream, PdfDocumentOpenMode.Import);

                    // Obter range de pÃ¡ginas
                    string? pageRange = pageRanges?.GetValueOrDefault(fileName);
                    List<int> pagesToInclude;

                    if (string.IsNullOrWhiteSpace(pageRange))
                    {
                        // Se nÃ£o houver range, incluir todas as pÃ¡ginas
                        pagesToInclude = Enumerable.Range(1, inputDocument.PageCount).ToList();
                        _logger.LogInformation($"   Range: todas as pÃ¡ginas (1-{inputDocument.PageCount})");
                    }
                    else
                    {
                        // Parsear range especificado
                        pagesToInclude = ParsePageRange(pageRange, inputDocument.PageCount);
                        _logger.LogInformation($"   Range: {pageRange} â†’ {pagesToInclude.Count} pÃ¡gina(s)");
                    }

                    // Adicionar pÃ¡ginas ao documento de saÃ­da
                    foreach (var pageNumber in pagesToInclude)
                    {
                        // PdfSharp usa Ã­ndice 0-based
                        var page = inputDocument.Pages[pageNumber - 1];
                        outputDocument.AddPage(page);
                    }

                    _logger.LogInformation($"âœ… {pagesToInclude.Count} pÃ¡gina(s) adicionada(s) de {fileName}");
                }
                catch (Exception ex)
                {
                    _logger.LogError(ex, $"âŒ Erro ao processar {fileName}");
                    throw new InvalidOperationException($"Erro ao processar {fileName}: {ex.Message}", ex);
                }

                fileIndex++;
            }

            if (outputDocument.PageCount == 0)
            {
                throw new InvalidOperationException("Nenhuma pÃ¡gina foi adicionada ao PDF mesclado");
            }

            _logger.LogInformation($"âœ… Mesclagem concluÃ­da: {outputDocument.PageCount} pÃ¡gina(s) no total");

            // Salvar em memÃ³ria
            using var ms = new MemoryStream();
            outputDocument.Save(ms, false);
            return ms.ToArray();
        });
    }

    public List<int> ParsePageRange(string pageRange, int totalPages)
    {
        if (string.IsNullOrWhiteSpace(pageRange))
        {
            throw new ArgumentException("Range de pÃ¡ginas nÃ£o pode estar vazio");
        }

        var pages = new HashSet<int>();
        var parts = pageRange.Split(',', StringSplitOptions.RemoveEmptyEntries);

        foreach (var part in parts)
        {
            var trimmedPart = part.Trim();

            if (trimmedPart.Contains('-'))
            {
                // Range como "3-7"
                var rangeParts = trimmedPart.Split('-');
                if (rangeParts.Length != 2)
                {
                    throw new ArgumentException($"Range invÃ¡lido: '{trimmedPart}'");
                }

                if (!int.TryParse(rangeParts[0].Trim(), out int start) ||
                    !int.TryParse(rangeParts[1].Trim(), out int end))
                {
                    throw new ArgumentException($"Range invÃ¡lido: '{trimmedPart}'");
                }

                if (start < 1 || end < 1)
                {
                    throw new ArgumentException($"NÃºmeros de pÃ¡gina devem ser maiores que 0");
                }

                if (start > end)
                {
                    throw new ArgumentException($"Range invÃ¡lido: inÃ­cio ({start}) maior que fim ({end})");
                }

                if (start > totalPages || end > totalPages)
                {
                    throw new ArgumentException($"PÃ¡gina fora do limite: mÃ¡ximo Ã© {totalPages}");
                }

                for (int i = start; i <= end; i++)
                {
                    pages.Add(i);
                }
            }
            else
            {
                // PÃ¡gina individual
                if (!int.TryParse(trimmedPart, out int pageNum))
                {
                    throw new ArgumentException($"NÃºmero de pÃ¡gina invÃ¡lido: '{trimmedPart}'");
                }

                if (pageNum < 1)
                {
                    throw new ArgumentException($"NÃºmero de pÃ¡gina deve ser maior que 0");
                }

                if (pageNum > totalPages)
                {
                    throw new ArgumentException($"PÃ¡gina {pageNum} fora do limite: mÃ¡ximo Ã© {totalPages}");
                }

                pages.Add(pageNum);
            }
        }

        if (pages.Count == 0)
        {
            throw new ArgumentException("Nenhuma pÃ¡gina vÃ¡lida no range especificado");
        }

        return pages.OrderBy(p => p).ToList();
    }

    public async Task<byte[]> ExtractPagesAsync(Stream pdfStream, List<int> pageNumbers)
    {
        _logger.LogInformation($"âœ‚ï¸ Extraindo {pageNumbers.Count} pÃ¡gina(s)");

        return await Task.Run(() =>
        {
            pdfStream.Position = 0;
            using var inputDocument = PdfReader.Open(pdfStream, PdfDocumentOpenMode.Import);
            using var outputDocument = new PdfDocument();

            // Validar nÃºmeros de pÃ¡ginas
            foreach (var pageNumber in pageNumbers)
            {
                if (pageNumber < 1 || pageNumber > inputDocument.PageCount)
                {
                    throw new ArgumentException($"PÃ¡gina {pageNumber} fora do limite (1-{inputDocument.PageCount})");
                }

                // PdfSharp usa Ã­ndice 0-based
                var page = inputDocument.Pages[pageNumber - 1];
                outputDocument.AddPage(page);
            }

            _logger.LogInformation($"âœ… {pageNumbers.Count} pÃ¡gina(s) extraÃ­da(s)");

            using var ms = new MemoryStream();
            outputDocument.Save(ms, false);
            return ms.ToArray();
        });
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Infrastructure\PdfServices\PdfRotateService.cs
----------------------------------------

using PdfProcessor.Core.Interfaces;
using PdfProcessor.Core.Enums;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;
using Docnet.Core;
using Docnet.Core.Models;
using SixLabors.ImageSharp;
using SixLabors.ImageSharp.PixelFormats;
using SixLabors.ImageSharp.Processing;
using SixLabors.ImageSharp.Formats.Png;

namespace PdfProcessor.Infrastructure.PdfServices;

/// <summary>
/// ServiÃ§o para rotaÃ§Ã£o de PDFs usando PdfSharp e Docnet.Core para thumbnails
/// </summary>
public class PdfRotateService : IPdfRotateService
{
  /// <summary>
  /// Rotaciona um Ãºnico PDF
  /// </summary>
  public async Task<byte[]> RotatePdfAsync(Stream pdfStream, RotationAngle rotationAngle, string fileName)
  {
    return await Task.Run(() =>
    {
      using var outputStream = new MemoryStream();

      // Abrir PDF
      pdfStream.Position = 0;
      using var document = PdfReader.Open(pdfStream, PdfDocumentOpenMode.Modify);

      // Converter RotationAngle para graus
      int degrees = ConvertRotationAngleToDegrees(rotationAngle);

      // Rotacionar todas as pÃ¡ginas
      foreach (PdfPage page in document.Pages)
      {
        page.Rotate = NormalizeRotation(page.Rotate + degrees);
      }

      // Salvar
      document.Save(outputStream, false);
      return outputStream.ToArray();
    });
  }

  /// <summary>
  /// Rotaciona mÃºltiplos PDFs retornando dicionÃ¡rio com nome e bytes
  /// </summary>
  public async Task<Dictionary<string, byte[]>> RotateBatchAsync(
      Dictionary<string, Stream> files,
      Dictionary<string, RotationAngle> rotations)
  {
    var results = new Dictionary<string, byte[]>();

    foreach (var pdf in files)
    {
      var fileName = pdf.Key;
      var stream = pdf.Value;

      // Obter rotaÃ§Ã£o para este arquivo (default None)
      var rotation = rotations.ContainsKey(fileName) ? rotations[fileName] : RotationAngle.None;

      if (rotation == RotationAngle.None)
      {
        // Sem rotaÃ§Ã£o, apenas copiar
        stream.Position = 0;
        using var ms = new MemoryStream();
        await stream.CopyToAsync(ms);
        results[fileName] = ms.ToArray();
      }
      else
      {
        // Rotacionar
        var rotatedBytes = await RotatePdfAsync(stream, rotation, fileName);
        results[fileName] = rotatedBytes;
      }
    }

    return results;
  }

  /// <summary>
  /// ObtÃ©m informaÃ§Ãµes de um PDF
  /// </summary>
  public async Task<PdfInfo> GetPdfInfoAsync(Stream pdfStream)
  {
    return await Task.Run(() =>
    {
      pdfStream.Position = 0;
      using var document = PdfReader.Open(pdfStream, PdfDocumentOpenMode.Import);

      return new PdfInfo
      {
        PageCount = document.PageCount,
        Title = document.Info.Title ?? string.Empty,
        Author = document.Info.Author ?? string.Empty,
        Subject = document.Info.Subject ?? string.Empty,
        FileName = string.Empty // SerÃ¡ preenchido pelo controller
      };
    });
  }

  /// <summary>
  /// Gera miniatura (primeira pÃ¡gina) de um PDF como PNG em bytes
  /// </summary>
  public async Task<byte[]> GenerateThumbnailAsync(Stream pdfStream, int width = 200, int height = 200)
  {
    return await Task.Run(() =>
    {
      try
      {
        pdfStream.Position = 0;

        // Copiar stream para array de bytes (Docnet precisa de byte[])
        byte[] pdfBytes;
        using (var ms = new MemoryStream())
        {
          pdfStream.CopyTo(ms);
          pdfBytes = ms.ToArray();
        }

        // Usar Docnet.Core para renderizar primeira pÃ¡gina
        using var library = DocLib.Instance;
        using var docReader = library.GetDocReader(pdfBytes, new PageDimensions(width * 2, height * 2));

        if (docReader.GetPageCount() == 0)
        {
          return GeneratePlaceholderImage(width, height);
        }

        using var pageReader = docReader.GetPageReader(0); // Primeira pÃ¡gina
        var rawBytes = pageReader.GetImage();
        var pageWidth = pageReader.GetPageWidth();
        var pageHeight = pageReader.GetPageHeight();

        // Converter raw bytes para imagem usando ImageSharp
        using var image = Image.LoadPixelData<Bgra32>(rawBytes, pageWidth, pageHeight);

        // Redimensionar mantendo proporÃ§Ã£o
        image.Mutate(x => x.Resize(new ResizeOptions
        {
          Size = new Size(width, height),
          Mode = ResizeMode.Max
        }));

        // Converter para PNG
        using var outputStream = new MemoryStream();
        image.SaveAsPng(outputStream);
        return outputStream.ToArray();
      }
      catch (Exception ex)
      {
        Console.WriteLine($"Erro ao gerar thumbnail: {ex.Message}");
        return GeneratePlaceholderImage(width, height);
      }
    });
  }

  /// <summary>
  /// Gera imagem placeholder quando nÃ£o consegue renderizar o PDF
  /// </summary>
  private static byte[] GeneratePlaceholderImage(int width, int height)
  {
    // Criar imagem simples com fundo cinza
    using var image = new Image<Rgba32>(width, height);

    // Preencher com cor de fundo
    var backgroundColor = Color.FromRgb(247, 250, 252);
    for (int y = 0; y < height; y++)
    {
      for (int x = 0; x < width; x++)
      {
        image[x, y] = new Rgba32(247, 250, 252, 255);
      }
    }

    // Salvar como PNG
    using var outputStream = new MemoryStream();
    var encoder = new PngEncoder();
    image.Save(outputStream, encoder);
    return outputStream.ToArray();
  }

  /// <summary>
  /// Converte RotationAngle enum para graus
  /// </summary>
  private static int ConvertRotationAngleToDegrees(RotationAngle angle)
  {
    return angle switch
    {
      RotationAngle.None => 0,
      RotationAngle.Rotate90 => 90,
      RotationAngle.Rotate180 => 180,
      RotationAngle.Rotate270 => 270,
      _ => 0
    };
  }

  /// <summary>
  /// Normaliza Ã¢ngulo de rotaÃ§Ã£o (0, 90, 180, 270)
  /// </summary>
  private static int NormalizeRotation(int rotation)
  {
    rotation = rotation % 360;
    if (rotation < 0) rotation += 360;
    return rotation;
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Shared\Class1.cs
----------------------------------------

namespace PdfProcessor.Shared;

public class Class1
{

}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Shared\PdfProcessor.Shared.csproj
----------------------------------------

<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Shared\Constants\AppConstants.cs
----------------------------------------

namespace PdfProcessor.Shared.Constants;

/// <summary>
/// Constantes relacionadas a arquivos
/// </summary>
public static class FileConstants
{
  /// <summary>
  /// Tamanho mÃ¡ximo de arquivo em bytes (16MB)
  /// </summary>
  public const long MaxFileSizeBytes = 16 * 1024 * 1024;

  /// <summary>
  /// ExtensÃµes de arquivo permitidas
  /// </summary>
  public static readonly string[] AllowedExtensions = { ".pdf" };

  /// <summary>
  /// Content-Type para PDF
  /// </summary>
  public const string PdfContentType = "application/pdf";

  /// <summary>
  /// Content-Type para Excel
  /// </summary>
  public const string ExcelContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";

  /// <summary>
  /// Content-Type para ZIP
  /// </summary>
  public const string ZipContentType = "application/zip";

  /// <summary>
  /// Pasta de upload temporÃ¡rio
  /// </summary>
  public const string UploadFolder = "uploads";

  /// <summary>
  /// Pasta de saÃ­da
  /// </summary>
  public const string OutputFolder = "outputs";

  /// <summary>
  /// Pasta temporÃ¡ria
  /// </summary>
  public const string TempFolder = "temp";
}

/// <summary>
/// Mensagens de erro padronizadas
/// </summary>
public static class ErrorMessages
{
  public const string NoFilesSelected = "Nenhum arquivo foi selecionado";
  public const string InvalidFileType = "Tipo de arquivo nÃ£o permitido. Apenas PDFs sÃ£o aceitos";
  public const string FileTooLarge = "Arquivo muito grande. Tamanho mÃ¡ximo: 16MB";
  public const string CorruptedPdf = "O arquivo PDF estÃ¡ corrompido ou invÃ¡lido";
  public const string NoDataExtracted = "Nenhum dado foi extraÃ­do do PDF";
  public const string ProcessingError = "Erro ao processar o arquivo";
  public const string InsufficientFiles = "NÃºmero insuficiente de arquivos para realizar esta operaÃ§Ã£o";
  public const string InvalidPageRange = "Range de pÃ¡ginas invÃ¡lido";
  public const string InvalidRotationAngle = "Ã‚ngulo de rotaÃ§Ã£o invÃ¡lido. Use: 0, 90, 180 ou 270";
  public const string MergeError = "Erro ao mesclar arquivos PDF";
  public const string CompressionError = "Erro ao comprimir arquivo PDF";
  public const string ExcelGenerationError = "Erro ao gerar arquivo Excel";
}

/// <summary>
/// Mensagens de sucesso padronizadas
/// </summary>
public static class SuccessMessages
{
  public const string ProcessingComplete = "Processamento concluÃ­do com sucesso";
  public const string FilesProcessed = "Arquivos processados com sucesso";
  public const string ExcelGenerated = "Arquivo Excel gerado com sucesso";
  public const string PdfsMerged = "PDFs mesclados com sucesso";
  public const string PdfsRotated = "PDFs rotacionados com sucesso";
  public const string PdfsCompressed = "PDFs comprimidos com sucesso";
}

/// <summary>
/// ConfiguraÃ§Ãµes padrÃ£o
/// </summary>
public static class DefaultSettings
{
  public const int DefaultThumbnailWidth = 200;
  public const int DefaultThumbnailHeight = 200;
  public const int DefaultImageQuality = 85;
  public const int DefaultMaxImageDpi = 150;
  public const int MaxBatchSize = 50;
  public const int ProcessingTimeoutSeconds = 300; // 5 minutos
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Shared\Extensions\CommonExtensions.cs
----------------------------------------

using System;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace PdfProcessor.Shared.Extensions;

/// <summary>
/// ExtensÃµes comuns utilizadas em todo o sistema
/// </summary>
public static class CommonExtensions
{
  #region String Extensions

  /// <summary>
  /// Verifica se a string estÃ¡ vazia ou nula
  /// </summary>
  public static bool IsNullOrEmpty(this string? value)
      => string.IsNullOrEmpty(value);

  /// <summary>
  /// Verifica se a string estÃ¡ vazia, nula ou contÃ©m apenas espaÃ§os em branco
  /// </summary>
  public static bool IsNullOrWhiteSpace(this string? value)
      => string.IsNullOrWhiteSpace(value);

  /// <summary>
  /// Remove espaÃ§os extras e normaliza a string
  /// </summary>
  public static string Normalize(this string value)
  {
    if (value.IsNullOrWhiteSpace())
      return string.Empty;

    return Regex.Replace(value.Trim(), @"\s+", " ");
  }

  /// <summary>
  /// Remove caracteres especiais mantendo apenas letras, nÃºmeros e espaÃ§os
  /// </summary>
  public static string RemoveSpecialCharacters(this string value)
  {
    if (value.IsNullOrWhiteSpace())
      return string.Empty;

    return Regex.Replace(value, @"[^a-zA-Z0-9\s]", "");
  }

  /// <summary>
  /// Converte string para tÃ­tulo (primeira letra maiÃºscula)
  /// </summary>
  public static string ToTitleCase(this string value)
  {
    if (value.IsNullOrWhiteSpace())
      return string.Empty;

    return CultureInfo.CurrentCulture.TextInfo.ToTitleCase(value.ToLower());
  }

  /// <summary>
  /// Trunca a string se exceder o tamanho mÃ¡ximo
  /// </summary>
  public static string Truncate(this string value, int maxLength, string suffix = "...")
  {
    if (value.IsNullOrWhiteSpace())
      return string.Empty;

    if (value.Length <= maxLength)
      return value;

    return value.Substring(0, maxLength - suffix.Length) + suffix;
  }

  #endregion

  #region Decimal Extensions

  /// <summary>
  /// Converte string para decimal, retornando null se invÃ¡lido
  /// </summary>
  public static decimal? ToDecimalOrNull(this string value)
  {
    if (value.IsNullOrWhiteSpace())
      return null;

    // Remove caracteres nÃ£o numÃ©ricos exceto . , -
    var cleaned = Regex.Replace(value, @"[^\d.,-]", "");

    // Tenta converter
    if (decimal.TryParse(cleaned, NumberStyles.Any, CultureInfo.InvariantCulture, out var result))
      return result;

    // Tenta com cultura pt-BR
    if (decimal.TryParse(cleaned, NumberStyles.Any, new CultureInfo("pt-BR"), out result))
      return result;

    return null;
  }

  /// <summary>
  /// Formata decimal como moeda brasileira
  /// </summary>
  public static string ToBrazilianCurrency(this decimal value)
      => value.ToString("C2", new CultureInfo("pt-BR"));

  /// <summary>
  /// Formata decimal como moeda americana
  /// </summary>
  public static string ToUSDCurrency(this decimal value)
      => value.ToString("C2", new CultureInfo("en-US"));

  #endregion

  #region DateTime Extensions

  /// <summary>
  /// Converte string para DateTime, retornando null se invÃ¡lido
  /// </summary>
  public static DateTime? ToDateTimeOrNull(this string value)
  {
    if (value.IsNullOrWhiteSpace())
      return null;

    var formats = new[]
    {
            "dd/MM/yyyy",
            "dd/MM/yy",
            "MM/dd/yyyy",
            "yyyy-MM-dd",
            "dd-MM-yyyy"
        };

    foreach (var format in formats)
    {
      if (DateTime.TryParseExact(value, format, CultureInfo.InvariantCulture,
          DateTimeStyles.None, out var result))
      {
        // âœ… CORREÃ‡ÃƒO: Especificar DateTimeKind.Unspecified
        return DateTime.SpecifyKind(result, DateTimeKind.Unspecified);
      }
    }

    if (DateTime.TryParse(value, out var parsedDate))
    {
      // âœ… CORREÃ‡ÃƒO: Especificar DateTimeKind.Unspecified
      return DateTime.SpecifyKind(parsedDate, DateTimeKind.Unspecified);
    }

    return null;
  }

  /// <summary>
  /// Formata DateTime para padrÃ£o brasileiro (dd/MM/yyyy)
  /// </summary>
  public static string ToBrazilianFormat(this DateTime dateTime)
      => dateTime.ToString("dd/MM/yyyy");

  /// <summary>
  /// Formata DateTime para padrÃ£o ISO (yyyy-MM-dd)
  /// </summary>
  public static string ToIsoFormat(this DateTime dateTime)
      => dateTime.ToString("yyyy-MM-dd");

  #endregion

  #region Collection Extensions

  /// <summary>
  /// Verifica se a coleÃ§Ã£o estÃ¡ vazia ou nula
  /// </summary>
  public static bool IsNullOrEmpty<T>(this IEnumerable<T>? collection)
      => collection == null || !collection.Any();

  /// <summary>
  /// Divide uma lista em chunks menores
  /// </summary>
  public static IEnumerable<List<T>> ChunkBy<T>(this IEnumerable<T> source, int chunkSize)
  {
    return source
        .Select((x, i) => new { Index = i, Value = x })
        .GroupBy(x => x.Index / chunkSize)
        .Select(x => x.Select(v => v.Value).ToList());
  }

  #endregion

  #region Stream Extensions

  /// <summary>
  /// Converte Stream para byte array
  /// </summary>
  public static async Task<byte[]> ToByteArrayAsync(this Stream stream)
  {
    if (stream is MemoryStream memoryStream)
      return memoryStream.ToArray();

    using var ms = new MemoryStream();
    await stream.CopyToAsync(ms);
    return ms.ToArray();
  }

  /// <summary>
  /// Reseta a posiÃ§Ã£o do Stream para o inÃ­cio
  /// </summary>
  public static void Reset(this Stream stream)
  {
    if (stream.CanSeek)
      stream.Position = 0;
  }

  #endregion

  #region File Extensions

  /// <summary>
  /// Sanitiza nome de arquivo removendo caracteres invÃ¡lidos
  /// </summary>
  public static string SanitizeFileName(this string fileName)
  {
    var invalidChars = Path.GetInvalidFileNameChars();
    var sanitized = string.Join("_", fileName.Split(invalidChars));
    return sanitized.Trim();
  }

  /// <summary>
  /// ObtÃ©m extensÃ£o do arquivo sem o ponto
  /// </summary>
  public static string GetExtensionWithoutDot(this string fileName)
      => Path.GetExtension(fileName).TrimStart('.');

  /// <summary>
  /// Verifica se o arquivo tem extensÃ£o PDF
  /// </summary>
  public static bool IsPdfFile(this string fileName)
      => fileName.GetExtensionWithoutDot().Equals("pdf", StringComparison.OrdinalIgnoreCase);

  #endregion
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\appsettings.Development.json
----------------------------------------

{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\appsettings.json
----------------------------------------

{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\PdfProcessor.Web.csproj
----------------------------------------

<Project Sdk="Microsoft.NET.Sdk.Web">

  <ItemGroup>
    <ProjectReference Include="..\PdfProcessor.Application\PdfProcessor.Application.csproj" />
  </ItemGroup>

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
  </PropertyGroup>

</Project>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Program.cs
----------------------------------------

using PdfProcessor.Web.Components;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddRazorComponents()
    .AddInteractiveServerComponents();

// âœ… ADICIONAR: Registrar HttpClient para fazer chamadas Ã  API
builder.Services.AddHttpClient("PdfProcessorAPI", client =>
{
    client.BaseAddress = new Uri("https://localhost:5239"); // URL da API
    client.Timeout = TimeSpan.FromMinutes(10); // Timeout para uploads grandes
});

// âœ… ADICIONAR: HttpClient padrÃ£o (para injeÃ§Ã£o direta)
builder.Services.AddScoped(sp =>
{
    var httpClientFactory = sp.GetRequiredService<IHttpClientFactory>();
    return httpClientFactory.CreateClient("PdfProcessorAPI");
});

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error", createScopeForErrors: true);
    // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
    app.UseHsts();
}

app.UseHttpsRedirection();

app.UseStaticFiles();
app.UseAntiforgery();

app.MapRazorComponents<App>()
    .AddInteractiveServerRenderMode();

app.Run();


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\App.razor
----------------------------------------

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    <link rel="stylesheet" href="bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="stylesheet" href="PdfProcessor.Web.styles.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <HeadOutlet />
</head>

<body>
    <Routes />
    <script src="_framework/blazor.web.js"></script>
    <script src="fileUploadHelper.js"></script>
</body>

</html>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Routes.razor
----------------------------------------

<Router AppAssembly="typeof(Program).Assembly">
    <Found Context="routeData">
        <RouteView RouteData="routeData" DefaultLayout="typeof(Layout.MainLayout)" />
        <FocusOnNavigate RouteData="routeData" Selector="h1" />
    </Found>
</Router>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\_Imports.razor
----------------------------------------

@using System.Net.Http
@using System.Net.Http.Json
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Web
@using static Microsoft.AspNetCore.Components.Web.RenderMode
@using Microsoft.AspNetCore.Components.Web.Virtualization
@using Microsoft.JSInterop
@using PdfProcessor.Web
@using PdfProcessor.Web.Components



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Layout\MainLayout.razor
----------------------------------------

@inherits LayoutComponentBase

<div class="page">
    <div class="sidebar">
        <div class="top-row ps-3 navbar navbar-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="">
                    <span class="brand-icon">📄</span>
                    <span class="brand-text">Extrator Tabelas PF</span>
                </a>
            </div>
        </div>

        <input type="checkbox" title="Navigation menu" id="navToggle" class="navbar-toggler" />

        <nav class="flex-column">
            <div class="nav-section">
                <div class="nav-section-title">INÍCIO</div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                        <span class="nav-icon">🏠</span> Dashboard
                    </NavLink>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">BANCOS</div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="btg-pactual">
                        <span class="nav-icon">🏦</span> BTG Pactual
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="itau-cash">
                        <span class="nav-icon">🏦</span> Itaú
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="morgan-stanley">
                        <span class="nav-icon">🏦</span> Morgan Stanley
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="ubs">
                        <span class="nav-icon">🏦</span> UBS Switzerland
                    </NavLink>
                </div>
                <div class="nav-item px-3 disabled">
                    <span class="nav-link">
                        <span class="nav-icon">🔜</span> Outros Bancos
                    </span>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="itau-cash2">
                        <span class="nav-icon">🦁</span> Itaú Cash 2.0
                    </NavLink>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Mov. Bancária</div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="itau-movimentacao">
                        <span class="nav-icon">💳</span> Itaú Movimentação
                    </NavLink>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">FERRAMENTAS PDF</div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="rotate-pdf">
                        <span class="nav-icon">🔄</span> Rotacionar
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="merge-pdf">
                        <span class="nav-icon">🔗</span> Mesclar
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="compress-pdf">
                        <span class="nav-icon">🗜️</span> Comprimir
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="edit-pdf">
                        <span class="icon">✂️</span> Editar PDF
                    </NavLink>
                </div>
            </div>


            <div class="nav-section">
                <div class="nav-section-title">AJUDA</div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="help">
                        <span class="nav-icon">❓</span> Documentação
                    </NavLink>
                </div>
            </div>
        </nav>
    </div>

    <main>
        <div class="top-row px-4">
            <label for="navToggle" class="navbar-toggler">
                <span class="navbar-toggler-icon"></span>
            </label>
        </div>

        <article class="content px-4">
            @Body
        </article>
    </main>
</div>

<div id="blazor-error-ui">
    Ocorreu um erro inesperado.
    <a href="" class="reload">Recarregar</a>
    <a class="dismiss">🗙</a>
</div>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Layout\MainLayout.razor.css
----------------------------------------

.page {
    position: relative;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

main {
    flex: 1;
}

.sidebar {
    background: linear-gradient(180deg, #1a202c 0%, #2d3748 100%);
    width: 280px;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    overflow-y: auto;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
}

.top-row {
    background-color: rgba(0, 0, 0, 0.2);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    height: 4rem;
    display: flex;
    align-items: center;
    padding: 0 1rem;
}

.navbar-brand {
    font-size: 1.25rem;
    font-weight: 600;
    color: white !important;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.brand-icon {
    font-size: 1.5rem;
}

.brand-text {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 700;
}

.navbar-toggler {
    appearance: none;
    cursor: pointer;
    width: 2rem;
    height: 1.5rem;
    background: transparent;
    border: none;
    position: absolute;
    right: 1rem;
    display: none;
}

.navbar-toggler-icon {
    display: block;
    width: 100%;
    height: 2px;
    background: white;
    position: relative;
}

.navbar-toggler-icon::before,
.navbar-toggler-icon::after {
    content: '';
    display: block;
    width: 100%;
    height: 2px;
    background: white;
    position: absolute;
    left: 0;
}

.navbar-toggler-icon::before {
    top: -8px;
}

.navbar-toggler-icon::after {
    bottom: -8px;
}

.sidebar nav {
    padding: 1rem 0;
}

.nav-section {
    margin-bottom: 1.5rem;
}

.nav-section-title {
    font-size: 0.75rem;
    font-weight: 700;
    color: #a0aec0;
    padding: 0.5rem 1.5rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
}

.nav-item {
    font-size: 0.95rem;
}

.nav-link {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: #e2e8f0;
    border-radius: 0.5rem;
    padding: 0.75rem 1rem;
    margin: 0.25rem 0.5rem;
    text-decoration: none;
    transition: all 0.2s ease;
    font-weight: 500;
}

.nav-link:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: white;
    transform: translateX(5px);
}

.nav-link.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.nav-icon {
    font-size: 1.25rem;
    width: 1.5rem;
    text-align: center;
}

.nav-item.disabled .nav-link {
    opacity: 0.5;
    cursor: not-allowed;
}

.nav-item.disabled .nav-link:hover {
    background-color: transparent;
    transform: none;
}

main {
    padding-left: 280px;
    background: #f7fafc;
    min-height: 100vh;
}

main .top-row {
    background-color: white;
    border-bottom: 1px solid #e2e8f0;
    position: sticky;
    top: 0;
    z-index: 1;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.content {
    padding: 2rem 1rem;
}

#blazor-error-ui {
    background: #ef4444;
    color: white;
    padding: 1rem;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    display: none;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
}

#blazor-error-ui .reload,
#blazor-error-ui .dismiss {
    color: white;
    text-decoration: underline;
    cursor: pointer;
    margin-left: 1rem;
}

/* Responsivo */
@media (max-width: 768px) {
    .sidebar {
        width: 100%;
        height: auto;
        position: relative;
    }

    .sidebar nav {
        display: none;
    }

    .navbar-toggler {
        display: block;
    }

    #navToggle:checked ~ nav {
        display: block;
    }

    main {
        padding-left: 0;
    }

    main .top-row {
        position: relative;
    }
}

/* Scrollbar personalizada para o sidebar */
.sidebar::-webkit-scrollbar {
    width: 6px;
}

.sidebar::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
}

.sidebar::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 3px;
}

.sidebar::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Layout\NavMenu.razor
----------------------------------------

<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="">PdfProcessor.Web</a>
    </div>
</div>

<input type="checkbox" title="Navigation menu" class="navbar-toggler" />

<div class="nav-scrollable" onclick="document.querySelector('.navbar-toggler').click()">
    <nav class="flex-column">
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                <span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> Home
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="counter">
                <span class="bi bi-plus-square-fill-nav-menu" aria-hidden="true"></span> Counter
            </NavLink>
        </div>

        <div class="nav-item px-3">
            <NavLink class="nav-link" href="weather">
                <span class="bi bi-list-nested-nav-menu" aria-hidden="true"></span> Weather
            </NavLink>
        </div>
    </nav>
</div>




----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Layout\NavMenu.razor.css
----------------------------------------

.navbar-toggler {
    appearance: none;
    cursor: pointer;
    width: 3.5rem;
    height: 2.5rem;
    color: white;
    position: absolute;
    top: 0.5rem;
    right: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") no-repeat center/1.75rem rgba(255, 255, 255, 0.1);
}

.navbar-toggler:checked {
    background-color: rgba(255, 255, 255, 0.5);
}

.top-row {
    height: 3.5rem;
    background-color: rgba(0,0,0,0.4);
}

.navbar-brand {
    font-size: 1.1rem;
}

.bi {
    display: inline-block;
    position: relative;
    width: 1.25rem;
    height: 1.25rem;
    margin-right: 0.75rem;
    top: -1px;
    background-size: cover;
}

.bi-house-door-fill-nav-menu {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-house-door-fill' viewBox='0 0 16 16'%3E%3Cpath d='M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5Z'/%3E%3C/svg%3E");
}

.bi-plus-square-fill-nav-menu {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-plus-square-fill' viewBox='0 0 16 16'%3E%3Cpath d='M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6.5 4.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3a.5.5 0 0 1 1 0z'/%3E%3C/svg%3E");
}

.bi-list-nested-nav-menu {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-list-nested' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M4.5 11.5A.5.5 0 0 1 5 11h10a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 1 3h10a.5.5 0 0 1 0 1H1a.5.5 0 0 1-.5-.5z'/%3E%3C/svg%3E");
}

.nav-item {
    font-size: 0.9rem;
    padding-bottom: 0.5rem;
}

    .nav-item:first-of-type {
        padding-top: 1rem;
    }

    .nav-item:last-of-type {
        padding-bottom: 1rem;
    }

    .nav-item ::deep .nav-link {
        color: #d7d7d7;
        background: none;
        border: none;
        border-radius: 4px;
        height: 3rem;
        display: flex;
        align-items: center;
        line-height: 3rem;
        width: 100%;
    }

.nav-item ::deep a.active {
    background-color: rgba(255,255,255,0.37);
    color: white;
}

.nav-item ::deep .nav-link:hover {
    background-color: rgba(255,255,255,0.1);
    color: white;
}

.nav-scrollable {
    display: none;
}

.navbar-toggler:checked ~ .nav-scrollable {
    display: block;
}

@media (min-width: 641px) {
    .navbar-toggler {
        display: none;
    }

    .nav-scrollable {
        /* Never collapse the sidebar for wide screens */
        display: block;

        /* Allow sidebar to scroll for tall menus */
        height: calc(100vh - 3.5rem);
        overflow-y: auto;
    }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\Btg.razor
----------------------------------------

@page "/btg-pactual"
@page "/btg"

<PageTitle>BTG Pactual - Transactions - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">ðŸ¦</div>
    <div>
      <h1>BTG Pactual - Transactions</h1>
      <p class="subtitle">ExtraÃ§Ã£o automÃ¡tica de transaÃ§Ãµes do BTG Pactual</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">â„¹ï¸</div>
      <div>
        <strong>Como funciona:</strong>
        <ul>
          <li>Selecione um ou mÃºltiplos PDFs de extrato BTG Pactual</li>
          <li>O sistema identifica automaticamente a tabela "Transactions in Date Sequence"</li>
          <li>Extrai todas as colunas: Data, Activity Type, Description, Quantity, Price, Amount, etc</li>
          <li>Gera um arquivo Excel consolidado com todas as transaÃ§Ãµes</li>
        </ul>
      </div>
    </div>

    <div class="info-box warning">
      <div class="info-icon">âš ï¸</div>
      <div>
        <strong>Estrutura do PDF:</strong>
        <ul style="margin: 0.5rem 0 0 0;">
          <li>InÃ­cio da tabela: <code>"Transactions in Date Sequence"</code></li>
          <li>ContinuaÃ§Ã£o: <code>"Transactions in Date Sequence (continued)"</code></li>
          <li>Fim da tabela: <code>"Total Value of Transactions"</code></li>
          <li>RodapÃ© ignorado apÃ³s: <code>"Page N of N"</code></li>
        </ul>
      </div>
    </div>

    <div class="upload-section">
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">ðŸ“</div>
        <div class="upload-text">Clique aqui ou arraste os PDFs</div>
        <div class="upload-hint">Selecione mÃºltiplos PDFs do BTG Pactual (mÃ¡x. 16MB cada)</div>
      </div>
      <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />
    </div>

    <!-- Lista de arquivos selecionados -->
    <div id="filesSelected" class="files-selected" style="display: none;">
      <div class="files-header">ðŸ“‹ Arquivos Selecionados:</div>
      <div id="filesList" class="files-list"></div>
      <div id="filesSummary" class="files-summary"></div>
    </div>

    <!-- BotÃµes de aÃ§Ã£o -->
    <div id="actionButtons" class="action-section" style="display: none;">
      <button class="btn btn-primary" id="processBtn" onclick="processFiles()" disabled>
        ðŸ¦ Processar e Gerar Excel
      </button>
      <button class="btn btn-secondary" onclick="clearFiles()">
        ðŸ—‘ï¸ Limpar
      </button>
    </div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Processando extratos do BTG Pactual...</p>
    </div>

    <!-- Mensagem de status -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">ðŸ“Š</div>
      <h4>ExtraÃ§Ã£o Completa</h4>
      <p>Todas as 9 colunas da tabela de transaÃ§Ãµes</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ”„</div>
      <h4>Multi-pÃ¡gina</h4>
      <p>Processa tabelas que continuam em vÃ¡rias pÃ¡ginas</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">âš¡</div>
      <h4>Batch Processing</h4>
      <p>MÃºltiplos PDFs em um Ãºnico Excel</p>
    </div>
  </div>
</div>

<!-- style -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="css/btg.css" />

<!-- 1. Carregar dependÃªncias compartilhadas PRIMEIRO -->
<script src="/js/api-config.js"></script>
<script src="/js/pdf-upload-handler.js"></script>

<!-- 2. Carregar script especÃ­fico do banco DEPOIS -->
<script src="/js/btg.js"></script>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\CompressPdf.razor
----------------------------------------

@page "/compress-pdf"
@page "/comprimir"

<PageTitle>Comprimir PDF - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">ðŸ—œï¸</div>
    <div>
      <h1>Comprimir PDF</h1>
      <p class="subtitle">Reduza o tamanho de arquivos PDF mantendo a qualidade</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">â„¹ï¸</div>
      <div>
        <strong>Como funciona:</strong>
        <ul>
          <li>Selecione um ou mÃºltiplos arquivos PDF</li>
          <li>Escolha o nÃ­vel de compressÃ£o para cada arquivo</li>
          <li>Opcionalmente, remova imagens para maior compressÃ£o</li>
          <li>Baixe os arquivos comprimidos individualmente ou em ZIP</li>
        </ul>
      </div>
    </div>

    <div class="upload-section">
      <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">ðŸ“</div>
        <div class="upload-text">Clique aqui ou arraste os PDFs</div>
        <div class="upload-hint">Selecione mÃºltiplos PDFs para comprimir (mÃ¡x. 16MB cada)</div>
      </div>
      <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />
    </div>

    <!-- Contador de arquivos -->
    <div id="fileCounter" class="file-counter" style="display: none;">
      <span class="counter-icon">ðŸ“‹</span>
      <span id="counterText">Arquivos Carregados: 0</span>
    </div>

    <!-- Grid de arquivos -->
    <div id="filesGrid" class="files-grid"></div>

    <!-- BotÃµes de aÃ§Ã£o -->
    <div id="actionButtons" class="action-section" style="display: none;">
      <div class="batch-compression-buttons">
        <button class="btn btn-batch btn-low" onclick="applyCompressionToAll('Low')">
          ðŸŸ¢ Todos: Baixa
        </button>
        <button class="btn btn-batch btn-medium" onclick="applyCompressionToAll('Medium')">
          ðŸŸ¡ Todos: MÃ©dia
        </button>
        <button class="btn btn-batch btn-high" onclick="applyCompressionToAll('High')">
          ðŸ”´ Todos: Alta
        </button>
      </div>
      
      <div class="main-action-buttons">
        <button class="btn btn-primary" onclick="compressAllFiles()">
          ðŸ—œï¸ Comprimir PDFs
        </button>
        <button class="btn btn-secondary" onclick="clearAllFiles()">
          ðŸ—‘ï¸ Limpar
        </button>
      </div>
    </div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Processando...</p>
    </div>

    <!-- Mensagem de status -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">âš™ï¸</div>
      <h4>3 NÃ­veis</h4>
      <p>Escolha o nÃ­vel ideal de compressÃ£o</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ–¼ï¸</div>
      <h4>OtimizaÃ§Ã£o de Imagens</h4>
      <p>CompressÃ£o inteligente de imagens</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ“Š</div>
      <h4>EstatÃ­sticas</h4>
      <p>Veja quanto espaÃ§o economizou</p>
    </div>
  </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/compress-pdf.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do Compress PDF -->
<script src="/js/compress-pdf.js"></script>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\Counter.razor
----------------------------------------

@page "/counter"
@rendermode InteractiveServer

<PageTitle>Counter</PageTitle>

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>

<button class="btn btn-primary" @onclick="IncrementCount">Click me</button>

@code {
    private int currentCount = 0;

    private void IncrementCount()
    {
        currentCount++;
    }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\Dashboard.razor
----------------------------------------

@page "/"
@page "/dashboard"

<PageTitle>Extrator Tabelas PF - Dashboard</PageTitle>

<link rel="stylesheet" href="css/dashboard.css" />

<div class="dashboard-modern">
    <!-- Header -->
    <div class="dashboard-header">
        <div class="header-content">
            <div class="header-title">
                <h1>ðŸ“„ Extrator Tabelas PF</h1>
                <p>Sistema de ExtraÃ§Ã£o e ManipulaÃ§Ã£o de PDFs BancÃ¡rios</p>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-number">5</span>
                    <span class="stat-label">Bancos</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">3</span>
                    <span class="stat-label">Ferramentas</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Grid de Cards -->
    <div class="cards-container">

        <!-- SeÃ§Ã£o: ExtraÃ§Ã£o BancÃ¡ria -->
        <div class="section">
            <div class="section-header">
                <h2>ðŸ¦ ExtraÃ§Ã£o BancÃ¡ria</h2>
                <span class="section-count">4 bancos disponÃ­veis</span>
            </div>

            <div class="cards-grid">
                <a href="/itau-cash" class="card bank-card">
                    <div class="card-icon itau">ðŸŸ§</div>
                    <div class="card-body">
                        <h3>ItaÃº Cash</h3>
                        <p>TransaÃ§Ãµes em USD/EUR/BRL</p>
                    </div>
                    <div class="card-badge active">Ativo</div>
                </a>

                <a href="/btg" class="card bank-card">
                    <div class="card-icon btg">ðŸ¦</div>
                    <div class="card-body">
                        <h3>BTG Pactual</h3>
                        <p>Account Statements</p>
                    </div>
                    <div class="card-badge active">Ativo</div>
                </a>

                <a href="/ubs" class="card bank-card">
                    <div class="card-icon ubs">ðŸ’¼</div>
                    <div class="card-body">
                        <h3>UBS Switzerland</h3>
                        <p>Current Account USD/CHF</p>
                    </div>
                    <div class="card-badge active">Ativo</div>
                </a>

                <a href="/morgan-stanley" class="card bank-card">
                    <div class="card-icon morgan">ðŸ“Š</div>
                    <div class="card-body">
                        <h3>Morgan Stanley</h3>
                        <p>Cash Flow Activity</p>
                    </div>
                    <div class="card-badge active">Ativo</div>
                </a>
            </div>
        </div>

        <!-- SeÃ§Ã£o: ExtraÃ§Ã£o BancÃ¡ria -->
        <div class="section">
            <div class="section-header">
                <h2>ðŸ¦ MovimentaÃ§Ã£o BancÃ¡ria</h2>
                <span class="section-count">1 banco disponÃ­vel</span>
            </div>

            <div class="cards-grid">
                <a href="/itau-movimentacao" class="card bank-card">
                    <div class="card-icon itau">ðŸ’³</div>
                    <div class="card-body">
                        <h3>ItaÃº MovimentaÃ§Ã£o</h3>
                        <p>Extrato completo bancÃ¡rio</p>
                    </div>
                    <div class="card-badge active">Ativo</div>
                </a>
            </div>
        </div>

        <!-- SeÃ§Ã£o: Ferramentas PDF -->
        <div class="section">
            <div class="section-header">
                <h2>ðŸ› ï¸ Ferramentas PDF</h2>
                <span class="section-count">3 ferramentas</span>
            </div>

            <div class="cards-grid tools-grid">
                <a href="/rotate-pdf" class="card tool-card">
                    <div class="card-icon tool">ðŸ”„</div>
                    <div class="card-body">
                        <h3>Rotacionar</h3>
                        <p>Gire pÃ¡ginas com preview</p>
                    </div>
                </a>

                <a href="/compress-pdf" class="card tool-card">
                    <div class="card-icon tool">ðŸ—œï¸</div>
                    <div class="card-body">
                        <h3>Comprimir</h3>
                        <p>Reduza tamanho (3 nÃ­veis)</p>
                    </div>
                </a>

                <a href="/merge-pdf" class="card tool-card">
                    <div class="card-icon tool">ðŸ”—</div>
                    <div class="card-body">
                        <h3>Mesclar</h3>
                        <p>Combine mÃºltiplos PDFs</p>
                    </div>
                </a>
            </div>
        </div>

    </div>

    <!-- Footer Info -->
    <div class="dashboard-footer">
        <div class="footer-info">
            <div class="info-item">
                <span class="info-icon">ðŸ“</span>
                <span>MÃ¡x: 16MB por arquivo</span>
            </div>
            <div class="info-item">
                <span class="info-icon">ðŸ“Š</span>
                <span>SaÃ­da: Excel (.xlsx)</span>
            </div>
            <div class="info-item">
                <span class="info-icon">ðŸ”’</span>
                <span>Processamento local seguro</span>
            </div>
        </div>
    </div>
</div>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\EditPdf.razor
----------------------------------------

@page "/edit-pdf"
@page "/editar"

<PageTitle>Editar PDF - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">âœ‚ï¸</div>
    <div>
      <h1>Editar PDF</h1>
      <p class="subtitle">Rotacione e remova pÃ¡ginas individualmente</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">â„¹ï¸</div>
      <div>
        <strong>Como funciona:</strong>
        <ul>
          <li>Selecione <strong>um Ãºnico arquivo PDF</strong></li>
          <li>Visualize miniaturas de todas as pÃ¡ginas</li>
          <li>Rotacione pÃ¡ginas individuais (â†¶ â†·)</li>
          <li>Marque pÃ¡ginas para remoÃ§Ã£o (ðŸ—‘ï¸)</li>
          <li>FaÃ§a download do PDF editado</li>
        </ul>
      </div>
    </div>

    <div class="upload-section">
      <!-- âœ… Upload via sistema compartilhado -->
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">ðŸ“</div>
        <div class="upload-text">Clique aqui ou arraste um PDF</div>
        <div class="upload-hint">Selecione apenas um arquivo PDF (mÃ¡x. 16MB)</div>
      </div>
      <input type="file" id="fileInput" class="hidden-file-input" accept=".pdf" />
    </div>

    <!-- InformaÃ§Ãµes do arquivo carregado -->
    <div id="fileInfoContainer" style="display: none;"></div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Carregando pÃ¡ginas...</p>
    </div>

    <!-- Mensagem de status -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <!-- Grid de pÃ¡ginas (aparece apÃ³s carregar) -->
  <div id="pagesSection" class="pages-section" style="display: none;">
    
    <!-- EstatÃ­sticas -->
    <div class="action-section">
      <div class="action-stats" id="actionStats"></div>
    </div>

    <!-- Grid de pÃ¡ginas -->
    <div class="pages-grid" id="pagesGrid"></div>

    <!-- BotÃµes de aÃ§Ã£o -->
    <div class="action-section">
      <button class="btn btn-primary" id="downloadBtn" onclick="downloadEditedPdf()" disabled>
        ðŸ“¥ Download PDF
      </button>
      <button class="btn btn-secondary" onclick="resetRotations()">
        ðŸ”„ Resetar RotaÃ§Ãµes
      </button>
      <button class="btn btn-secondary" onclick="resetDeletions()">
        â†©ï¸ Restaurar Todas
      </button>
      <button class="btn btn-danger" onclick="resetAll()">
        ðŸ—‘ï¸ Limpar Tudo
      </button>
    </div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">ðŸ”„</div>
      <h4>RotaÃ§Ã£o por PÃ¡gina</h4>
      <p>Rotacione apenas as pÃ¡ginas que precisa</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">âœ‚ï¸</div>
      <h4>RemoÃ§Ã£o Seletiva</h4>
      <p>Delete pÃ¡ginas indesejadas facilmente</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ‘ï¸</div>
      <h4>Preview Visual</h4>
      <p>Veja as mudanÃ§as em tempo real</p>
    </div>
  </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/edit-pdf.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do Edit PDF -->
<script src="/js/edit-pdf.js"></script>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\Error.razor
----------------------------------------

@page "/Error"
@using System.Diagnostics

<PageTitle>Error</PageTitle>

<h1 class="text-danger">Error.</h1>
<h2 class="text-danger">An error occurred while processing your request.</h2>

@if (ShowRequestId)
{
    <p>
        <strong>Request ID:</strong> <code>@RequestId</code>
    </p>
}

<h3>Development Mode</h3>
<p>
    Swapping to <strong>Development</strong> environment will display more detailed information about the error that occurred.
</p>
<p>
    <strong>The Development environment shouldn't be enabled for deployed applications.</strong>
    It can result in displaying sensitive information from exceptions to end users.
    For local debugging, enable the <strong>Development</strong> environment by setting the <strong>ASPNETCORE_ENVIRONMENT</strong> environment variable to <strong>Development</strong>
    and restarting the app.
</p>

@code{
    [CascadingParameter]
    private HttpContext? HttpContext { get; set; }

    private string? RequestId { get; set; }
    private bool ShowRequestId => !string.IsNullOrEmpty(RequestId);

    protected override void OnInitialized() =>
        RequestId = Activity.Current?.Id ?? HttpContext?.TraceIdentifier;
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\Help.razor
----------------------------------------

@page "/help"

<PageTitle>DocumentaÃ§Ã£o - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">â“</div>
    <div>
      <h1>DocumentaÃ§Ã£o</h1>
      <p class="subtitle">Guia completo de uso do sistema</p>
    </div>
  </div>

  <div class="content-card">
    <h2>ðŸ› ï¸ Ferramentas PDF</h2>

    <div class="help-section">
      <h3>âœï¸ Editar PDF</h3>
      <p>Ferramenta completa para ediÃ§Ã£o avanÃ§ada de PDFs com preview visual.</p>
      <ul>
        <li><strong>Entrada:</strong> Um arquivo PDF por vez</li>
        <li><strong>Recursos:</strong>
          <ul>
            <li>RotaÃ§Ã£o de pÃ¡ginas individuais (90Â°, 180Â°, 270Â°)</li>
            <li>RemoÃ§Ã£o de pÃ¡ginas especÃ­ficas</li>
            <li>Preview visual de todas as pÃ¡ginas</li>
            <li>Indicadores visuais de rotaÃ§Ã£o</li>
          </ul>
        </li>
        <li><strong>Interface:</strong> Grid visual com miniaturas das pÃ¡ginas</li>
        <li><strong>SaÃ­da:</strong> PDF editado com pÃ¡ginas rotacionadas e/ou removidas</li>
      </ul>
      <div class="info-box info">
        <div class="info-icon">ðŸ’¡</div>
        <div>
          <strong>Dica:</strong> Clique nos botÃµes de rotaÃ§Ã£o para girar pÃ¡ginas especÃ­ficas. Use o botÃ£o de lixeira para marcar pÃ¡ginas para remoÃ§Ã£o (elas ficam destacadas em vermelho).
        </div>
      </div>
    </div>

    <div class="help-section">
      <h3>ðŸ”„ Rotacionar PDF</h3>
      <p>Permite rotacionar pÃ¡ginas de PDFs com preview em tempo real.</p>
      <ul>
        <li><strong>Entrada:</strong> MÃºltiplos arquivos PDF</li>
        <li><strong>Ã‚ngulos:</strong> 90Â°, 180Â°, 270Â°</li>
        <li><strong>AplicaÃ§Ã£o:</strong> RotaÃ§Ã£o em todas as pÃ¡ginas do PDF</li>
        <li><strong>SaÃ­da:</strong> PDFs rotacionados individualmente ou em ZIP</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸ”— Mesclar PDF</h3>
      <p>Combina mÃºltiplos PDFs em um Ãºnico arquivo.</p>
      <ul>
        <li><strong>Entrada:</strong> 2 ou mais arquivos PDF</li>
        <li><strong>Recursos:</strong> SeleÃ§Ã£o de pÃ¡ginas especÃ­ficas, ordem customizada</li>
        <li><strong>SaÃ­da:</strong> Um Ãºnico PDF mesclado</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸ—œï¸ Comprimir PDF</h3>
      <p>Reduz o tamanho de arquivos PDF.</p>
      <ul>
        <li><strong>NÃ­veis:</strong> Baixo, MÃ©dio, Alto</li>
        <li><strong>OpÃ§Ãµes:</strong> RemoÃ§Ã£o de imagens (opcional)</li>
        <li><strong>SaÃ­da:</strong> PDFs comprimidos com estatÃ­sticas de economia</li>
      </ul>
    </div>

    <h2>ðŸ¦ ExtraÃ§Ã£o BancÃ¡ria</h2>

    <div class="help-section">
      <h3>ðŸŸ¦ BTG Pactual</h3>
      <p>Extrai transaÃ§Ãµes de extratos do BTG Pactual.</p>
      <ul>
        <li><strong>Formato:</strong> Extrato bancÃ¡rio padrÃ£o BTG</li>
        <li><strong>Colunas:</strong> Data, HistÃ³rico, Documento, Valor, Saldo</li>
        <li><strong>MÃºltiplas contas:</strong> Detecta e separa automaticamente</li>
        <li><strong>SaÃ­da:</strong> Excel com uma aba por conta</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸŸ§ ItaÃº - Cash Transactions</h3>
      <p>Extrai transaÃ§Ãµes de cash do ItaÃº em mÃºltiplas moedas.</p>
      <ul>
        <li><strong>SeÃ§Ã£o detectada:</strong> "Cash Transactions"</li>
        <li><strong>Moedas suportadas:</strong> USD, EUR, BRL, etc.</li>
        <li><strong>MÃºltiplas contas:</strong> Detecta automaticamente</li>
        <li><strong>MÃºltiplas pÃ¡ginas:</strong> Processa atÃ© encontrar "Closing Balance"</li>
        <li><strong>SaÃ­da:</strong> Excel com uma aba por conta</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸ’³ ItaÃº - MovimentaÃ§Ã£o BancÃ¡ria</h3>
      <p>Extrai movimentaÃ§Ã£o completa de conta corrente do ItaÃº.</p>
      <ul>
        <li><strong>SeÃ§Ã£o detectada:</strong> "Conta Corrente | MovimentaÃ§Ã£o"</li>
        <li><strong>Colunas:</strong> Data, DescriÃ§Ã£o, Entradas, SaÃ­das, Saldo</li>
        <li><strong>CorreÃ§Ã£o automÃ¡tica:</strong> Datas em branco sÃ£o preenchidas</li>
        <li><strong>MÃºltiplas contas:</strong> Separa por conta automaticamente</li>
        <li><strong>SaÃ­da:</strong> Excel com uma aba por conta</li>
      </ul>
      <div class="info-box warning">
        <div class="info-icon">âš ï¸</div>
        <div>
          <strong>ObservaÃ§Ãµes importantes:</strong>
          <ul>
            <li>Excluir linhas "Saldo Aplic Aut Mais" manualmente no Excel apÃ³s extraÃ§Ã£o</li>
            <li>Verificar linha ao lado de "P = poupanÃ§a automÃ¡tica"</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="help-section">
      <h3>ðŸŸ¥ Morgan Stanley</h3>
      <p>Extrai transaÃ§Ãµes de extratos do Morgan Stanley.</p>
      <ul>
        <li><strong>Formato:</strong> Statement padrÃ£o Morgan Stanley</li>
        <li><strong>Colunas:</strong> Data, DescriÃ§Ã£o, DÃ©bito, CrÃ©dito, Saldo</li>
        <li><strong>MÃºltiplas contas:</strong> Detecta e separa automaticamente</li>
        <li><strong>SaÃ­da:</strong> Excel com uma aba por conta</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸŸ« UBS Switzerland</h3>
      <p>Extrai transaÃ§Ãµes de extratos do UBS SuÃ­Ã§a.</p>
      <ul>
        <li><strong>Formato:</strong> Extrato bancÃ¡rio padrÃ£o UBS</li>
        <li><strong>Colunas:</strong> Data, DescriÃ§Ã£o, Valor, Saldo</li>
        <li><strong>MÃºltiplas moedas:</strong> Suporta CHF, USD, EUR</li>
        <li><strong>MÃºltiplas contas:</strong> Detecta e separa automaticamente</li>
        <li><strong>SaÃ­da:</strong> Excel com uma aba por conta</li>
      </ul>
    </div>

    <h2>ðŸ“‹ InformaÃ§Ãµes Gerais</h2>

    <div class="help-section">
      <h3>ðŸ“ Limites</h3>
      <ul>
        <li><strong>Tamanho mÃ¡ximo por arquivo:</strong> 16MB</li>
        <li><strong>Formatos suportados:</strong> PDF</li>
        <li><strong>Quantidade de arquivos:</strong> AtÃ© 20 por operaÃ§Ã£o</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸ”’ SeguranÃ§a</h3>
      <ul>
        <li>Arquivos sÃ£o processados temporariamente</li>
        <li>Dados nÃ£o sÃ£o armazenados apÃ³s o processamento</li>
        <li>ValidaÃ§Ã£o de tipos de arquivo</li>
        <li>Processamento local no servidor</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸ’¡ Dicas de Uso</h3>
      <ul>
        <li>Certifique-se de que os PDFs nÃ£o estÃ£o protegidos por senha</li>
        <li>Para melhores resultados, use PDFs com boa qualidade</li>
        <li>Em caso de erro, tente processar os arquivos individualmente</li>
        <li>Verifique sempre os resultados apÃ³s a extraÃ§Ã£o</li>
        <li>Use a ferramenta "Editar PDF" para operaÃ§Ãµes em pÃ¡ginas especÃ­ficas</li>
        <li>Use "Rotacionar PDF" quando precisa girar todas as pÃ¡ginas de mÃºltiplos arquivos</li>
      </ul>
    </div>

    <div class="help-section">
      <h3>ðŸ†˜ Suporte</h3>
      <p>Em caso de dÃºvidas ou problemas:</p>
      <ul>
        <li>Verifique se o PDF estÃ¡ no formato correto</li>
        <li>Teste com um arquivo menor primeiro</li>
        <li>Entre em contato com o suporte tÃ©cnico se o problema persistir</li>
      </ul>
    </div>
  </div>
</div>

<style>
  .help-section {
    margin: 2rem 0;
    padding: 1.5rem;
    background: #f7fafc;
    border-radius: 8px;
    border-left: 4px solid #667eea;
  }

  .help-section h3 {
    color: #2d3748;
    margin: 0 0 1rem 0;
    font-size: 1.25rem;
  }

  .help-section p {
    color: #4a5568;
    margin: 0 0 1rem 0;
    line-height: 1.6;
  }

  .help-section ul {
    margin: 0.5rem 0;
    padding-left: 1.5rem;
  }

  .help-section li {
    color: #4a5568;
    margin: 0.5rem 0;
    line-height: 1.6;
  }

  .help-section strong {
    color: #2d3748;
  }

  .content-card h2 {
    color: #2d3748;
    font-size: 1.75rem;
    margin: 2rem 0 1rem 0;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #e2e8f0;
  }

  .content-card h2:first-child {
    margin-top: 0;
  }

  .info-box {
    margin: 1rem 0;
    padding: 1rem;
    border-radius: 6px;
    display: flex;
    gap: 1rem;
    align-items: flex-start;
  }

  .info-box.info {
    background: #e6f3ff;
    border-left: 4px solid #3b82f6;
  }

  .info-box.warning {
    background: #fff3cd;
    border-left: 4px solid #f59e0b;
  }

  .info-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
  }

  .info-box ul {
    margin: 0.5rem 0 0 0;
  }

  .info-box li {
    margin: 0.25rem 0;
  }
</style>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\ItauCash.razor
----------------------------------------

@page "/itau-cash"
@page "/itau"

<PageTitle>ItaÃº - Cash Transactions - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">ðŸ¦</div>
    <div>
      <h1>ItaÃº - Cash Transactions</h1>
      <p class="subtitle">ExtraÃ§Ã£o de transaÃ§Ãµes em mÃºltiplas moedas</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">ðŸ’±</div>
      <div>
        <strong>ExtraÃ§Ã£o de Cash Transactions:</strong>
        <p style="margin: 0.5rem 0 0 0; color: #666;">
          O sistema detecta automaticamente <strong>mÃºltiplas contas no mesmo PDF</strong> (USD, EUR, BRL, etc.),
          criando uma <strong>aba separada</strong> para cada conta no arquivo Excel final.
        </p>
      </div>
    </div>

    <div class="info-box warning">
      <div class="info-icon">âš ï¸</div>
      <div>
        <strong>Melhorias Implementadas:</strong>
        <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
          <li><strong>MÃºltiplas PÃ¡ginas:</strong> Processa tabelas que continuam por vÃ¡rias pÃ¡ginas</li>
          <li><strong>MÃºltiplas Contas:</strong> Extrai todas as contas do mesmo PDF</li>
          <li><strong>ContinuaÃ§Ã£o de Tabelas:</strong> NÃ£o para atÃ© encontrar "Closing Balance"</li>
        </ul>
      </div>
    </div>

    <div class="info-box info">
      <div class="info-icon">âš ï¸</div>
      <div>
        <strong>Pontos importantes para ajustar no XLSX:</strong>
        <p style="margin: 0.5rem 0 0 0; color: #666;">
          Quando a tabela passa de uma pÃ¡gina, a Ãºltima linha de cada pÃ¡gina deve ser <strong>AJUSTADA</strong> no XLSX,
          Pois, apÃ³s a descriÃ§Ã£o correta, uma <strong>frase lixo</strong> acaba sendo inserida.
          ApÃ³s a descriÃ§Ã£o correta, Ã© acrescentado algo como <strong>"=== PÃGINA 9 === Transactions Operation Date Value
            Date Description Value Account Balance"</strong>, e isso deve ser removido.
        </p>
      </div>
    </div>

    <div class="features-list">
      <div class="feature-item">
        <span class="feature-icon">ðŸ”</span>
        <span>Identifica a seÃ§Ã£o "Cash Transactions"</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ¦</span>
        <span>Detecta "Opening Balance Account: NUMERO MOEDA"</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ’±</span>
        <span>Suporta mÃºltiplas moedas (USD, EUR, BRL, etc.)</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ“‹</span>
        <span>Extrai todas as transaÃ§Ãµes atÃ© "Closing Balance"</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ“„</span>
        <span>Processa tabelas que continuam em vÃ¡rias pÃ¡ginas</span>
      </div>
    </div>

    <div class="upload-section">
      <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">ðŸ“„</div>
        <div class="upload-text">Clique aqui ou arraste os PDFs</div>
        <div class="upload-hint">Selecione mÃºltiplos PDFs do ItaÃº (mÃ¡x. 16MB cada)</div>
      </div>
      <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />
    </div>

    <!-- Lista de arquivos -->
    <div id="filesSelected" class="files-selected" style="display: none;">
      <div class="files-header">ðŸ“‹ Arquivos Selecionados:</div>
      <div id="filesList" class="files-list"></div>
      <div id="filesSummary" class="files-summary"></div>
    </div>

    <!-- BotÃ£o -->
    <div id="actionButtons" class="action-section" style="display: none;">
      <button class="btn btn-primary" id="processBtn" onclick="processFiles()" disabled>
        Processar PDFs e Gerar Consolidado
      </button>
    </div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Processando extratos do ItaÃº... Aguarde por favor.</p>
      <div id="progressInfo" class="progress-info"></div>
    </div>

    <!-- Status -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">ðŸ’±</div>
      <h4>MÃºltiplas Moedas</h4>
      <p>USD, EUR, BRL e outras moedas</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ“Š</div>
      <h4>MÃºltiplas Contas</h4>
      <p>Processa vÃ¡rias contas em um Ãºnico Excel</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">âš¡</div>
      <h4>Batch Processing</h4>
      <p>Processa mÃºltiplos PDFs de uma vez</p>
    </div>
  </div>

  <div class="help-section">
    <h3>ðŸ’¡ Como funciona:</h3>
    <ol>
      <li>Selecione mÃºltiplos PDFs do ItaÃº</li>
      <li>O sistema identifica automaticamente as seÃ§Ãµes "Cash Transactions"</li>
      <li>Para cada conta encontrada (ex: "6086454001 USD"), cria uma aba no Excel</li>
      <li>Se o mesmo nÃºmero de conta aparecer com moedas diferentes, cria abas separadas</li>
      <li>Exemplo de abas: "6086454001_USD", "6086454001_EUR", "1234567890_BRL"</li>
    </ol>
  </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/itau-cash.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do ItaÃº Cash -->
<script src="/js/itau-cash.js"></script>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\ItauCash2.razor
----------------------------------------

@page "/itau-cash2"
@using Microsoft.AspNetCore.Components.Forms

<PageTitle>ItaÃº Cash 2.0 - Extrator PDF</PageTitle>

<div class="itau-cash2-container">
    <div class="page-header">
        <div class="header-icon">ðŸ¦</div>
        <div>
            <h1>ItaÃº Cash 2.0</h1>
            <p class="subtitle">ExtraÃ§Ã£o com localizaÃ§Ã£o por coordenadas</p>
        </div>
    </div>

    <div class="info-box">
        <h3>â„¹ï¸ InformaÃ§Ãµes</h3>
        <ul>
            <li><strong>Formato:</strong> ItaÃº Cash Transactions Statement PDF</li>
            <li><strong>Modo DEBUG:</strong> Ative para identificar coordenadas X,Y</li>
            <li><strong>MÃºltiplas contas:</strong> Processa todas as contas do PDF</li>
            <li><strong>Colunas extraÃ­das:</strong> Operation Date, Value Date, Description, Value, Account Balance</li>
            <li><strong>SaÃ­da:</strong> Arquivo Excel (.xlsx) consolidado</li>
        </ul>
    </div>

    <!-- DEBUG MODE TOGGLE -->
    <div class="debug-toggle-container">
        <label class="debug-toggle">
            <input type="checkbox" id="debugModeCheckbox" />
            <span class="debug-toggle-label">
                <span class="debug-icon">ðŸ”</span>
                Modo DEBUG (identificar coordenadas)
            </span>
        </label>
        <p class="debug-help-text">
            Ative o modo DEBUG para gerar um relatÃ³rio Excel com as coordenadas X,Y de cada elemento.
            Use este relatÃ³rio para ajustar as constantes no parser.
        </p>
    </div>

    <div class="upload-section">
        <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
        <div id="uploadArea" class="upload-area">
            <div class="upload-icon">ðŸ“„</div>
            <h3>Arraste os PDFs aqui</h3>
            <p>ou clique para selecionar</p>
        </div>
        <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />

        <div id="fileList" class="file-list" style="display: none;">
            <h3>Arquivos Selecionados:</h3>
            <div id="fileListContent"></div>
            <button id="processBtn" class="process-btn">
                ðŸš€ Processar PDFs
            </button>
        </div>
    </div>

    <div id="resultSection" class="result-section" style="display: none;">
        <div class="result-success">
            <h3>âœ… Processamento ConcluÃ­do!</h3>
            <p id="resultMessage"></p>
            <a id="downloadLink" class="download-btn" download>
                ðŸ“¥ Download Excel
            </a>
        </div>
    </div>

    <div id="errorSection" class="error-section" style="display: none;">
        <div class="error-message">
            <h3>âŒ Erro no Processamento</h3>
            <p id="errorMessage"></p>
        </div>
    </div>

    <div id="loadingSection" class="loading-section" style="display: none;">
        <div class="spinner"></div>
        <p id="loadingMessage">Processando PDFs do ItaÃº Cash 2.0...</p>
    </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/itau-cash2.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do ItaÃº Cash 2 -->
<script src="/js/itau-cash2.js"></script>



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\ItauMovimentacao.razor
----------------------------------------

@page "/itau-movimentacao"
@page "/itau-mov"

<PageTitle>ItaÃº - MovimentaÃ§Ã£o BancÃ¡ria - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">ðŸ’³</div>
    <div>
      <h1>ItaÃº - MovimentaÃ§Ã£o BancÃ¡ria</h1>
      <p class="subtitle">ExtraÃ§Ã£o completa de movimentaÃ§Ã£o bancÃ¡ria</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">ðŸ“Š</div>
      <div>
        <strong>ExtraÃ§Ã£o de MovimentaÃ§Ã£o BancÃ¡ria:</strong>
        <p style="margin: 0.5rem 0 0 0; color: #666;">
          O sistema identifica automaticamente <strong>mÃºltiplas contas</strong> pelos cÃ³digos de agÃªncia e conta
          corrente,
          criando uma <strong>aba separada</strong> para cada conta no arquivo Excel final.
        </p>
      </div>
    </div>

    <div class="features-list">
      <div class="feature-item">
        <span class="feature-icon">ðŸ”</span>
        <span>Identifica a seÃ§Ã£o "Conta Corrente | MovimentaÃ§Ã£o"</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ¦</span>
        <span>Detecta agÃªncia e conta automaticamente</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ“‹</span>
        <span>Extrai todas as movimentaÃ§Ãµes da tabela</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ“…</span>
        <span>Corrige datas em branco automaticamente</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ðŸ’°</span>
        <span>Classifica valores em entrada, saÃ­da e saldo</span>
      </div>
    </div>

    <div class="info-box info">
      <div class="info-icon">âš ï¸</div>
      <div>
        <strong>Pontos importantes para ajustar no XLSX:</strong>
        <p style="margin: 0.5rem 0 0 0; color: #666;">
          A Primeira e Ãºltima linha de cada mÃªs deve ser <strong>EXCLUÃDA</strong> Pois estas linhas nÃ£o fazem parte da
          movimentaÃ§Ã£o.
          A primeira linha tem na descriÃ§Ã£o algo como <strong>"pela Bolsa de Valores"</strong>, e a Ãºltima tem a
          descriÃ§Ã£o, algo como <strong>"Saldo em C/C"</strong>.
        </p>
      </div>
    </div>

    <div class="upload-section">
      <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">ðŸ“„</div>
        <div class="upload-text">Clique aqui ou arraste os PDFs</div>
        <div class="upload-hint">Selecione mÃºltiplos PDFs de extrato ItaÃº (mÃ¡x. 16MB cada)</div>
      </div>
      <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />
    </div>

    <!-- Lista de arquivos selecionados -->
    <div id="filesSelected" class="files-selected" style="display: none;">
      <div class="files-header">ðŸ“‹ Arquivos Selecionados:</div>
      <div id="filesList" class="files-list"></div>
      <div id="filesSummary" class="files-summary"></div>
    </div>

    <!-- BotÃ£o de processamento -->
    <div id="actionButtons" class="action-section" style="display: none;">
      <button class="btn btn-primary" id="processBtn" onclick="processFiles()" disabled>
        Processar PDFs e Gerar Consolidado
      </button>
    </div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Processando extratos do ItaÃº... Aguarde por favor.</p>
      <div id="progressInfo" class="progress-info"></div>
    </div>

    <!-- Mensagem de status -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">ðŸ“Š</div>
      <h4>MÃºltiplas Contas</h4>
      <p>Processa vÃ¡rias contas em um Ãºnico Excel</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ”„</div>
      <h4>CorreÃ§Ã£o AutomÃ¡tica</h4>
      <p>Corrige datas e valores automaticamente</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">âš¡</div>
      <h4>Batch Processing</h4>
      <p>Processa mÃºltiplos PDFs de uma vez</p>
    </div>
  </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/itau-movimentacao.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do ItaÃº MovimentaÃ§Ã£o -->
<script src="/js/itau-movimentacao.js"></script>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\MergePdf.razor
----------------------------------------

@page "/merge-pdf"
@page "/mesclar"

<PageTitle>Mesclar PDF - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">ðŸ”—</div>
    <div>
      <h1>Mesclar PDF</h1>
      <p class="subtitle">Combine mÃºltiplos PDFs em um Ãºnico arquivo</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">â„¹ï¸</div>
      <div>
        <strong>Como funciona:</strong>
        <ul>
          <li>Selecione 2 ou mais arquivos PDF</li>
          <li>Configure o intervalo de pÃ¡ginas de cada PDF (ex: "1-3", "1,3,5", "1-5,9")</li>
          <li>Reorganize a ordem dos arquivos usando os botÃµes â†‘ â†“</li>
          <li>Clique em "Mesclar PDFs" para combinar tudo em um Ãºnico arquivo</li>
        </ul>
      </div>
    </div>

    <div class="upload-section">
      <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
      <label for="fileInput" class="upload-area" id="uploadArea">
        <div class="upload-icon">ðŸ“</div>
        <div class="upload-text">Clique aqui ou arraste os PDFs</div>
        <div class="upload-hint">Selecione mÃºltiplos PDFs para mesclar (mÃ¡x. 16MB cada)</div>
      </label>
      <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />
    </div>

    <!-- Contador de arquivos -->
    <div id="fileCounter" class="file-counter" style="display: none;">
      <span class="counter-icon">ðŸ“‹</span>
      <span id="counterText">Arquivos selecionados: 0</span>
    </div>

    <!-- Lista de arquivos -->
    <div id="filesArea" class="files-area"></div>

    <!-- BotÃ£o de mesclagem -->
    <div id="actionButtons" class="action-section" style="display: none;">
      <button class="btn btn-primary" id="mergeBtn" onclick="mergePdfs()" disabled>
        ðŸ”— Selecione pelo menos 2 PDFs
      </button>
      <button class="btn btn-secondary" onclick="clearAllFiles()">
        ðŸ—‘ï¸ Limpar
      </button>
    </div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Mesclando PDFs...</p>
    </div>

    <!-- Mensagem de status -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">ðŸ“„</div>
      <h4>SeleÃ§Ã£o de PÃ¡ginas</h4>
      <p>Escolha quais pÃ¡ginas incluir de cada PDF</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">â†•ï¸</div>
      <h4>ReordenaÃ§Ã£o</h4>
      <p>Organize os arquivos na ordem desejada</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">âš¡</div>
      <h4>RÃ¡pido e FÃ¡cil</h4>
      <p>Interface intuitiva e processamento veloz</p>
    </div>
  </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/merge-pdf.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do Merge PDF -->
<script src="/js/merge-pdf.js"></script>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\MorganStanley.razor
----------------------------------------

@page "/morgan-stanley"
@using Microsoft.AspNetCore.Components.Forms

<PageTitle>Morgan Stanley - Extrator PDF</PageTitle>

<div class="morgan-container">
    <div class="page-header">
        <div class="header-icon">ðŸ¦</div>
        <div>
            <h1>Morgan Stanley</h1>
            <p class="subtitle">ExtraÃ§Ã£o de Cash Flow Activity</p>
        </div>
    </div>

    <div class="info-box">
        <h3>â„¹ï¸ InformaÃ§Ãµes</h3>
        <ul>
            <li><strong>Formato:</strong> Morgan Stanley Client Statement PDF</li>
            <li><strong>MÃºltiplas contas:</strong> Processa todas as contas do PDF</li>
            <li><strong>Colunas extraÃ­das:</strong> Activity Date, Settlement Date, Activity Type, Description,
                Comments, Quantity, Price, Credits/(Debits)</li>
            <li><strong>SaÃ­da:</strong> Arquivo Excel (.xlsx) consolidado</li>
        </ul>
    </div>

    <div class="upload-section">
        <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
        <div id="uploadArea" class="upload-area">
            <div class="upload-icon">ðŸ“„</div>
            <h3>Arraste os PDFs aqui</h3>
            <p>ou clique para selecionar</p>
        </div>
        <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />

        <div id="fileList" class="file-list" style="display: none;">
            <h3>Arquivos Selecionados:</h3>
            <div id="fileListContent"></div>
            <button id="processBtn" class="process-btn">
                ðŸš€ Processar PDFs
            </button>
        </div>
    </div>

    <div id="resultSection" class="result-section" style="display: none;">
        <div class="result-success">
            <h3>âœ… Processamento ConcluÃ­do!</h3>
            <p id="resultMessage"></p>
            <a id="downloadLink" class="download-btn" download>
                ðŸ“¥ Download Excel
            </a>
        </div>
    </div>

    <div id="errorSection" class="error-section" style="display: none;">
        <div class="error-message">
            <h3>âŒ Erro no Processamento</h3>
            <p id="errorMessage"></p>
        </div>
    </div>

    <div id="loadingSection" class="loading-section" style="display: none;">
        <div class="spinner"></div>
        <p>Processando PDFs do Morgan Stanley...</p>
    </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/morgan-stanley.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do Morgan Stanley -->
<script src="/js/morgan-stanley.js"></script>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\RotatePdf.razor
----------------------------------------

@page "/rotate-pdf"
@page "/rotacionar"

<PageTitle>Rotacionar PDF - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">ðŸ”„</div>
    <div>
      <h1>Rotacionar PDF</h1>
      <p class="subtitle">Rotacione pÃ¡ginas de PDFs com preview em tempo real</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">â„¹ï¸</div>
      <div>
        <strong>Como funciona:</strong>
        <ul>
          <li>Selecione mÃºltiplos arquivos PDF</li>
          <li>Visualize miniaturas da primeira pÃ¡gina de cada PDF</li>
          <li>Selecione os PDFs que deseja rotacionar</li>
          <li>Clique nos botÃµes de rotaÃ§Ã£o (90Â° esquerda/direita)</li>
          <li>Baixe todos os PDFs rotacionados em um arquivo ZIP</li>
        </ul>
      </div>
    </div>

    <div class="upload-section">
      <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">ðŸ“</div>
        <div class="upload-text">Clique aqui ou arraste os PDFs</div>
        <div class="upload-hint">Selecione mÃºltiplos PDFs para rotacionar (mÃ¡x. 16MB cada)</div>
      </div>
      <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />
    </div>

    <!-- Contador de arquivos -->
    <div id="fileCounter" class="file-counter" style="display: none;">
      <span class="counter-icon">ðŸ“‹</span>
      <span id="counterText">Arquivos carregados: 0</span>
    </div>

    <!-- Preview Section -->
    <div id="previewSection" class="preview-section" style="display: none;">
      <!-- Action Buttons -->
      <div class="action-buttons-container">
        <button id="selectAllBtn" onclick="toggleSelectAll()" class="btn btn-primary">
          <span id="selectAllText">âœ“ Selecionar Todos</span>
        </button>
        <button onclick="rotateSelected(-90)" class="btn btn-secondary">
          â†¶ Esquerda (90Â°)
        </button>
        <button onclick="rotateSelected(90)" class="btn btn-secondary">
          â†· Direita (90Â°)
        </button>
        <button onclick="rotateSelected(180)" class="btn btn-secondary">
          âŸ³ 180Â°
        </button>
        <button onclick="processDownload()" class="btn btn-success">
          â¬‡ Download ZIP
        </button>
        <button onclick="clearAll()" class="btn btn-danger">
          ðŸ—‘ï¸ Limpar
        </button>
      </div>

      <!-- PDF Grid -->
      <div id="pdfGrid" class="pdf-grid"></div>
    </div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Processando PDFs...</p>
    </div>

    <!-- Message Area -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">ðŸ‘ï¸</div>
      <h4>Preview Visual</h4>
      <p>Veja miniaturas antes de rotacionar</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ”„</div>
      <h4>RotaÃ§Ã£o FlexÃ­vel</h4>
      <p>90Â° esquerda, direita ou 180Â°</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ðŸ“¦</div>
      <h4>Download em ZIP</h4>
      <p>Todos os PDFs em um Ãºnico arquivo</p>
    </div>
  </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/rotate-pdf.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do Rotate PDF -->
<script src="/js/rotate-pdf.js"></script>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\Ubs.razor
----------------------------------------

@page "/ubs"
@using Microsoft.AspNetCore.Components.Forms

<PageTitle>UBS Switzerland - Extrator PDF</PageTitle>

<div class="ubs-container">
    <div class="page-header">
        <div class="header-icon">ðŸ¦</div>
        <div>
            <h1>UBS Switzerland</h1>
            <p class="subtitle">ExtraÃ§Ã£o de Account Statements (USD/CHF)</p>
        </div>
    </div>

    <div class="info-box">
        <h3>â„¹ï¸ InformaÃ§Ãµes</h3>
        <ul>
            <li><strong>Formato:</strong> UBS Current Account Statement PDF</li>
            <li><strong>MÃºltiplas contas:</strong> Processa todas as contas do PDF</li>
            <li><strong>Colunas extraÃ­das:</strong> Date, Information, Debits, Credits, Value Date, Balance</li>
            <li><strong>SaÃ­da:</strong> Arquivo Excel (.xlsx) consolidado</li>
        </ul>
    </div>

    <div class="upload-section">
        <!-- âœ… CORRETO: Sem onclick inline - gerenciado pelo pdf-upload-handler.js -->
        <div id="uploadArea" class="upload-area">
            <div class="upload-icon">ðŸ“„</div>
            <h3>Arraste os PDFs aqui</h3>
            <p>ou clique para selecionar</p>
        </div>
        <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />

        <div id="fileList" class="file-list" style="display: none;">
            <h3>Arquivos Selecionados:</h3>
            <div id="fileListContent"></div>
            <button id="processBtn" class="process-btn">
                ðŸš€ Processar PDFs
            </button>
        </div>
    </div>

    <div id="resultSection" class="result-section" style="display: none;">
        <div class="result-success">
            <h3>âœ… Processamento ConcluÃ­do!</h3>
            <p id="resultMessage"></p>
            <a id="downloadLink" class="download-btn" download>
                ðŸ“¥ Download Excel
            </a>
        </div>
    </div>

    <div id="errorSection" class="error-section" style="display: none;">
        <div class="error-message">
            <h3>âŒ Erro no Processamento</h3>
            <p id="errorMessage"></p>
        </div>
    </div>

    <div id="loadingSection" class="loading-section" style="display: none;">
        <div class="spinner"></div>
        <p>Processando PDFs do UBS Switzerland...</p>
    </div>
</div>

<!-- ========================================
     CSS - Ordem crÃ­tica: Shared primeiro
     ======================================== -->
<link rel="stylesheet" href="/css/pdf-upload-shared.css" />
<link rel="stylesheet" href="/css/ubs.css" />

<!-- ========================================
     JavaScript - Ordem crÃ­tica
     ======================================== -->
<!-- 1. ConfiguraÃ§Ã£o da API -->
<script src="/js/api-config.js"></script>

<!-- 2. Sistema de upload compartilhado -->
<script src="/js/pdf-upload-handler.js"></script>

<!-- 3. LÃ³gica especÃ­fica do UBS -->
<script src="/js/ubs.js"></script>


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Components\Pages\Weather.razor
----------------------------------------

@page "/weather"
@attribute [StreamRendering]

<PageTitle>Weather</PageTitle>

<h1>Weather</h1>

<p>This component demonstrates showing data.</p>

@if (forecasts == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Temp. (C)</th>
                <th>Temp. (F)</th>
                <th>Summary</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var forecast in forecasts)
            {
                <tr>
                    <td>@forecast.Date.ToShortDateString()</td>
                    <td>@forecast.TemperatureC</td>
                    <td>@forecast.TemperatureF</td>
                    <td>@forecast.Summary</td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    private WeatherForecast[]? forecasts;

    protected override async Task OnInitializedAsync()
    {
        // Simulate asynchronous loading to demonstrate streaming rendering
        await Task.Delay(500);

        var startDate = DateOnly.FromDateTime(DateTime.Now);
        var summaries = new[] { "Freezing", "Bracing", "Chilly", "Cool", "Mild", "Warm", "Balmy", "Hot", "Sweltering", "Scorching" };
        forecasts = Enumerable.Range(1, 5).Select(index => new WeatherForecast
        {
            Date = startDate.AddDays(index),
            TemperatureC = Random.Shared.Next(-20, 55),
            Summary = summaries[Random.Shared.Next(summaries.Length)]
        }).ToArray();
    }

    private class WeatherForecast
    {
        public DateOnly Date { get; set; }
        public int TemperatureC { get; set; }
        public string? Summary { get; set; }
        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);
    }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\Properties\launchSettings.json
----------------------------------------

{
  "$schema": "http://json.schemastore.org/launchsettings.json",
  "profiles": {
    "http": {
      "commandName": "Project",
      "dotnetRunMessages": true,
      "launchBrowser": false,
      "applicationUrl": "http://0.0.0.0:5087",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    }
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\favicon.png
----------------------------------------

‰PNG

   IHDR           szzô  CIDATx^ÅVMlLQ>^ªj…FL#AÄB£+t©	V4ETlJ-DCŒhX€±kY€@$¤A¢+¦,©HEFŠ ¢£íðœïæ~ÉÍËdÌ4ð%'y÷çÝsÎw~îâû¾üO„äa`` T'UzTâ	Ì{IYT%¦²Å™Ž«,RY®r“kÁŸV¾^'œ©•1*G0hÚó^6í.ÆgJ¥Ôû“«´PùÝD?—`PƒKÇ>Êík½ò¨} Ã°J4”Gü ’e–ZI÷þ”Ó‡?H÷ëo2¯¢P,í’ìü*— íZŸÌ*/l@)hÛb=ˆH¸¥ÞÁËî7ßeå†±Pycík!À Ïh ÄÒ¦WÉÎ/æ ~ý&\84ÝÇ5‘…K‹h=Ÿ‚Qîš1Ð"
zm³u-½~þ“´·õK>˜5w„ù·Ñ²Yä±
„$3,"[]Å#Gy™1Ìõš^
ûÎN1ç…åq*ß«ñzùä« å‹
¥rõh&ÁXzÝû,ù‚ÎxV9²»ÎU·˜(õ'Êø’¡ræÐ$ÅŒÍ%Ø‡ýƒoÅ¶Ej¼SPÎƒa¥QÔz!%AÀkÌƒ!4ìo¨êÊ9G,Ú<ë}ä½&ë´º~”ÃS£$'`­xrÈü—ÜpÞ÷lË­«½Œ×ƒ¯3¶œ34Ÿ½3"Ço”ÊÔé&Ž`ûñŸÙû°A	Ý­³R•#P¿T¾;s¸QB¹«žïRÚ©LEüÿú™€)½[ðw„^ž§©¬Ú8Vúõ»aMçx,\Rd¨g­·«8<À’›w›‚[¨qJžj]dóžôƒÞ80Ôým Lkc8Äƒä mBcŠKB07Ð×ƒuNOÑ#üG6ƒ¨ÕRE¸TyŒóžk!»ç^¨k¨sÔ<hÄaÈ„j­–^µ„½$“rRÏª#$N'TüÆÍÏý³úÕO}ŒoObl¤.Úé'Ÿ}Â¼‘î·}f½j~‡ßzñ-çü3ñWØOq×!=*e¸{\¢“¸zà.oÖØÙ4YÃ2\vTu1ÃY’`Š“è›4æ,9”»R_'-Ìv(à»¨?8	¹÷xVå4”ï?7…1z¨<Ïfã)ôt*b{E³ÁëgUº@@·<zeªÌÓ\Á‚fe1Æ¼5‚à«Ø.Â0CÁÄ¬Þf’‹‚·^ÆjàIˆ†Äÿ,V ëI¬]ì±-9e @ó1uË^’¿áVI“Ý£·!ö b œ±¯¡òL¾ˆ¢¶E†ámsì/¤œ’®rMØõ:©eìs1€F”Y#ævPÚÑþY›Ì!Ø„J5ËË+
™pÄ•¸eVò1 ø2†D$7$a8„m¬Ÿk”  '‚TçeÀÿÄ/FžÖ·øƒ„    IEND®B`‚


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\fileUploadHelper.js
----------------------------------------

// fileUploadHelper.js
window.fileUploadHelper = {
    initializeFileInput: function (dropZoneId, inputFileId) {
        const dropZone = document.getElementById(dropZoneId);
        const inputFile = document.getElementById(inputFileId);

        if (!dropZone || !inputFile) {
            console.error('Drop zone ou input file nÃ£o encontrado');
            return;
        }

        // Prevenir comportamento padrÃ£o do navegador
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // Visual feedback
        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropZone.classList.add('dragging');
        }

        function unhighlight() {
            dropZone.classList.remove('dragging');
        }

        // Handle drop
        dropZone.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;

            // Transferir arquivos para o input
            inputFile.files = files;

            // Disparar evento change manualmente
            const event = new Event('change', { bubbles: true });
            inputFile.dispatchEvent(event);
        }

        // Handle click
        dropZone.addEventListener('click', function (e) {
            // NÃ£o disparar se clicar em um card PDF
            if (!e.target.closest('.pdf-card')) {
                inputFile.click();
            }
        });
    },

    triggerFileInput: function (inputFileId) {
        const inputFile = document.getElementById(inputFileId);
        if (inputFile) {
            inputFile.click();
        }
    }
};


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\app.css
----------------------------------------

html, body {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
}

a, .btn-link {
    color: #006bb7;
}

.btn-primary {
    color: #fff;
    background-color: #1b6ec2;
    border-color: #1861ac;
}

.btn:focus, .btn:active:focus, .btn-link.nav-link:focus, .form-control:focus, .form-check-input:focus {
  box-shadow: 0 0 0 0.1rem white, 0 0 0 0.25rem #258cfb;
}

.content {
    padding-top: 1.1rem;
}

h1:focus {
    outline: none;
}

.valid.modified:not([type=checkbox]) {
    outline: 1px solid #26b050;
}

.invalid {
    outline: 1px solid #e50000;
}

.validation-message {
    color: #e50000;
}

.blazor-error-boundary {
    background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTYiIGhlaWdodD0iNDkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIG92ZXJmbG93PSJoaWRkZW4iPjxkZWZzPjxjbGlwUGF0aCBpZD0iY2xpcDAiPjxyZWN0IHg9IjIzNSIgeT0iNTEiIHdpZHRoPSI1NiIgaGVpZ2h0PSI0OSIvPjwvY2xpcFBhdGg+PC9kZWZzPjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMCkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMzUgLTUxKSI+PHBhdGggZD0iTTI2My41MDYgNTFDMjY0LjcxNyA1MSAyNjUuODEzIDUxLjQ4MzcgMjY2LjYwNiA1Mi4yNjU4TDI2Ny4wNTIgNTIuNzk4NyAyNjcuNTM5IDUzLjYyODMgMjkwLjE4NSA5Mi4xODMxIDI5MC41NDUgOTIuNzk1IDI5MC42NTYgOTIuOTk2QzI5MC44NzcgOTMuNTEzIDI5MSA5NC4wODE1IDI5MSA5NC42NzgyIDI5MSA5Ny4wNjUxIDI4OS4wMzggOTkgMjg2LjYxNyA5OUwyNDAuMzgzIDk5QzIzNy45NjMgOTkgMjM2IDk3LjA2NTEgMjM2IDk0LjY3ODIgMjM2IDk0LjM3OTkgMjM2LjAzMSA5NC4wODg2IDIzNi4wODkgOTMuODA3MkwyMzYuMzM4IDkzLjAxNjIgMjM2Ljg1OCA5Mi4xMzE0IDI1OS40NzMgNTMuNjI5NCAyNTkuOTYxIDUyLjc5ODUgMjYwLjQwNyA1Mi4yNjU4QzI2MS4yIDUxLjQ4MzcgMjYyLjI5NiA1MSAyNjMuNTA2IDUxWk0yNjMuNTg2IDY2LjAxODNDMjYwLjczNyA2Ni4wMTgzIDI1OS4zMTMgNjcuMTI0NSAyNTkuMzEzIDY5LjMzNyAyNTkuMzEzIDY5LjYxMDIgMjU5LjMzMiA2OS44NjA4IDI1OS4zNzEgNzAuMDg4N0wyNjEuNzk1IDg0LjAxNjEgMjY1LjM4IDg0LjAxNjEgMjY3LjgyMSA2OS43NDc1QzI2Ny44NiA2OS43MzA5IDI2Ny44NzkgNjkuNTg3NyAyNjcuODc5IDY5LjMxNzkgMjY3Ljg3OSA2Ny4xMTgyIDI2Ni40NDggNjYuMDE4MyAyNjMuNTg2IDY2LjAxODNaTTI2My41NzYgODYuMDU0N0MyNjEuMDQ5IDg2LjA1NDcgMjU5Ljc4NiA4Ny4zMDA1IDI1OS43ODYgODkuNzkyMSAyNTkuNzg2IDkyLjI4MzcgMjYxLjA0OSA5My41Mjk1IDI2My41NzYgOTMuNTI5NSAyNjYuMTE2IDkzLjUyOTUgMjY3LjM4NyA5Mi4yODM3IDI2Ny4zODcgODkuNzkyMSAyNjcuMzg3IDg3LjMwMDUgMjY2LjExNiA4Ni4wNTQ3IDI2My41NzYgODYuMDU0N1oiIGZpbGw9IiNGRkU1MDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvZz48L3N2Zz4=) no-repeat 1rem/1.8rem, #b32121;
    padding: 1rem 1rem 1rem 3.7rem;
    color: white;
}

    .blazor-error-boundary::after {
        content: "An error has occurred."
    }

.darker-border-checkbox.form-check-input {
    border-color: #929292;
}

/* ========================================
   ESTILOS COMPARTILHADOS PARA PÃGINAS
   Adicione este conteÃºdo ao final do seu wwwroot/app.css
   ======================================== */

.page-container {
    max-width: 1200px;
    margin: 0 auto;
}

.page-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #e2e8f0;
}

.header-icon {
    font-size: 3rem;
    line-height: 1;
}

.page-header h1 {
    font-size: 2rem;
    color: #2d3748;
    margin: 0;
    font-weight: 700;
}

.page-header .subtitle {
    color: #718096;
    margin: 0.25rem 0 0 0;
    font-size: 1rem;
}

.content-card {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

.info-box {
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 2rem;
    display: flex;
    gap: 1rem;
    border-left: 4px solid;
}

.info-box.info {
    background: #e6f7ff;
    border-color: #1890ff;
}

.info-box.success {
    background: #f6ffed;
    border-color: #52c41a;
}

.info-box.warning {
    background: #fffbe6;
    border-color: #faad14;
}

.info-box.error {
    background: #fff2f0;
    border-color: #ff4d4f;
}

.info-icon {
    font-size: 1.5rem;
    line-height: 1;
}

.info-box ul {
    margin: 0.5rem 0 0 0;
    padding-left: 1.5rem;
}

.info-box li {
    margin: 0.25rem 0;
}

.upload-section {
    margin: 2rem 0;
}

.upload-section h3 {
    color: #2d3748;
    margin-bottom: 1rem;
}

.file-input {
    display: block;
    width: 100%;
    padding: 1rem;
    border: 2px dashed #cbd5e0;
    border-radius: 8px;
    background: #f7fafc;
    cursor: pointer;
    transition: all 0.3s ease;
}

.file-input:hover {
    border-color: #667eea;
    background: #eef2ff;
}

.files-list {
    margin-top: 1.5rem;
    padding: 1rem;
    background: #f7fafc;
    border-radius: 8px;
}

.files-list h4 {
    color: #2d3748;
    margin: 0 0 1rem 0;
    font-size: 1rem;
}

.file-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: white;
    border-radius: 6px;
    margin: 0.5rem 0;
    border: 1px solid #e2e8f0;
}

.file-icon {
    font-size: 1.5rem;
}

.file-name {
    flex: 1;
    color: #2d3748;
    font-weight: 500;
}

.file-size {
    color: #718096;
    font-size: 0.875rem;
}

.action-section {
    display: flex;
    gap: 1rem;
    margin: 2rem 0;
}

.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
    background: #e2e8f0;
    color: #2d3748;
}

.btn-secondary:hover:not(:disabled) {
    background: #cbd5e0;
}

.loading {
    text-align: center;
    padding: 2rem;
}

.spinner {
    width: 40px;
    height: 40px;
    border: 4px solid #e2e8f0;
    border-top-color: #667eea;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 1rem;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loading p {
    color: #718096;
    margin: 0;
}

.alert {
    padding: 1rem;
    border-radius: 8px;
    margin: 1rem 0;
    border-left: 4px solid;
}

.alert-success {
    background: #f6ffed;
    border-color: #52c41a;
    color: #135200;
}

.alert-error {
    background: #fff2f0;
    border-color: #ff4d4f;
    color: #5c0011;
}

.alert-info {
    background: #e6f7ff;
    border-color: #1890ff;
    color: #003a8c;
}

.alert-warning {
    background: #fffbe6;
    border-color: #faad14;
    color: #613400;
}

.feature-boxes {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-top: 2rem;
}

.feature-box {
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    text-align: center;
}

.feature-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.feature-box h4 {
    color: #2d3748;
    margin: 0.5rem 0;
    font-size: 1rem;
}

.feature-box p {
    color: #718096;
    margin: 0;
    font-size: 0.875rem;
}

/* Responsivo */
@media (max-width: 768px) {
    .page-header {
        flex-direction: column;
        text-align: center;
    }

    .action-section {
        flex-direction: column;
    }

    .btn {
        width: 100%;
        justify-content: center;
    }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\btg.css
----------------------------------------

/* ================================================================
   BTG PACTUAL - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da pÃ¡gina BTG
   Estilos de upload, botÃµes, loading etc estÃ£o em pdf-upload-shared.css
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.page-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

/* ============================================================
   CABEÃ‡ALHO DA PÃGINA
   ============================================================ */

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   CARD DE CONTEÃšDO
   ============================================================ */

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  margin-bottom: 2rem;
}

/* ============================================================
   CAIXAS INFORMATIVAS
   ============================================================ */

.info-box {
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
}

.info-box.info {
  background: #e6f3ff;
  border-left: 4px solid #0066cc;
}

.info-box.warning {
  background: #fff8e6;
  border-left: 4px solid #ffaa00;
}

.info-box code {
  background: rgba(0, 0, 0, 0.05);
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  font-family: "Courier New", monospace;
  font-size: 0.9rem;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

/* ============================================================
   SEÃ‡ÃƒO DE UPLOAD
   ============================================================ */

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   GRID DE FEATURES
   ============================================================ */

.feature-boxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.feature-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.feature-icon {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.feature-box h4 {
  color: #2d3748;
  margin: 0 0 0.5rem 0;
}

.feature-box p {
  color: #718096;
  margin: 0;
  font-size: 0.95rem;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .page-container {
    padding: 1rem;
  }

  .page-header {
    flex-direction: column;
    text-align: center;
  }

  .header-icon {
    font-size: 2.5rem;
  }

  .page-header h1 {
    font-size: 1.5rem;
  }

  .content-card {
    padding: 1.5rem;
  }

  .feature-boxes {
    grid-template-columns: 1fr;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\compress-pdf.css
----------------------------------------

/* ================================================================
   COMPRESS PDF - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da ferramenta Compress PDF
   Estilos de upload bÃ¡sico estÃ£o em pdf-upload-shared.css
   
   COR TEMA: Verde #38a169
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.page-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   CONTENT CARD
   ============================================================ */

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  margin-bottom: 2rem;
}

/* ============================================================
   INFO BOX
   ============================================================ */

.info-box {
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
}

.info-box.info {
  background: #ebf8ff;
  border-left: 4px solid #3182ce;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   FILE COUNTER (VERDE)
   ============================================================ */

.file-counter {
  text-align: center;
  padding: 1rem;
  background: linear-gradient(
    135deg,
    rgba(56, 161, 105, 0.1) 0%,
    rgba(72, 187, 120, 0.1) 100%
  );
  border-radius: 8px;
  margin: 2rem auto;
  max-width: 400px;
  border: 2px solid rgba(56, 161, 105, 0.2);
}

.counter-icon {
  font-size: 1.5rem;
  margin-right: 0.5rem;
}

#counterText {
  font-size: 1.1rem;
  font-weight: 600;
  color: #38a169;
}

/* ============================================================
   FILES GRID - TABELA (ESPECÃFICO DO COMPRESS)
   ============================================================ */

.files-grid {
  margin-bottom: 2rem;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.files-table {
  width: 100%;
  border-collapse: collapse;
}

.files-table thead {
  background: linear-gradient(135deg, #38a169 0%, #48bb78 100%);
  color: white;
}

.files-table th {
  padding: 1rem;
  text-align: left;
  font-weight: 600;
  font-size: 0.95rem;
}

.files-table tbody tr {
  border-bottom: 1px solid #e2e8f0;
  transition: background 0.2s ease;
}

.files-table tbody tr:hover {
  background: #f7fafc;
}

.files-table td {
  padding: 1rem;
}

.file-name-cell {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.file-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.file-name {
  font-weight: 500;
  color: #2d3748;
  word-break: break-word;
}

.file-size {
  color: #718096;
  font-size: 0.9rem;
}

/* ============================================================
   COMPRESSION SELECT (ESPECÃFICO DO COMPRESS)
   ============================================================ */

.compression-cell {
  min-width: 200px;
}

.compression-select {
  width: 100%;
  padding: 0.5rem;
  border: 2px solid #e2e8f0;
  border-radius: 6px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.compression-select:focus {
  outline: none;
  border-color: #38a169;
  box-shadow: 0 0 0 3px rgba(56, 161, 105, 0.1);
}

.compression-select:hover {
  border-color: #cbd5e0;
}

/* ============================================================
   REMOVE IMAGES CHECKBOX
   ============================================================ */

.options-cell {
  text-align: center;
}

.remove-images-checkbox {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.remove-images-checkbox input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.remove-images-checkbox label {
  cursor: pointer;
  font-size: 0.9rem;
  color: #4a5568;
}

/* ============================================================
   BATCH COMPRESSION BUTTONS (ESPECÃFICO DO COMPRESS)
   ============================================================ */

.batch-compression-buttons {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
  justify-content: center;
  flex-wrap: wrap;
}

.btn-batch {
  padding: 0.6rem 1.2rem;
  border: none;
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.9rem;
}

.btn-batch:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.btn-low {
  background: #48bb78;
  color: white;
}

.btn-low:hover {
  background: #38a169;
}

.btn-medium {
  background: #f6ad55;
  color: white;
}

.btn-medium:hover {
  background: #ed8936;
}

.btn-high {
  background: #fc8181;
  color: white;
}

.btn-high:hover {
  background: #f56565;
}

.main-action-buttons {
  display: flex;
  gap: 1rem;
  justify-content: center;
}

/* ============================================================
   FEATURE BOXES
   ============================================================ */

.feature-boxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.feature-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.feature-icon {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.feature-box h4 {
  color: #2d3748;
  margin: 0 0 0.5rem 0;
}

.feature-box p {
  color: #718096;
  margin: 0;
  font-size: 0.95rem;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .page-container {
    padding: 1rem;
  }

  .page-header {
    flex-direction: column;
    text-align: center;
  }

  .content-card {
    padding: 1.5rem;
  }

  .files-table {
    font-size: 0.85rem;
  }

  .files-table th,
  .files-table td {
    padding: 0.75rem 0.5rem;
  }

  .compression-select {
    font-size: 0.8rem;
  }

  .batch-compression-buttons {
    flex-direction: column;
  }

  .btn-batch {
    width: 100%;
  }

  .main-action-buttons {
    flex-direction: column;
  }

  .main-action-buttons .btn {
    width: 100%;
  }
}

@media (max-width: 576px) {
  /* Converter tabela para cards em mobile */
  .files-table thead {
    display: none;
  }

  .files-table,
  .files-table tbody,
  .files-table tr,
  .files-table td {
    display: block;
    width: 100%;
  }

  .files-table tr {
    margin-bottom: 1rem;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 1rem;
  }

  .files-table td {
    text-align: left;
    padding: 0.5rem 0;
    border-bottom: 1px solid #f7fafc;
  }

  .files-table td:last-child {
    border-bottom: none;
  }

  .files-table td::before {
    content: attr(data-label);
    font-weight: 600;
    display: block;
    margin-bottom: 0.25rem;
    color: #4a5568;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\dashboard.css
----------------------------------------

/* ===== DASHBOARD MODERNO ===== */

.dashboard-modern {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
    background: #f8fafc;
    min-height: 100vh;
}

/* ===== HEADER ===== */
.dashboard-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 16px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: white;
}

.header-title h1 {
    font-size: 2rem;
    font-weight: 700;
    margin: 0 0 0.5rem 0;
}

.header-title p {
    font-size: 1rem;
    opacity: 0.9;
    margin: 0;
}

.header-stats {
    display: flex;
    gap: 2rem;
}

.stat-item {
    text-align: center;
    background: rgba(255, 255, 255, 0.15);
    padding: 1rem 1.5rem;
    border-radius: 12px;
    backdrop-filter: blur(10px);
}

.stat-number {
    display: block;
    font-size: 2rem;
    font-weight: 700;
    line-height: 1;
}

.stat-label {
    display: block;
    font-size: 0.875rem;
    opacity: 0.9;
    margin-top: 0.25rem;
}

/* ===== SECTIONS ===== */
.section {
    margin-bottom: 2.5rem;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.25rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid #e2e8f0;
}

.section-header h2 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #1e293b;
    margin: 0;
}

.section-count {
    font-size: 0.875rem;
    color: #64748b;
    background: #f1f5f9;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
}

/* ===== CARDS GRID ===== */
.cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.25rem;
}

.tools-grid {
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
}

/* ===== CARD BASE ===== */
.card {
    background: white;
    border-radius: 12px;
    padding: 1.25rem;
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    transition: all 0.3s ease;
    border: 2px solid transparent;
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
}

.card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    border-color: #667eea;
}

.card:hover::before {
    transform: scaleX(1);
}

/* ===== CARD ICONS ===== */
.card-icon {
    font-size: 2rem;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    flex-shrink: 0;
}

/* Cores especÃ­ficas dos bancos */
.card-icon.itau {
    background: linear-gradient(135deg, #ff6b00 0%, #ff8c00 100%);
}

.card-icon.btg {
    background: linear-gradient(135deg, #000080 0%, #1e3a8a 100%);
}

.card-icon.ubs {
    background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
}

.card-icon.morgan {
    background: linear-gradient(135deg, #003d7a 0%, #0052a3 100%);
}

.card-icon.tool {
    background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
}

/* ===== CARD BODY ===== */
.card-body {
    flex: 1;
}

.card-body h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: #1e293b;
    margin: 0 0 0.5rem 0;
}

.card-body p {
    font-size: 0.875rem;
    color: #64748b;
    margin: 0;
    line-height: 1.4;
}

/* ===== BADGES ===== */
.card-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
}

.card-badge.active {
    background: #dcfce7;
    color: #166534;
}

.card-badge.disabled {
    background: #f1f5f9;
    color: #94a3b8;
}

/* ===== BANK CARD ===== */
.bank-card {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
}

.bank-card:hover {
    background: linear-gradient(135deg, #ffffff 0%, #eff6ff 100%);
}

/* ===== TOOL CARD ===== */
.tool-card {
    background: linear-gradient(135deg, #ffffff 0%, #faf5ff 100%);
}

.tool-card:hover {
    background: linear-gradient(135deg, #ffffff 0%, #f5f3ff 100%);
}

/* ===== FOOTER ===== */
.dashboard-footer {
    margin-top: 3rem;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.footer-info {
    display: flex;
    justify-content: space-around;
    align-items: center;
    flex-wrap: wrap;
    gap: 1.5rem;
}

.info-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.875rem;
    color: #475569;
}

.info-icon {
    font-size: 1.5rem;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 1024px) {
    .header-content {
        flex-direction: column;
        text-align: center;
        gap: 1.5rem;
    }

    .header-stats {
        width: 100%;
        justify-content: center;
    }
}

@media (max-width: 768px) {
    .dashboard-modern {
        padding: 1rem;
    }

    .dashboard-header {
        padding: 1.5rem;
    }

    .header-title h1 {
        font-size: 1.5rem;
    }

    .cards-grid {
        grid-template-columns: 1fr;
    }

    .tools-grid {
        grid-template-columns: 1fr;
    }

    .stat-item {
        padding: 0.75rem 1rem;
    }

    .footer-info {
        flex-direction: column;
        text-align: center;
    }
}

/* ===== ANIMATIONS ===== */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.card {
    animation: fadeIn 0.5s ease-out;
}

.card:nth-child(1) { animation-delay: 0.05s; }
.card:nth-child(2) { animation-delay: 0.1s; }
.card:nth-child(3) { animation-delay: 0.15s; }
.card:nth-child(4) { animation-delay: 0.2s; }
.card:nth-child(5) { animation-delay: 0.25s; }



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\edit-pdf.css
----------------------------------------

/* ================================================================
   EDIT PDF - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da ferramenta Edit PDF
   Estilos de upload bÃ¡sico estÃ£o em pdf-upload-shared.css
   
   COR TEMA: Roxo #667eea
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.page-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   CONTENT CARD
   ============================================================ */

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  margin-bottom: 2rem;
}

/* ============================================================
   INFO BOX
   ============================================================ */

.info-box {
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
}

.info-box.info {
  background: #faf5ff;
  border-left: 4px solid #667eea;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   FILE INFO (quando PDF carregado)
   ============================================================ */

.file-info-bar {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem 1.5rem;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 2rem;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

.file-info-content {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.file-info-icon {
  font-size: 2rem;
}

.file-info-details h3 {
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
}

.file-info-details p {
  margin: 0.25rem 0 0 0;
  font-size: 0.9rem;
  opacity: 0.9;
}

.file-info-actions {
  display: flex;
  gap: 0.5rem;
}

.btn-icon-white {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  border-radius: 6px;
  color: white;
  padding: 0.5rem 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
  font-weight: 600;
}

.btn-icon-white:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-1px);
}

/* ============================================================
   PAGE GRID (PRINCIPAL)
   ============================================================ */

.pages-section {
  margin-top: 2rem;
}

.pages-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

/* ============================================================
   PAGE CARD (para cada pÃ¡gina individual)
   ============================================================ */

.page-card {
  background: white;
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  padding: 1rem;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.page-card:hover {
  border-color: #667eea;
  box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);
  transform: translateY(-4px);
}

.page-card.deleted {
  opacity: 0.5;
  border-color: #fc8181;
  background: #fff5f5;
}

.page-card.deleted .page-thumbnail {
  filter: grayscale(100%);
}

/* ============================================================
   PAGE THUMBNAIL
   ============================================================ */

.page-thumbnail-container {
  position: relative;
  width: 100%;
  height: 240px;
  background: #f7fafc;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

.page-thumbnail {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  transition: transform 0.3s ease;
}

/* RotaÃ§Ã£o visual com CSS */
.page-thumbnail.rotate-90 {
  transform: rotate(90deg);
}

.page-thumbnail.rotate-180 {
  transform: rotate(180deg);
}

.page-thumbnail.rotate-270 {
  transform: rotate(270deg);
}

.page-loading {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #cbd5e0;
  font-size: 0.9rem;
}

/* ============================================================
   PAGE INFO & CONTROLS
   ============================================================ */

.page-info {
  text-align: center;
  margin-bottom: 0.75rem;
}

.page-number {
  font-weight: 600;
  font-size: 1rem;
  color: #2d3748;
  margin-bottom: 0.25rem;
}

.page-status {
  font-size: 0.85rem;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  display: inline-block;
  font-weight: 600;
}

.page-status.rotated {
  background: #bee3f8;
  color: #2c5282;
}

.page-status.deleted {
  background: #fed7d7;
  color: #742a2a;
}

/* ============================================================
   PAGE CONTROLS (botÃµes de rotaÃ§Ã£o e delete)
   ============================================================ */

.page-controls {
  display: flex;
  gap: 0.5rem;
  justify-content: center;
}

.btn-page-control {
  background: #f7fafc;
  border: 2px solid #e2e8f0;
  border-radius: 6px;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 1.2rem;
}

.btn-page-control:hover {
  background: #edf2f7;
  border-color: #cbd5e0;
  transform: translateY(-2px);
}

.btn-page-control.rotate-left:hover {
  border-color: #667eea;
  color: #667eea;
}

.btn-page-control.rotate-right:hover {
  border-color: #667eea;
  color: #667eea;
}

.btn-page-control.delete:hover {
  border-color: #fc8181;
  color: #fc8181;
  background: #fff5f5;
}

.btn-page-control.restore {
  background: #c6f6d5;
  border-color: #48bb78;
  color: #22543d;
}

.btn-page-control.restore:hover {
  background: #9ae6b4;
  border-color: #38a169;
}

/* ============================================================
   ACTION SECTION (botÃµes principais)
   ============================================================ */

.action-section {
  display: flex;
  gap: 1rem;
  justify-content: center;
  flex-wrap: wrap;
  padding: 1.5rem;
  background: #f7fafc;
  border-radius: 8px;
}

.action-stats {
  display: flex;
  gap: 2rem;
  margin-bottom: 1rem;
  justify-content: center;
  color: #4a5568;
  font-size: 0.95rem;
}

.stat-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.stat-icon {
  font-size: 1.2rem;
}

.stat-value {
  font-weight: 700;
  color: #2d3748;
}

/* ============================================================
   FEATURE BOXES
   ============================================================ */

.feature-boxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.feature-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.feature-icon {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.feature-box h4 {
  color: #2d3748;
  margin: 0 0 0.5rem 0;
}

.feature-box p {
  color: #718096;
  margin: 0;
  font-size: 0.95rem;
}

/* ============================================================
   EMPTY STATE
   ============================================================ */

.empty-state {
  text-align: center;
  padding: 3rem;
  color: #718096;
}

.empty-state-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
  opacity: 0.5;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .page-container {
    padding: 1rem;
  }

  .page-header {
    flex-direction: column;
    text-align: center;
  }

  .content-card {
    padding: 1.5rem;
  }

  .pages-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
  }

  .page-thumbnail-container {
    height: 180px;
  }

  .file-info-bar {
    flex-direction: column;
    text-align: center;
    gap: 1rem;
  }

  .action-section {
    flex-direction: column;
  }

  .action-section .btn {
    width: 100%;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\itau-cash.css
----------------------------------------

/* ================================================================
   ITAÃš CASH - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da pÃ¡gina ItaÃº Cash
   Estilos de upload, botÃµes, loading etc estÃ£o em pdf-upload-shared.css
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.page-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

/* ============================================================
   CABEÃ‡ALHO DA PÃGINA
   ============================================================ */

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   CARD DE CONTEÃšDO
   ============================================================ */

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  margin-bottom: 2rem;
}

/* ============================================================
   CAIXAS INFORMATIVAS
   ============================================================ */

.info-box {
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
}

.info-box.info {
  background: #ebf8ff;
  border-left: 4px solid #3182ce;
}

.info-box.warning {
  background: #fff8f0;
  border-left: 4px solid #ff6b35;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

/* ============================================================
   LISTA DE FEATURES (ESPECÃFICO DO ITAÃš)
   ============================================================ */

.features-list {
  background: #fffbf0;
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 2rem;
  border: 1px solid #ffeaa7;
}

.feature-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem 0;
  border-bottom: 1px solid #fff2e6;
  color: #2d3748;
}

.feature-item:last-child {
  border-bottom: none;
}

.feature-icon {
  font-size: 1.2rem;
  flex-shrink: 0;
}

/* ============================================================
   SEÃ‡ÃƒO DE UPLOAD
   ============================================================ */

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   GRID DE FEATURES
   ============================================================ */

.feature-boxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.feature-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.feature-box h4 {
  color: #2d3748;
  margin: 0 0 0.5rem 0;
  font-size: 1.1rem;
}

.feature-box p {
  color: #718096;
  margin: 0;
  font-size: 0.95rem;
}

/* ============================================================
   SEÃ‡ÃƒO DE AJUDA (ESPECÃFICO DO ITAÃš)
   ============================================================ */

.help-section {
  background: #f7fafc;
  border-radius: 12px;
  padding: 2rem;
  border-left: 4px solid #3182ce;
}

.help-section h3 {
  color: #2d3748;
  margin: 0 0 1rem 0;
  font-size: 1.25rem;
}

.help-section ol {
  margin: 0;
  padding-left: 1.5rem;
  color: #4a5568;
}

.help-section li {
  margin-bottom: 0.75rem;
  line-height: 1.6;
}

.help-section li:last-child {
  margin-bottom: 0;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .page-container {
    padding: 1rem;
  }

  .page-header {
    flex-direction: column;
    text-align: center;
  }

  .header-icon {
    font-size: 2.5rem;
  }

  .page-header h1 {
    font-size: 1.5rem;
  }

  .content-card {
    padding: 1.5rem;
  }

  .info-box {
    flex-direction: column;
  }

  .features-list {
    padding: 1rem;
  }

  .feature-item {
    padding: 0.5rem 0;
  }

  .help-section {
    padding: 1.5rem;
  }

  .help-section ol {
    padding-left: 1rem;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\itau-cash2.css
----------------------------------------

/* ================================================================
   ITAÃš CASH 2.0 - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da pÃ¡gina ItaÃº Cash 2.0
   Estilos de upload, botÃµes, loading etc estÃ£o em pdf-upload-shared.css
   
   COR TEMA: Laranja ItaÃº #FF8C00
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.itau-cash2-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

/* ============================================================
   CABEÃ‡ALHO (ESTILO PRÃ“PRIO DO ITAÃš - LARANJA)
   ============================================================ */

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   INFO BOX (LARANJA ITAÃš)
   ============================================================ */

.info-box {
  background: #fff5e6;
  border-left: 4px solid #ff8c00;
  padding: 1.5rem;
  margin-bottom: 2rem;
  border-radius: 8px;
}

.info-box h3 {
  color: #ff8c00;
  margin-top: 0;
  font-size: 1.25rem;
}

.info-box ul {
  margin: 1rem 0 0 0;
  padding-left: 1.5rem;
}

.info-box li {
  margin-bottom: 0.5rem;
  color: #475569;
  line-height: 1.6;
}

/* ============================================================
   DEBUG TOGGLE (ESPECÃFICO DO ITAÃš CASH 2)
   ============================================================ */

.debug-toggle-container {
  background: #f7fafc;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 2rem;
}

.debug-toggle {
  display: flex;
  align-items: center;
  cursor: pointer;
  user-select: none;
}

.debug-toggle input[type="checkbox"] {
  width: 20px;
  height: 20px;
  margin-right: 12px;
  cursor: pointer;
  accent-color: #ff8c00;
}

.debug-toggle-label {
  display: flex;
  align-items: center;
  font-size: 1.1rem;
  font-weight: 600;
  color: #2d3748;
}

.debug-icon {
  margin-right: 8px;
  font-size: 1.3rem;
}

.debug-help-text {
  margin: 1rem 0 0 32px;
  color: #718096;
  font-size: 0.95rem;
  line-height: 1.5;
}

/* Quando debug estÃ¡ ativo */
.upload-area.debug-mode-active {
  background: linear-gradient(135deg, #fffacd 0%, #ffeb3b 100%) !important;
  border-color: #ffd700 !important;
}

.debug-mode-badge {
  display: inline-block;
  background: #ffd700;
  color: #000;
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 0.85rem;
  font-weight: 600;
  margin-left: 12px;
}

/* ============================================================
   SEÃ‡ÃƒO DE UPLOAD
   ============================================================ */

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   FILE LIST (ESPECÃFICO DO ITAÃš CASH 2)
   ============================================================ */

.file-list {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 1.5rem;
  margin-top: 1.5rem;
}

.file-list h3 {
  color: #ff8c00;
  margin-top: 0;
  font-size: 1.125rem;
}

#fileListContent ul {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
}

#fileListContent li {
  padding: 0.75rem;
  background: #fff5e6;
  margin-bottom: 0.5rem;
  border-radius: 6px;
  border-left: 3px solid #ff8c00;
  color: #334155;
}

/* ============================================================
   PROCESS BUTTON (ESPECÃFICO DO ITAÃš - LARANJA)
   ============================================================ */

.process-btn {
  background: #ff8c00;
  color: white;
  border: none;
  padding: 1rem 2rem;
  font-size: 1.1rem;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
  margin-top: 1rem;
  font-weight: 600;
}

.process-btn:hover {
  background: #ff6b00;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(255, 140, 0, 0.3);
}

.process-btn:active {
  transform: translateY(0);
}

/* ============================================================
   RESULT E ERROR SECTIONS
   ============================================================ */

.result-section {
  background: #f0fdf4;
  border: 2px solid #86efac;
  border-radius: 8px;
  padding: 2rem;
  text-align: center;
  margin-top: 2rem;
}

.result-success h3 {
  color: #16a34a;
  margin-top: 0;
  font-size: 1.5rem;
}

.result-success p {
  color: #15803d;
  margin: 1rem 0;
}

.download-btn {
  display: inline-block;
  background: #16a34a;
  color: white;
  padding: 1rem 2rem;
  text-decoration: none;
  border-radius: 8px;
  margin-top: 1rem;
  transition: all 0.3s ease;
  font-weight: 600;
}

.download-btn:hover {
  background: #15803d;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(22, 163, 74, 0.3);
}

.error-section {
  background: #fef2f2;
  border: 2px solid #fca5a5;
  border-radius: 8px;
  padding: 2rem;
  margin-top: 2rem;
}

.error-message h3 {
  color: #dc2626;
  margin-top: 0;
  font-size: 1.5rem;
}

.error-message p {
  color: #991b1b;
  margin: 1rem 0 0 0;
}

/* ============================================================
   LOADING SECTION
   ============================================================ */

.loading-section {
  text-align: center;
  padding: 3rem;
}

.loading-section p {
  color: #475569;
  font-size: 1.1rem;
  margin-top: 1rem;
}

/* Customizar spinner para laranja ItaÃº */
.loading-section .spinner {
  border-top-color: #ff8c00;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .itau-cash2-container {
    padding: 1rem;
  }

  .header {
    padding: 1.5rem;
  }

  .header h1 {
    font-size: 1.75rem;
  }

  .subtitle {
    font-size: 1rem;
  }

  .info-box {
    padding: 1rem;
  }

  .debug-toggle-container {
    padding: 1rem;
  }

  .file-list {
    padding: 1rem;
  }

  .result-section,
  .error-section {
    padding: 1.5rem;
  }

  .process-btn {
    font-size: 1rem;
  }
}


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\itau-movimentacao.css
----------------------------------------

/* ================================================================
   ITAÃš MOVIMENTAÃ‡ÃƒO - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da pÃ¡gina ItaÃº MovimentaÃ§Ã£o
   Estilos de upload, botÃµes, loading etc estÃ£o em pdf-upload-shared.css
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.page-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

/* ============================================================
   CABEÃ‡ALHO DA PÃGINA
   ============================================================ */

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   CARD DE CONTEÃšDO
   ============================================================ */

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  margin-bottom: 2rem;
}

/* ============================================================
   CAIXAS INFORMATIVAS (LARANJA - ESPECÃFICO MOVIMENTAÃ‡ÃƒO)
   ============================================================ */

.info-box {
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
}

.info-box.info {
  background: #fff8f0;
  border-left: 4px solid #ff6900;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

/* ============================================================
   LISTA DE FEATURES (ESPECÃFICO DO ITAÃš)
   ============================================================ */

.features-list {
  background: #fffbf0;
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 2rem;
  border: 1px solid #ffeaa7;
}

.feature-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem 0;
  border-bottom: 1px solid #fff2e6;
  color: #2d3748;
}

.feature-item:last-child {
  border-bottom: none;
}

.feature-icon {
  font-size: 1.2rem;
  flex-shrink: 0;
}

/* ============================================================
   SEÃ‡ÃƒO DE UPLOAD
   ============================================================ */

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   GRID DE FEATURES
   ============================================================ */

.feature-boxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.feature-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.feature-box h4 {
  color: #2d3748;
  margin: 0 0 0.5rem 0;
  font-size: 1.1rem;
}

.feature-box p {
  color: #718096;
  margin: 0;
  font-size: 0.95rem;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .page-container {
    padding: 1rem;
  }

  .page-header {
    flex-direction: column;
    text-align: center;
  }

  .header-icon {
    font-size: 2.5rem;
  }

  .page-header h1 {
    font-size: 1.5rem;
  }

  .content-card {
    padding: 1.5rem;
  }

  .info-box {
    flex-direction: column;
  }

  .features-list {
    padding: 1rem;
  }

  .feature-item {
    padding: 0.5rem 0;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\merge-pdf.css
----------------------------------------

/* ================================================================
   MERGE PDF - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da ferramenta Merge PDF
   Estilos de upload bÃ¡sico estÃ£o em pdf-upload-shared.css
   
   COR TEMA: Laranja #ff6b35
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.page-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   CONTENT CARD
   ============================================================ */

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  margin-bottom: 2rem;
}

/* ============================================================
   INFO BOX
   ============================================================ */

.info-box {
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
}

.info-box.info {
  background: #ebf8ff;
  border-left: 4px solid #3182ce;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   FILE COUNTER (LARANJA)
   ============================================================ */

.file-counter {
  text-align: center;
  padding: 1rem;
  background: linear-gradient(
    135deg,
    rgba(255, 107, 53, 0.1) 0%,
    rgba(247, 147, 30, 0.1) 100%
  );
  border-radius: 8px;
  margin: 2rem auto;
  max-width: 400px;
  border: 2px solid rgba(255, 107, 53, 0.2);
}

.counter-icon {
  font-size: 1.5rem;
  margin-right: 0.5rem;
}

#counterText {
  font-size: 1.1rem;
  font-weight: 600;
  color: #ff6b35;
}

/* ============================================================
   FILES AREA (ESPECÃFICO DO MERGE)
   ============================================================ */

.files-area {
  margin-top: 2rem;
}

.file-item {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border: 2px solid #e2e8f0;
  margin-bottom: 1rem;
  transition: all 0.3s ease;
}

.file-item:hover {
  border-color: #ff6b35;
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.file-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 1rem;
}

.file-info {
  display: flex;
  align-items: center;
  gap: 1rem;
  flex: 1;
}

.file-number {
  background: #ff6b35;
  color: white;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 1.1rem;
  flex-shrink: 0;
}

.file-details {
  flex: 1;
  min-width: 0; /* Para text-overflow funcionar */
}

.file-name {
  font-weight: 600;
  color: #2d3748;
  font-size: 1rem;
  word-break: break-word;
  margin-bottom: 0.25rem;
}

.file-meta {
  display: flex;
  gap: 1rem;
  font-size: 0.85rem;
  color: #718096;
}

.file-actions {
  display: flex;
  gap: 0.5rem;
}

.btn-icon {
  background: #e2e8f0;
  border: none;
  border-radius: 6px;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 1.2rem;
}

.btn-icon:hover:not(:disabled) {
  background: #cbd5e0;
  transform: translateY(-1px);
}

.btn-icon:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.btn-delete {
  background: #fed7d7;
  color: #c53030;
}

.btn-delete:hover:not(:disabled) {
  background: #fc8181;
  color: white;
}

/* ============================================================
   PAGE RANGE SECTION (ESPECÃFICO DO MERGE)
   ============================================================ */

.page-range-section {
  background: #f7fafc;
  border-radius: 8px;
  padding: 1rem;
}

.page-range-label {
  font-size: 0.85rem;
  font-weight: 600;
  color: #4a5568;
  margin-bottom: 0.5rem;
  display: block;
}

.page-range-input {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid #e2e8f0;
  border-radius: 6px;
  font-size: 0.95rem;
  transition: all 0.2s ease;
}

.page-range-input:focus {
  outline: none;
  border-color: #ff6b35;
  box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
}

.page-range-input.error {
  border-color: #fc8181;
  background: #fff5f5;
}

.page-range-hint {
  font-size: 0.75rem;
  color: #718096;
  margin-top: 0.5rem;
}

.range-error {
  color: #c53030;
  font-size: 0.8rem;
  margin-top: 0.5rem;
  display: none;
  font-weight: 600;
}

/* ============================================================
   FEATURE BOXES
   ============================================================ */

.feature-boxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.feature-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.feature-icon {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.feature-box h4 {
  color: #2d3748;
  margin: 0 0 0.5rem 0;
}

.feature-box p {
  color: #718096;
  margin: 0;
  font-size: 0.95rem;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .page-container {
    padding: 1rem;
  }

  .page-header {
    flex-direction: column;
    text-align: center;
  }

  .content-card {
    padding: 1.5rem;
  }

  .file-item {
    padding: 1rem;
  }

  .file-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
  }

  .file-actions {
    width: 100%;
    justify-content: flex-end;
  }

  .file-meta {
    flex-direction: column;
    gap: 0.25rem;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\morgan-stanley.css
----------------------------------------

/* ================================================================
   MORGAN STANLEY - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da pÃ¡gina Morgan Stanley
   Estilos de upload, botÃµes, loading etc estÃ£o em pdf-upload-shared.css
   
   COR TEMA: Azul escuro #1e3a8a (Morgan Stanley blue)
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.morgan-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

/* ============================================================
   CABEÃ‡ALHO (ESTILO PRÃ“PRIO DO MORGAN - GRADIENTE)
   ============================================================ */

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   INFO BOX (AZUL MORGAN STANLEY)
   ============================================================ */

.info-box {
  background: #f1f5f9;
  border-left: 4px solid #1e3a8a;
  padding: 1.5rem;
  margin-bottom: 2rem;
  border-radius: 8px;
}

.info-box h3 {
  color: #1e3a8a;
  margin-top: 0;
  font-size: 1.25rem;
}

.info-box ul {
  margin: 1rem 0 0 0;
  padding-left: 1.5rem;
}

.info-box li {
  margin-bottom: 0.5rem;
  color: #475569;
  line-height: 1.6;
}

/* ============================================================
   SEÃ‡ÃƒO DE UPLOAD
   ============================================================ */

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   FILE LIST (ESPECÃFICO DO MORGAN)
   ============================================================ */

.file-list {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 1.5rem;
  margin-top: 1.5rem;
}

.file-list h3 {
  color: #1e3a8a;
  margin-top: 0;
  font-size: 1.125rem;
}

#fileListContent ul {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
}

#fileListContent li {
  padding: 0.75rem;
  background: #f8fafc;
  margin-bottom: 0.5rem;
  border-radius: 6px;
  border-left: 3px solid #1e3a8a;
  color: #334155;
}

/* ============================================================
   PROCESS BUTTON (ESPECÃFICO DO MORGAN)
   ============================================================ */

.process-btn {
  background: #1e3a8a;
  color: white;
  border: none;
  padding: 1rem 2rem;
  font-size: 1.1rem;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
  margin-top: 1rem;
  font-weight: 600;
}

.process-btn:hover {
  background: #1e40af;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
}

.process-btn:active {
  transform: translateY(0);
}

/* ============================================================
   RESULT E ERROR SECTIONS (ESPECÃFICO DO MORGAN)
   ============================================================ */

.result-section {
  background: #f0fdf4;
  border: 2px solid #86efac;
  border-radius: 8px;
  padding: 2rem;
  text-align: center;
  margin-top: 2rem;
}

.result-success h3 {
  color: #16a34a;
  margin-top: 0;
  font-size: 1.5rem;
}

.result-success p {
  color: #15803d;
  margin: 1rem 0;
}

.download-btn {
  display: inline-block;
  background: #16a34a;
  color: white;
  padding: 1rem 2rem;
  text-decoration: none;
  border-radius: 8px;
  margin-top: 1rem;
  transition: all 0.3s ease;
  font-weight: 600;
}

.download-btn:hover {
  background: #15803d;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(22, 163, 74, 0.3);
}

.error-section {
  background: #fef2f2;
  border: 2px solid #fca5a5;
  border-radius: 8px;
  padding: 2rem;
  margin-top: 2rem;
}

.error-message h3 {
  color: #dc2626;
  margin-top: 0;
  font-size: 1.5rem;
}

.error-message p {
  color: #991b1b;
  margin: 1rem 0 0 0;
}

/* ============================================================
   LOADING SECTION (ESPECÃFICO DO MORGAN)
   ============================================================ */

.loading-section {
  text-align: center;
  padding: 3rem;
}

.loading-section p {
  color: #475569;
  font-size: 1.1rem;
  margin-top: 1rem;
}

/* Customizar spinner para azul Morgan Stanley */
.loading-section .spinner {
  border-top-color: #1e3a8a;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .morgan-container {
    padding: 1rem;
  }

  .header {
    padding: 1.5rem;
  }

  .header h1 {
    font-size: 1.75rem;
  }

  .subtitle {
    font-size: 1rem;
  }

  .info-box {
    padding: 1rem;
  }

  .file-list {
    padding: 1rem;
  }

  .result-section,
  .error-section {
    padding: 1.5rem;
  }

  .process-btn {
    font-size: 1rem;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\pdf-upload-shared.css
----------------------------------------

/* ================================================================
   PDF UPLOAD AREA - Estilos Compartilhados
   ================================================================
   Estilos para garantir que drag & drop funcione perfeitamente
   Aplique a classe .upload-area no container de upload
   ================================================================ */

.upload-area {
  /* Layout e aparÃªncia */
  border: 2px dashed #cbd5e0;
  border-radius: 12px;
  padding: 3rem 2rem;
  text-align: center;
  background: #f7fafc;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  min-height: 200px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
}

/* âœ… CRITICAL FIX: Desabilitar pointer events nos filhos
   Isso garante que arrastar sobre Ã­cones/textos ainda funciona */
.upload-area * {
  pointer-events: none !important;
  user-select: none;
}

/* Hover normal */
.upload-area:hover {
  border-color: #667eea;
  background: #edf2f7;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
}

/* Estado de drag over */
.upload-area.drag-over {
  border-color: #667eea;
  background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
  border-width: 3px;
  box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
}

/* Ãcone de upload */
.upload-icon {
  font-size: 4rem;
  opacity: 0.6;
  transition: all 0.3s ease;
}

.upload-area:hover .upload-icon,
.upload-area.drag-over .upload-icon {
  opacity: 1;
  transform: scale(1.1);
}

/* Texto principal */
.upload-text {
  font-size: 1.25rem;
  font-weight: 600;
  color: #2d3748;
  margin: 0;
}

/* Hint/subtitle */
.upload-hint {
  font-size: 0.875rem;
  color: #718096;
  margin: 0;
}

/* Input file escondido */
.hidden-file-input {
  display: none !important;
}

/* Estados responsivos */
@media (max-width: 768px) {
  .upload-area {
    padding: 2rem 1rem;
    min-height: 160px;
  }

  .upload-icon {
    font-size: 3rem;
  }

  .upload-text {
    font-size: 1rem;
  }

  .upload-hint {
    font-size: 0.75rem;
  }
}

/* AnimaÃ§Ã£o de entrada */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.upload-area {
  animation: fadeIn 0.3s ease-out;
}

/* ================================================================
   ESTILOS PARA LISTA DE ARQUIVOS SELECIONADOS
   ================================================================ */

.files-selected {
  margin-top: 2rem;
  padding: 1.5rem;
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.files-header {
  font-size: 1.125rem;
  font-weight: 600;
  color: #2d3748;
  margin-bottom: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 2px solid #e2e8f0;
}

.files-list {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.file-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: #f7fafc;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
  transition: all 0.2s ease;
}

.file-item:hover {
  background: #edf2f7;
  border-color: #cbd5e0;
  transform: translateX(4px);
}

.file-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.file-name {
  flex: 1;
  font-weight: 500;
  color: #2d3748;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.file-size {
  font-size: 0.875rem;
  color: #718096;
  flex-shrink: 0;
}

.btn-remove {
  background: transparent;
  border: none;
  font-size: 1.25rem;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.btn-remove:hover {
  background: #fed7d7;
  transform: scale(1.1);
}

.files-summary {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid #e2e8f0;
  font-size: 0.875rem;
  color: #4a5568;
  text-align: right;
}

/* ================================================================
   ESTILOS PARA BOTÃ•ES DE AÃ‡ÃƒO
   ================================================================ */

.action-section {
  margin-top: 1.5rem;
  display: flex;
  gap: 1rem;
  justify-content: center;
  flex-wrap: wrap;
}

.btn {
  padding: 0.875rem 2rem;
  border-radius: 8px;
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  border: none;
  transition: all 0.2s ease;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

.btn-primary:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
}

.btn-primary:active:not(:disabled) {
  transform: translateY(0);
}

.btn-secondary {
  background: #e2e8f0;
  color: #2d3748;
}

.btn-secondary:hover:not(:disabled) {
  background: #cbd5e0;
  transform: translateY(-2px);
}

/* ================================================================
   LOADING E MENSAGENS
   ================================================================ */

.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  padding: 2rem;
  margin: 2rem 0;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 4px solid #e2e8f0;
  border-top-color: #667eea;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.loading p {
  font-size: 1rem;
  color: #4a5568;
  margin: 0;
}

.alert {
  padding: 1rem 1.5rem;
  border-radius: 8px;
  margin: 1rem 0;
  font-weight: 500;
}

.alert-info {
  background: #bee3f8;
  color: #2c5282;
  border: 1px solid #90cdf4;
}

.alert-success {
  background: #c6f6d5;
  color: #22543d;
  border: 1px solid #9ae6b4;
}

.alert-error {
  background: #fed7d7;
  color: #742a2a;
  border: 1px solid #fc8181;
}

.alert-warning {
  background: #feebc8;
  color: #7c2d12;
  border: 1px solid #fbd38d;
}

/* ================================================================
   RESPONSIVIDADE
   ================================================================ */

@media (max-width: 768px) {
  .file-item {
    flex-wrap: wrap;
  }

  .file-name {
    width: 100%;
    order: -1;
    margin-bottom: 0.5rem;
  }

  .action-section {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    justify-content: center;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\rotate-pdf.css
----------------------------------------

/* ================================================================
   ROTATE PDF - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m estilos especÃ­ficos da ferramenta Rotate PDF
   Estilos de upload bÃ¡sico estÃ£o em pdf-upload-shared.css
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.page-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   CONTENT CARD
   ============================================================ */

.content-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  margin-bottom: 2rem;
}

/* ============================================================
   INFO BOX
   ============================================================ */

.info-box {
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
}

.info-box.info {
  background: #ebf8ff;
  border-left: 4px solid #3182ce;
}

.info-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   FILE COUNTER (ESPECÃFICO DO ROTATE)
   ============================================================ */

.file-counter {
  text-align: center;
  padding: 1rem;
  background: linear-gradient(
    135deg,
    rgba(102, 126, 234, 0.1) 0%,
    rgba(118, 75, 162, 0.1) 100%
  );
  border-radius: 8px;
  margin: 2rem auto;
  max-width: 400px;
  border: 2px solid rgba(102, 126, 234, 0.2);
}

.counter-icon {
  font-size: 1.5rem;
  margin-right: 0.5rem;
}

#counterText {
  font-size: 1.1rem;
  font-weight: 600;
  color: #667eea;
}

/* ============================================================
   PREVIEW SECTION
   ============================================================ */

.preview-section {
  margin-top: 2rem;
}

.action-buttons-container {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.75rem;
  flex-wrap: wrap;
  margin-bottom: 2rem;
}

/* ============================================================
   PDF GRID (ESPECÃFICO DO ROTATE)
   ============================================================ */

.pdf-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
}

.pdf-card {
  background: white;
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  padding: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
}

.pdf-card:hover {
  border-color: #667eea;
  transform: translateY(-4px);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.pdf-card.selected {
  border-color: #667eea;
  background: #f7fafc;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
}

.pdf-checkbox {
  position: absolute;
  top: 0.5rem;
  left: 0.5rem;
  z-index: 10;
}

.pdf-checkbox input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
}

.pdf-thumbnail {
  width: 100%;
  height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f7fafc;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 0.75rem;
}

.pdf-thumbnail img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  transition: transform 0.3s ease;
}

.pdf-icon {
  font-size: 4rem;
  color: #cbd5e0;
  transition: transform 0.3s ease;
}

.pdf-info {
  text-align: center;
}

.pdf-name {
  font-size: 0.9rem;
  font-weight: 600;
  color: #2d3748;
  margin-bottom: 0.25rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.pdf-size {
  font-size: 0.8rem;
  color: #718096;
}

.rotation-badge {
  display: inline-block;
  background: #667eea;
  color: white;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  margin-top: 0.5rem;
}

/* ============================================================
   FEATURE BOXES
   ============================================================ */

.feature-boxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.feature-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.feature-icon {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.feature-box h4 {
  color: #2d3748;
  margin: 0 0 0.5rem 0;
}

.feature-box p {
  color: #718096;
  margin: 0;
  font-size: 0.95rem;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .page-container {
    padding: 1rem;
  }

  .page-header {
    flex-direction: column;
    text-align: center;
  }

  .action-buttons-container {
    flex-direction: column;
  }

  .action-buttons-container .btn {
    width: 100%;
  }

  .pdf-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
  }

  .content-card {
    padding: 1.5rem;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\css\ubs.css
----------------------------------------

/* ================================================================
   UBS SWITZERLAND - Estilos EspecÃ­ficos da PÃ¡gina
   ================================================================
   Este arquivo contÃ©m APENAS estilos especÃ­ficos da pÃ¡gina UBS
   Estilos de upload, botÃµes, loading etc estÃ£o em pdf-upload-shared.css
   
   COR TEMA: Vermelho UBS #E60000
   ================================================================ */

/* ============================================================
   LAYOUT DA PÃGINA
   ============================================================ */

.ubs-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

/* ============================================================
   CABEÃ‡ALHO (ESTILO PRÃ“PRIO DO UBS - VERMELHO)
   ============================================================ */

.page-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.header-icon {
  font-size: 3rem;
}

.page-header h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #2d3748;
  margin: 0;
}

.subtitle {
  color: #718096;
  margin: 0;
}

/* ============================================================
   INFO BOX (VERMELHO UBS)
   ============================================================ */

.info-box {
  background: #fff5f5;
  border-left: 4px solid #e60000;
  padding: 1.5rem;
  margin-bottom: 2rem;
  border-radius: 8px;
}

.info-box h3 {
  color: #e60000;
  margin-top: 0;
  font-size: 1.25rem;
}

.info-box ul {
  margin: 1rem 0 0 0;
  padding-left: 1.5rem;
}

.info-box li {
  margin-bottom: 0.5rem;
  color: #475569;
  line-height: 1.6;
}

/* ============================================================
   SEÃ‡ÃƒO DE UPLOAD
   ============================================================ */

.upload-section {
  margin-bottom: 2rem;
}

/* ============================================================
   FILE LIST (ESPECÃFICO DO UBS)
   ============================================================ */

.file-list {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 1.5rem;
  margin-top: 1.5rem;
}

.file-list h3 {
  color: #e60000;
  margin-top: 0;
  font-size: 1.125rem;
}

#fileListContent ul {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
}

#fileListContent li {
  padding: 0.75rem;
  background: #fff5f5;
  margin-bottom: 0.5rem;
  border-radius: 6px;
  border-left: 3px solid #e60000;
  color: #334155;
}

/* ============================================================
   PROCESS BUTTON (ESPECÃFICO DO UBS - VERMELHO)
   ============================================================ */

.process-btn {
  background: #e60000;
  color: white;
  border: none;
  padding: 1rem 2rem;
  font-size: 1.1rem;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
  margin-top: 1rem;
  font-weight: 600;
}

.process-btn:hover {
  background: #cc0000;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(230, 0, 0, 0.3);
}

.process-btn:active {
  transform: translateY(0);
}

/* ============================================================
   RESULT E ERROR SECTIONS
   ============================================================ */

.result-section {
  background: #f0fdf4;
  border: 2px solid #86efac;
  border-radius: 8px;
  padding: 2rem;
  text-align: center;
  margin-top: 2rem;
}

.result-success h3 {
  color: #16a34a;
  margin-top: 0;
  font-size: 1.5rem;
}

.result-success p {
  color: #15803d;
  margin: 1rem 0;
}

.download-btn {
  display: inline-block;
  background: #16a34a;
  color: white;
  padding: 1rem 2rem;
  text-decoration: none;
  border-radius: 8px;
  margin-top: 1rem;
  transition: all 0.3s ease;
  font-weight: 600;
}

.download-btn:hover {
  background: #15803d;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(22, 163, 74, 0.3);
}

.error-section {
  background: #fef2f2;
  border: 2px solid #fca5a5;
  border-radius: 8px;
  padding: 2rem;
  margin-top: 2rem;
}

.error-message h3 {
  color: #dc2626;
  margin-top: 0;
  font-size: 1.5rem;
}

.error-message p {
  color: #991b1b;
  margin: 1rem 0 0 0;
}

/* ============================================================
   LOADING SECTION
   ============================================================ */

.loading-section {
  text-align: center;
  padding: 3rem;
}

.loading-section p {
  color: #475569;
  font-size: 1.1rem;
  margin-top: 1rem;
}

/* Customizar spinner para vermelho UBS */
.loading-section .spinner {
  border-top-color: #e60000;
}

/* ============================================================
   RESPONSIVIDADE
   ============================================================ */

@media (max-width: 768px) {
  .ubs-container {
    padding: 1rem;
  }

  .header {
    padding: 1.5rem;
  }

  .header h1 {
    font-size: 1.75rem;
  }

  .subtitle {
    font-size: 1rem;
  }

  .info-box {
    padding: 1rem;
  }

  .file-list {
    padding: 1rem;
  }

  .result-section,
  .error-section {
    padding: 1.5rem;
  }

  .process-btn {
    font-size: 1rem;
  }
}



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\api-config.js
----------------------------------------

// ================================================================
// API CONFIGURATION - Sistema Centralizado
// ================================================================
// Este arquivo centraliza a configuraÃ§Ã£o da API para todo o sistema
// Detecta automaticamente se estÃ¡ em localhost ou rede local
// ================================================================

window.PdfProcessorConfig = (function () {
  "use strict";

  // ðŸ”§ Detectar URL base da API automaticamente
  function getApiBaseUrl() {
    const hostname = window.location.hostname;
    const port = window.location.port;

    console.log("ðŸ” Detectando configuraÃ§Ã£o de rede...");
    console.log("  Hostname:", hostname);
    console.log("  Port:", port);

    // Localhost
    if (hostname === "localhost" || hostname === "127.0.0.1") {
      console.log("âœ… Modo: LOCALHOST");
      return "http://localhost:5239";
    }

    // IP de rede local (192.168.x.x, 10.x.x.x, 172.16-31.x.x)
    if (hostname.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)) {
      const apiUrl = `http://${hostname}:5239`;
      console.log("âœ… Modo: REDE LOCAL (IP detectado)");
      console.log("  API URL:", apiUrl);
      return apiUrl;
    }

    // Fallback para localhost
    console.log("âš ï¸ Modo: FALLBACK para localhost");
    return "http://localhost:5239";
  }

  const API_BASE_URL = getApiBaseUrl();
  console.log("ðŸ”§ API Base URL configurada:", API_BASE_URL);

  // Interface pÃºblica
  return {
    getApiUrl: function () {
      return API_BASE_URL;
    },

    getEndpoint: function (path) {
      return API_BASE_URL + path;
    },
  };
})();



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\app.js
----------------------------------------

// JavaScript helper functions for PDF Processor
// Add this to wwwroot/js/app.js

window.downloadFile = function (fileName, base64Data) {
    const linkSource = `data:application/octet-stream;base64,${base64Data}`;
    const downloadLink = document.createElement('a');
    downloadLink.href = linkSource;
    downloadLink.download = fileName;
    downloadLink.click();
};

window.triggerFileInput = function (inputId) {
    const input = document.getElementById(inputId);
    if (input) {
        input.click();
    }
};


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\btg.js
----------------------------------------

// ================================================================
// BTG PACTUAL - Script de Upload Simplificado
// ================================================================
// Este arquivo usa o sistema compartilhado PdfUploadHandler
// Apenas define a lÃ³gica especÃ­fica do BTG Pactual
// ================================================================

console.log("ðŸŸ¢ BTG Pactual - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl() {
  return window.PdfProcessorConfig.getEndpoint("/api/Btg/batch");
}

// ============================================================
// UI FUNCTIONS
// ============================================================

function showMessage(message, type = "info") {
  const statusMessage = document.getElementById("statusMessage");
  if (!statusMessage) return;

  statusMessage.textContent = message;
  statusMessage.className = `alert alert-${type}`;
  statusMessage.style.display = "block";

  if (type === "success" || type === "error") {
    setTimeout(() => {
      statusMessage.style.display = "none";
    }, 5000);
  }
}

function showLoading(show, text = "Processando...") {
  const loading = document.getElementById("loadingIndicator");
  const loadingText = document.getElementById("loadingText");

  if (loading) {
    loading.style.display = show ? "flex" : "none";
  }

  if (loadingText && text) {
    loadingText.textContent = text;
  }
}

function updateUI() {
  const filesSelected = document.getElementById("filesSelected");
  const filesList = document.getElementById("filesList");
  const filesSummary = document.getElementById("filesSummary");
  const actionButtons = document.getElementById("actionButtons");
  const processBtn = document.getElementById("processBtn");

  if (!filesSelected || !filesList || !actionButtons) return;

  if (selectedFiles.length === 0) {
    filesSelected.style.display = "none";
    actionButtons.style.display = "none";
    return;
  }

  // Mostrar lista de arquivos
  filesSelected.style.display = "block";
  actionButtons.style.display = "flex";

  // Renderizar lista
  filesList.innerHTML = selectedFiles
    .map(
      (file, index) => `
    <div class="file-item">
      <span class="file-icon">ðŸ“„</span>
      <span class="file-name">${file.name}</span>
      <span class="file-size">${(file.size / 1024).toFixed(2)} KB</span>
      <button class="btn-remove" onclick="removeFile(${index})">ðŸ—‘ï¸</button>
    </div>
  `,
    )
    .join("");

  // Atualizar resumo
  if (filesSummary) {
    const totalSize = selectedFiles.reduce((sum, f) => sum + f.size, 0);
    filesSummary.innerHTML = `
      <strong>Total:</strong> ${selectedFiles.length} arquivo(s) - 
      ${(totalSize / 1024).toFixed(2)} KB
    `;
  }

  // Habilitar botÃ£o de processar
  if (processBtn) {
    processBtn.disabled = false;
    processBtn.textContent = `ðŸ¦ Processar ${selectedFiles.length} arquivo(s)`;
  }
}

// ============================================================
// FILE MANAGEMENT
// ============================================================

function removeFile(index) {
  console.log("ðŸ—‘ï¸ Removendo arquivo:", selectedFiles[index].name);
  selectedFiles.splice(index, 1);
  updateUI();
}

function clearFiles() {
  console.log("ðŸ—‘ï¸ Limpando todos os arquivos");
  selectedFiles = [];
  updateUI();
  showMessage("", "info"); // Limpar mensagens
}

// ============================================================
// CALLBACK DE ARQUIVOS SELECIONADOS
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Adicionar arquivos vÃ¡lidos
  selectedFiles = validFiles;

  // Mostrar erros se houver
  if (errors.length > 0) {
    showMessage(errors[0], "error");
  } else if (validFiles.length > 0) {
    showMessage(`${validFiles.length} arquivo(s) selecionado(s)`, "success");
  }

  // Atualizar interface
  updateUI();
}

// ============================================================
// PROCESSAR ARQUIVOS
// ============================================================

async function processFiles() {
  if (selectedFiles.length === 0) {
    showMessage("Nenhum arquivo selecionado", "error");
    return;
  }

  console.log(
    "ðŸš€ Iniciando processamento de",
    selectedFiles.length,
    "arquivo(s)",
  );

  showLoading(
    true,
    `Processando ${selectedFiles.length} extrato(s) do BTG Pactual...`,
  );
  showMessage("", "info"); // Limpar mensagens anteriores

  try {
    // Criar FormData
    const formData = new FormData();
    selectedFiles.forEach((file) => {
      formData.append("files", file);
    });

    console.log("ðŸ“¤ Enviando para API:", getApiUrl());

    // Fazer requisiÃ§Ã£o
    const response = await fetch(getApiUrl(), {
      method: "POST",
      body: formData,
    });

    console.log("ðŸ“¥ Resposta recebida:", response.status, response.statusText);

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro ${response.status}: ${errorText}`);
    }

    // Download do arquivo Excel
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `BTG_Pactual_Transactions_${new Date().toISOString().split("T")[0]}.xlsx`;
    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
    document.body.removeChild(a);

    console.log("âœ… Download iniciado com sucesso");

    showMessage("âœ… Excel gerado e baixado com sucesso!", "success");

    // Limpar arquivos apÃ³s sucesso
    setTimeout(() => clearFiles(), 2000);
  } catch (error) {
    console.error("âŒ Erro no processamento:", error);
    showMessage(`Erro: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

// Tornar funÃ§Ã£o disponÃ­vel globalmente para reinicializaÃ§Ã£o
window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando BTG Pactual Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024, // 16MB
    allowMultiple: true,
    debug: true,
  });
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  // DOM jÃ¡ carregado (navegaÃ§Ã£o SPA do Blazor)
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.processFiles = processFiles;
window.clearFiles = clearFiles;
window.removeFile = removeFile;



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\compress-pdf.js
----------------------------------------

// ================================================================
// COMPRESS PDF - Script Simplificado - ÃšLTIMA FERRAMENTA! ðŸŽ‰
// ================================================================
// Usa sistema compartilhado para upload bÃ¡sico
// MantÃ©m lÃ³gica especÃ­fica de nÃ­veis de compressÃ£o e opÃ§Ãµes
// ================================================================

console.log("ðŸŸ¢ CompressPDF - Script carregado - ÃšLTIMA FERRAMENTA!");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl(endpoint = "/batch") {
  return window.PdfProcessorConfig.getEndpoint(`/api/compresspdf${endpoint}`);
}

// ============================================================
// FILE PROCESSING
// ============================================================

function processFiles(files) {
  selectedFiles = [];

  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    console.log(
      `ðŸ“„ Processando arquivo ${i + 1}/${files.length}: ${file.name}`,
    );

    selectedFiles.push({
      file: file,
      name: file.name,
      size: file.size,
      compressionLevel: "Medium", // PadrÃ£o
      removeImages: false,
    });

    console.log(`âœ… Arquivo adicionado: ${file.name}`);
  }

  console.log(`\nðŸŽ¨ Renderizando grid com ${selectedFiles.length} arquivos`);
  renderFilesGrid();
  updateFileCounter();
}

// ============================================================
// CALLBACK DO SISTEMA COMPARTILHADO
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Mostrar erros se houver
  if (errors.length > 0) {
    showMessage(errors[0], "error");
  }

  // Processar arquivos vÃ¡lidos
  if (validFiles.length > 0) {
    processFiles(validFiles);
  }
}

// ============================================================
// RENDERIZAÃ‡ÃƒO DA TABELA
// ============================================================

function renderFilesGrid() {
  const grid = document.getElementById("filesGrid");
  const counter = document.getElementById("fileCounter");
  const actionButtons = document.getElementById("actionButtons");

  if (selectedFiles.length === 0) {
    grid.innerHTML = "";
    counter.style.display = "none";
    actionButtons.style.display = "none";
    console.log("ðŸ“­ Nenhum arquivo para renderizar");
    return;
  }

  counter.style.display = "block";
  actionButtons.style.display = "flex";

  // Renderizar como tabela
  grid.innerHTML = `
    <table class="files-table">
      <thead>
        <tr>
          <th>Arquivo</th>
          <th>Tamanho</th>
          <th>NÃ­vel de CompressÃ£o</th>
          <th>OpÃ§Ãµes</th>
        </tr>
      </thead>
      <tbody>
        ${selectedFiles
          .map(
            (fileData, index) => `
          <tr data-index="${index}">
            <td data-label="Arquivo">
              <div class="file-name-cell">
                <span class="file-icon">ðŸ“„</span>
                <span class="file-name">${fileData.name}</span>
              </div>
            </td>
            <td data-label="Tamanho">
              <span class="file-size">${formatFileSize(fileData.size)}</span>
            </td>
            <td class="compression-cell" data-label="CompressÃ£o">
              <select class="compression-select" onchange="setCompression(${index}, this.value)">
                <option value="Low" ${fileData.compressionLevel === "Low" ? "selected" : ""}>
                  ðŸŸ¢ Baixa (melhor qualidade)
                </option>
                <option value="Medium" ${fileData.compressionLevel === "Medium" ? "selected" : ""}>
                  ðŸŸ¡ MÃ©dia (balanceado)
                </option>
                <option value="High" ${fileData.compressionLevel === "High" ? "selected" : ""}>
                  ðŸ”´ Alta (menor tamanho)
                </option>
              </select>
            </td>
            <td class="options-cell" data-label="OpÃ§Ãµes">
              <div class="remove-images-checkbox">
                <input type="checkbox" 
                       id="removeImages${index}" 
                       ${fileData.removeImages ? "checked" : ""}
                       onchange="toggleRemoveImages(${index})" />
                <label for="removeImages${index}">Remover imagens</label>
              </div>
            </td>
          </tr>
        `,
          )
          .join("")}
      </tbody>
    </table>
  `;

  console.log("âœ… Tabela renderizada");
}

function formatFileSize(bytes) {
  if (bytes === 0) return "0 B";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
}

// ============================================================
// FILE SETTINGS MANAGEMENT
// ============================================================

function setCompression(index, level) {
  selectedFiles[index].compressionLevel = level;
  renderFilesGrid();
  console.log(`ðŸ”§ Arquivo ${index}: compressÃ£o alterada para ${level}`);
}

function toggleRemoveImages(index) {
  selectedFiles[index].removeImages = !selectedFiles[index].removeImages;
  console.log(
    `ðŸ–¼ï¸ Arquivo ${index}: remover imagens = ${selectedFiles[index].removeImages}`,
  );
}

function applyCompressionToAll(level) {
  selectedFiles.forEach((file) => {
    file.compressionLevel = level;
  });
  renderFilesGrid();
  console.log(
    `ðŸŽ¯ CompressÃ£o ${level} aplicada a todos os ${selectedFiles.length} arquivos`,
  );
}

// ============================================================
// UI UPDATE
// ============================================================

function updateFileCounter() {
  const counterText = document.getElementById("counterText");
  if (counterText) {
    counterText.textContent = `Arquivos Carregados: ${selectedFiles.length}`;
  }
}

// ============================================================
// COMPRESS EXECUTION
// ============================================================

async function compressAllFiles() {
  if (selectedFiles.length === 0) {
    showMessage("Selecione pelo menos um arquivo PDF", "error");
    return;
  }

  console.log(
    `\nðŸ—œï¸ Iniciando compressÃ£o de ${selectedFiles.length} arquivo(s)`,
  );

  showLoading(true, `Comprimindo ${selectedFiles.length} arquivo(s)...`);

  try {
    const formData = new FormData();

    // Adicionar cada arquivo com suas configuraÃ§Ãµes
    for (let i = 0; i < selectedFiles.length; i++) {
      const fileData = selectedFiles[i];
      formData.append("files", fileData.file);
      formData.append("compressionLevels", fileData.compressionLevel);
      formData.append("removeImages", fileData.removeImages.toString());
    }

    console.log("ðŸ“¡ Enviando requisiÃ§Ã£o para API...");
    const response = await fetch(getApiUrl("/batch"), {
      method: "POST",
      body: formData,
      mode: "cors",
    });

    console.log(
      `ðŸ“Š Resposta da API: ${response.status} ${response.statusText}`,
    );

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro na API: ${response.status} - ${errorText}`);
    }

    // Obter o nome do arquivo do header
    const contentDisposition = response.headers.get("Content-Disposition");
    let fileName =
      selectedFiles.length === 1
        ? `${selectedFiles[0].name.replace(".pdf", "")}_comprimido.pdf`
        : `pdfs_comprimidos_${new Date().toISOString().slice(0, 10)}.zip`;

    if (contentDisposition) {
      const matches = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(
        contentDisposition,
      );
      if (matches && matches[1]) {
        fileName = matches[1].replace(/['"]/g, "");
      }
    }

    // Download do arquivo
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
    document.body.removeChild(a);

    console.log(`âœ… Download iniciado: ${fileName}`);
    showMessage(
      `âœ… ${selectedFiles.length} arquivo(s) comprimido(s) com sucesso!`,
      "success",
    );

    // Limpar apÃ³s sucesso
    setTimeout(clearAllFiles, 2000);
  } catch (error) {
    console.error("âŒ Erro ao comprimir:", error);
    showMessage(`âŒ Erro ao comprimir: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// CLEAR
// ============================================================

function clearAllFiles() {
  selectedFiles = [];
  const fileInput = document.getElementById("fileInput");
  if (fileInput) {
    fileInput.value = "";
  }
  renderFilesGrid();
  updateFileCounter();
  showMessage("", "");
  console.log("ðŸ—‘ï¸ Todos os arquivos removidos");
}

// ============================================================
// UI HELPERS
// ============================================================

function showLoading(show, text = "Processando...") {
  const loading = document.getElementById("loadingIndicator");
  const loadingText = document.getElementById("loadingText");

  if (loading) {
    loading.style.display = show ? "block" : "none";
  }

  if (loadingText && text) {
    loadingText.textContent = text;
  }
}

function showMessage(message, type = "info") {
  const statusMessage = document.getElementById("statusMessage");

  if (!message) {
    statusMessage.style.display = "none";
    return;
  }

  statusMessage.textContent = message;
  statusMessage.className = `alert alert-${type}`;
  statusMessage.style.display = "block";
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando Compress PDF Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024,
    allowMultiple: true,
    debug: true,
  });
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.compressAllFiles = compressAllFiles;
window.clearAllFiles = clearAllFiles;
window.setCompression = setCompression;
window.toggleRemoveImages = toggleRemoveImages;
window.applyCompressionToAll = applyCompressionToAll;

console.log(
  "âœ… Script compress-pdf.js carregado completamente - ÃšLTIMA FERRAMENTA COMPLETA! ðŸŽ‰",
);



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\edit-pdf.js
----------------------------------------

// ================================================================
// EDIT PDF - RotaÃ§Ã£o e RemoÃ§Ã£o de PÃ¡ginas Individuais
// ================================================================
// Usa sistema compartilhado para upload bÃ¡sico
// Funcionalidade avanÃ§ada: ediÃ§Ã£o por pÃ¡gina individual
// ================================================================

console.log("ðŸŸ¢ EditPDF - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let pdfFile = null;
let pages = []; // Array de {pageNumber, thumbnail, rotation, deleted}

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl(endpoint = "") {
  return window.PdfProcessorConfig.getEndpoint(`/api/editpdf${endpoint}`);
}

// ============================================================
// CALLBACK DO SISTEMA COMPARTILHADO
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Mostrar erros se houver
  if (errors.length > 0) {
    showMessage(errors[0], "error");
    return;
  }

  // Edit PDF aceita apenas 1 arquivo por vez
  if (validFiles.length > 1) {
    showMessage("Por favor, selecione apenas um arquivo PDF por vez", "error");
    return;
  }

  // Processar o arquivo
  if (validFiles.length === 1) {
    loadPdfFile(validFiles[0]);
  }
}

// ============================================================
// CARREGAR PDF E PÃGINAS
// ============================================================

async function loadPdfFile(file) {
  pdfFile = file;
  pages = [];

  console.log(`\nðŸ“„ Carregando PDF: ${file.name}`);

  showLoading(true, "Carregando pÃ¡ginas...");

  try {
    // 1. Obter nÃºmero de pÃ¡ginas
    const pageCount = await getPageCount(file);
    console.log(`ðŸ“Š PDF tem ${pageCount} pÃ¡ginas`);

    // 2. Mostrar info do arquivo
    showFileInfo(file, pageCount);

    // 3. Carregar thumbnails de todas as pÃ¡ginas
    for (let i = 1; i <= pageCount; i++) {
      console.log(`ðŸ–¼ï¸ Carregando thumbnail da pÃ¡gina ${i}/${pageCount}...`);

      const thumbnail = await loadPageThumbnail(file, i);

      pages.push({
        pageNumber: i,
        thumbnail: thumbnail,
        rotation: 0,
        deleted: false,
      });

      // Renderizar progressivamente
      renderPagesGrid();
      updateStats();
    }

    console.log(`âœ… Todas as ${pageCount} pÃ¡ginas carregadas!`);
    showMessage(`âœ… ${pageCount} pÃ¡ginas carregadas com sucesso!`, "success");
  } catch (error) {
    console.error("âŒ Erro ao carregar PDF:", error);
    showMessage(`âŒ Erro ao carregar PDF: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// API CALLS
// ============================================================

async function getPageCount(file) {
  const formData = new FormData();
  formData.append("file", file);

  const response = await fetch(getApiUrl("/pagecount"), {
    method: "POST",
    body: formData,
  });

  if (!response.ok) {
    throw new Error(`Erro ao contar pÃ¡ginas: ${response.status}`);
  }

  const data = await response.json();
  return data.pageCount;
}

async function loadPageThumbnail(file, pageNumber) {
  const formData = new FormData();
  formData.append("file", file);
  formData.append("pageNumber", pageNumber);

  const response = await fetch(getApiUrl("/thumbnail"), {
    method: "POST",
    body: formData,
  });

  if (!response.ok) {
    throw new Error(`Erro ao carregar thumbnail: ${response.status}`);
  }

  const data = await response.json();
  return data.thumbnail;
}

// ============================================================
// RENDERIZAÃ‡ÃƒO
// ============================================================

function showFileInfo(file, pageCount) {
  const container = document.getElementById("fileInfoContainer");

  if (!container) return;

  const sizeFormatted = formatFileSize(file.size);

  container.innerHTML = `
    <div class="file-info-bar">
      <div class="file-info-content">
        <div class="file-info-icon">ðŸ“„</div>
        <div class="file-info-details">
          <h3>${file.name}</h3>
          <p>${pageCount} pÃ¡ginas â€¢ ${sizeFormatted}</p>
        </div>
      </div>
      <div class="file-info-actions">
        <button class="btn-icon-white" onclick="resetAll()">
          ðŸ”„ Trocar PDF
        </button>
      </div>
    </div>
  `;

  container.style.display = "block";
}

function renderPagesGrid() {
  const grid = document.getElementById("pagesGrid");
  const section = document.getElementById("pagesSection");

  if (!grid || pages.length === 0) return;

  section.style.display = "block";

  grid.innerHTML = pages
    .map((page, index) => {
      const rotationClass = page.rotation > 0 ? `rotate-${page.rotation}` : "";
      const deletedClass = page.deleted ? "deleted" : "";
      const statusBadge = page.deleted
        ? '<span class="page-status deleted">SerÃ¡ removida</span>'
        : page.rotation > 0
          ? `<span class="page-status rotated">${page.rotation}Â°</span>`
          : "";

      return `
      <div class="page-card ${deletedClass}" data-page="${index}">
        <div class="page-thumbnail-container">
          <img src="${page.thumbnail}" 
               class="page-thumbnail ${rotationClass}" 
               alt="PÃ¡gina ${page.pageNumber}" />
        </div>
        
        <div class="page-info">
          <div class="page-number">PÃ¡gina ${page.pageNumber}</div>
          ${statusBadge}
        </div>

        <div class="page-controls">
          ${
            page.deleted
              ? `
            <button class="btn-page-control restore" 
                    onclick="restorePage(${index})"
                    title="Restaurar pÃ¡gina">
              â†©ï¸
            </button>
          `
              : `
            <button class="btn-page-control rotate-left" 
                    onclick="rotatePage(${index}, -90)"
                    title="Rotacionar 90Â° esquerda">
              â†¶
            </button>
            <button class="btn-page-control rotate-right" 
                    onclick="rotatePage(${index}, 90)"
                    title="Rotacionar 90Â° direita">
              â†·
            </button>
            <button class="btn-page-control delete" 
                    onclick="deletePage(${index})"
                    title="Remover pÃ¡gina">
              ðŸ—‘ï¸
            </button>
          `
          }
        </div>
      </div>
    `;
    })
    .join("");

  console.log("âœ… Grid renderizado");
}

// ============================================================
// PAGE OPERATIONS
// ============================================================

function rotatePage(index, degrees) {
  pages[index].rotation = (pages[index].rotation + degrees + 360) % 360;
  console.log(
    `ðŸ”„ PÃ¡gina ${pages[index].pageNumber}: rotaÃ§Ã£o ${pages[index].rotation}Â°`,
  );
  renderPagesGrid();
  updateStats();
}

function deletePage(index) {
  pages[index].deleted = true;
  console.log(`ðŸ—‘ï¸ PÃ¡gina ${pages[index].pageNumber}: marcada para remoÃ§Ã£o`);
  renderPagesGrid();
  updateStats();
}

function restorePage(index) {
  pages[index].deleted = false;
  console.log(`â†©ï¸ PÃ¡gina ${pages[index].pageNumber}: restaurada`);
  renderPagesGrid();
  updateStats();
}

function resetRotations() {
  pages.forEach((page) => {
    page.rotation = 0;
  });
  console.log("ðŸ”„ Todas as rotaÃ§Ãµes resetadas");
  renderPagesGrid();
  updateStats();
}

function resetDeletions() {
  pages.forEach((page) => {
    page.deleted = false;
  });
  console.log("â†©ï¸ Todas as pÃ¡ginas restauradas");
  renderPagesGrid();
  updateStats();
}

// ============================================================
// STATISTICS
// ============================================================

function updateStats() {
  const statsContainer = document.getElementById("actionStats");
  const downloadBtn = document.getElementById("downloadBtn");

  if (!statsContainer) return;

  const totalPages = pages.length;
  const rotatedPages = pages.filter((p) => !p.deleted && p.rotation > 0).length;
  const deletedPages = pages.filter((p) => p.deleted).length;
  const finalPages = totalPages - deletedPages;

  statsContainer.innerHTML = `
    <div class="stat-item">
      <span class="stat-icon">ðŸ“„</span>
      <span><span class="stat-value">${finalPages}</span> de ${totalPages} pÃ¡ginas</span>
    </div>
    ${
      rotatedPages > 0
        ? `
      <div class="stat-item">
        <span class="stat-icon">ðŸ”„</span>
        <span><span class="stat-value">${rotatedPages}</span> rotacionadas</span>
      </div>
    `
        : ""
    }
    ${
      deletedPages > 0
        ? `
      <div class="stat-item">
        <span class="stat-icon">ðŸ—‘ï¸</span>
        <span><span class="stat-value">${deletedPages}</span> removidas</span>
      </div>
    `
        : ""
    }
  `;

  // Habilitar/desabilitar botÃ£o de download
  if (downloadBtn) {
    const hasChanges = rotatedPages > 0 || deletedPages > 0;
    downloadBtn.disabled = !hasChanges || finalPages === 0;

    if (finalPages === 0) {
      downloadBtn.textContent = "âš ï¸ Nenhuma pÃ¡gina restante";
    } else if (!hasChanges) {
      downloadBtn.textContent = "ðŸ“¥ Sem alteraÃ§Ãµes para salvar";
    } else {
      downloadBtn.textContent = `ðŸ“¥ Download PDF (${finalPages} pÃ¡ginas)`;
    }
  }
}

// ============================================================
// DOWNLOAD EDITED PDF
// ============================================================

async function downloadEditedPdf() {
  if (!pdfFile) {
    showMessage("Nenhum PDF carregado", "error");
    return;
  }

  const keptPages = pages.filter((p) => !p.deleted);

  if (keptPages.length === 0) {
    showMessage(
      "VocÃª removeu todas as pÃ¡ginas! Adicione pelo menos uma.",
      "error",
    );
    return;
  }

  console.log(`\nðŸ’¾ Iniciando download do PDF editado`);
  showLoading(true, "Processando PDF...");

  try {
    const formData = new FormData();
    formData.append("file", pdfFile);

    // Preparar operaÃ§Ãµes por pÃ¡gina
    const operations = pages.map((page) => ({
      pageNumber: page.pageNumber,
      rotation: page.rotation,
      keep: !page.deleted,
    }));

    formData.append("pageOperations", JSON.stringify(operations));

    console.log("ðŸ“¡ Enviando para API:", operations);

    const response = await fetch(getApiUrl("/process"), {
      method: "POST",
      body: formData,
    });

    if (!response.ok) {
      throw new Error(`Erro na API: ${response.status}`);
    }

    // Download do arquivo
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = pdfFile.name.replace(".pdf", "_edited.pdf");
    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
    document.body.removeChild(a);

    console.log(`âœ… Download iniciado`);
    showMessage("âœ… PDF editado baixado com sucesso!", "success");
  } catch (error) {
    console.error("âŒ Erro ao processar:", error);
    showMessage(`âŒ Erro ao processar: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// RESET
// ============================================================

function resetAll() {
  pdfFile = null;
  pages = [];

  const fileInput = document.getElementById("fileInput");
  if (fileInput) {
    fileInput.value = "";
  }

  const fileInfoContainer = document.getElementById("fileInfoContainer");
  if (fileInfoContainer) {
    fileInfoContainer.style.display = "none";
  }

  const pagesSection = document.getElementById("pagesSection");
  if (pagesSection) {
    pagesSection.style.display = "none";
  }

  showMessage("", "");
  console.log("ðŸ”„ Tudo resetado");
}

// ============================================================
// HELPERS
// ============================================================

function formatFileSize(bytes) {
  if (bytes === 0) return "0 B";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
}

function showLoading(show, text = "Processando...") {
  const loading = document.getElementById("loadingIndicator");
  const loadingText = document.getElementById("loadingText");

  if (loading) {
    loading.style.display = show ? "block" : "none";
  }

  if (loadingText && text) {
    loadingText.textContent = text;
  }
}

function showMessage(message, type = "info") {
  const statusMessage = document.getElementById("statusMessage");

  if (!statusMessage) return;

  if (!message) {
    statusMessage.style.display = "none";
    return;
  }

  statusMessage.textContent = message;
  statusMessage.className = `alert alert-${type}`;
  statusMessage.style.display = "block";
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando Edit PDF Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024,
    allowMultiple: false, // APENAS 1 arquivo por vez!
    debug: true,
  });
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.rotatePage = rotatePage;
window.deletePage = deletePage;
window.restorePage = restorePage;
window.resetRotations = resetRotations;
window.resetDeletions = resetDeletions;
window.downloadEditedPdf = downloadEditedPdf;
window.resetAll = resetAll;

console.log("âœ… Script edit-pdf.js carregado completamente");



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\itau-cash.js
----------------------------------------

// ================================================================
// ITAÃš CASH - Script de Upload Simplificado
// ================================================================
// Este arquivo usa o sistema compartilhado PdfUploadHandler
// Apenas define a lÃ³gica especÃ­fica do ItaÃº Cash
// ================================================================

console.log("ðŸŸ¢ ItaÃº Cash - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl() {
  return window.PdfProcessorConfig.getEndpoint("/api/itaucash/batch");
}

// ============================================================
// UI FUNCTIONS
// ============================================================

function showMessage(message, type = "info") {
  const statusMessage = document.getElementById("statusMessage");
  if (!statusMessage) return;

  statusMessage.textContent = message;
  statusMessage.className = `alert alert-${type}`;
  statusMessage.style.display = "block";

  if (type === "success" || type === "error") {
    setTimeout(() => {
      statusMessage.style.display = "none";
    }, 5000);
  }
}

function showLoading(show, text = "Processando...") {
  const loading = document.getElementById("loadingIndicator");
  const loadingText = document.getElementById("loadingText");
  const actionButtons = document.getElementById("actionButtons");

  if (loading) {
    loading.style.display = show ? "flex" : "none";
  }

  if (loadingText && text) {
    loadingText.textContent = text;
  }

  if (actionButtons) {
    actionButtons.style.display = show ? "none" : "flex";
  }
}

function formatFileSize(bytes) {
  if (bytes === 0) return "0 B";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
}

function updateUI() {
  const filesSelected = document.getElementById("filesSelected");
  const filesList = document.getElementById("filesList");
  const filesSummary = document.getElementById("filesSummary");
  const actionButtons = document.getElementById("actionButtons");
  const processBtn = document.getElementById("processBtn");

  if (!filesSelected || !filesList || !actionButtons) return;

  if (selectedFiles.length === 0) {
    filesSelected.style.display = "none";
    actionButtons.style.display = "none";
    return;
  }

  // Mostrar lista de arquivos
  filesSelected.style.display = "block";
  actionButtons.style.display = "flex";

  // Renderizar lista
  filesList.innerHTML = selectedFiles
    .map(
      (file, index) => `
    <div class="file-item">
      <span class="file-icon">ðŸ“„</span>
      <span class="file-name">${file.name}</span>
      <span class="file-size">${formatFileSize(file.size)}</span>
    </div>
  `,
    )
    .join("");

  // Atualizar resumo
  if (filesSummary) {
    const totalSize = selectedFiles.reduce((sum, f) => sum + f.size, 0);
    filesSummary.textContent = `Total: ${selectedFiles.length} arquivo(s) â€¢ ${formatFileSize(totalSize)}`;
  }

  // Habilitar botÃ£o de processar
  if (processBtn) {
    processBtn.disabled = false;
  }
}

// ============================================================
// FILE MANAGEMENT
// ============================================================

function clearFiles() {
  console.log("ðŸ—‘ï¸ Limpando todos os arquivos");
  selectedFiles = [];
  updateUI();
  showMessage("", "info"); // Limpar mensagens
}

// ============================================================
// CALLBACK DE ARQUIVOS SELECIONADOS
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Adicionar arquivos vÃ¡lidos
  selectedFiles = validFiles;

  // Mostrar erros se houver
  if (errors.length > 0) {
    showMessage(errors[0], "error");
  } else if (validFiles.length > 0) {
    showMessage(`${validFiles.length} arquivo(s) selecionado(s)`, "success");
  }

  // Atualizar interface
  updateUI();
}

// ============================================================
// PROCESSAR ARQUIVOS
// ============================================================

async function processFiles() {
  if (selectedFiles.length === 0) {
    showMessage("Nenhum arquivo selecionado", "error");
    return;
  }

  console.log(
    "ðŸš€ Iniciando processamento de",
    selectedFiles.length,
    "arquivo(s)",
  );

  showLoading(
    true,
    `Processando ${selectedFiles.length} extrato(s) do ItaÃº Cash...`,
  );
  showMessage("", "info"); // Limpar mensagens anteriores

  try {
    // Criar FormData
    const formData = new FormData();
    selectedFiles.forEach((file) => {
      formData.append("files", file);
    });

    console.log("ðŸ“¤ Enviando para API:", getApiUrl());

    // Fazer requisiÃ§Ã£o
    const response = await fetch(getApiUrl(), {
      method: "POST",
      body: formData,
      mode: "cors",
    });

    console.log("ðŸ“¥ Resposta recebida:", response.status, response.statusText);

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro ${response.status}: ${errorText}`);
    }

    // Download do arquivo Excel
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;

    const timestamp = new Date()
      .toISOString()
      .slice(0, 19)
      .replace(/[-:]/g, "")
      .replace("T", "_");
    a.download = `itau_cash_${timestamp}.xlsx`;

    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
    document.body.removeChild(a);

    console.log("âœ… Download iniciado com sucesso");

    showMessage("âœ… Excel gerado e baixado com sucesso!", "success");

    // Limpar arquivos apÃ³s sucesso
    setTimeout(() => clearFiles(), 2000);
  } catch (error) {
    console.error("âŒ Erro no processamento:", error);
    showMessage(`Erro: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

// Tornar funÃ§Ã£o disponÃ­vel globalmente para reinicializaÃ§Ã£o
window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando ItaÃº Cash Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024, // 16MB
    allowMultiple: true,
    debug: true,
  });
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  // DOM jÃ¡ carregado (navegaÃ§Ã£o SPA do Blazor)
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.processFiles = processFiles;
window.clearFiles = clearFiles;

console.log("âœ… Script itau-cash.js carregado completamente");



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\itau-cash2.js
----------------------------------------

// ================================================================
// ITAÃš CASH 2.0 - Script de Upload Simplificado com Modo DEBUG
// ================================================================
// Este arquivo usa o sistema compartilhado PdfUploadHandler
// Apenas define a lÃ³gica especÃ­fica do ItaÃº Cash 2.0
// ================================================================

console.log("ðŸ¦ ItaÃº Cash 2.0 - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];
let debugMode = false;

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl() {
  return window.PdfProcessorConfig.getEndpoint("/api/ItauCash2/process");
}

// ============================================================
// UI FUNCTIONS ESPECÃFICAS DO ITAÃš CASH 2
// ============================================================

function showLoading() {
  const loadingSection = document.getElementById("loadingSection");
  const loadingMessage = document.getElementById("loadingMessage");
  
  if (debugMode) {
    loadingMessage.textContent = "Gerando relatÃ³rio DEBUG com coordenadas X,Y...";
  } else {
    loadingMessage.textContent = "Processando PDFs do ItaÃº Cash 2.0...";
  }
  
  loadingSection.style.display = "block";
  document.getElementById("resultSection").style.display = "none";
  document.getElementById("errorSection").style.display = "none";
  document.getElementById("fileList").style.display = "none";
}

function hideLoading() {
  document.getElementById("loadingSection").style.display = "none";
}

function showSuccess(filename, url) {
  const message = debugMode 
    ? `RelatÃ³rio DEBUG gerado: ${filename}. Abra o Excel para ver as coordenadas X,Y de cada elemento.`
    : `Arquivo gerado: ${filename}`;
    
  document.getElementById("resultMessage").textContent = message;
  document.getElementById("downloadLink").href = url;
  document.getElementById("downloadLink").download = filename;
  document.getElementById("resultSection").style.display = "block";
}

function showError(message) {
  document.getElementById("errorMessage").textContent = message;
  document.getElementById("errorSection").style.display = "block";
}

function updateUI() {
  const fileList = document.getElementById("fileList");
  const fileListContent = document.getElementById("fileListContent");
  const processBtn = document.getElementById("processBtn");

  if (selectedFiles.length === 0) {
    fileList.style.display = "none";
    return;
  }

  // Atualizar texto do botÃ£o baseado no modo DEBUG
  if (debugMode) {
    processBtn.innerHTML = "ðŸ” Gerar RelatÃ³rio DEBUG";
  } else {
    processBtn.innerHTML = "ðŸš€ Processar PDFs";
  }

  // Renderizar lista
  let html = "<ul>";
  selectedFiles.forEach((file) => {
    html += `<li>ðŸ“„ ${file.name} (${(file.size / 1024).toFixed(2)} KB)</li>`;
  });
  html += "</ul>";

  fileListContent.innerHTML = html;
  fileList.style.display = "block";

  console.log(`ðŸ“‹ Mostrando ${selectedFiles.length} arquivo(s) - Debug: ${debugMode}`);
}

// ============================================================
// DEBUG MODE TOGGLE
// ============================================================

function updateDebugMode() {
  const checkbox = document.getElementById("debugModeCheckbox");
  const uploadArea = document.getElementById("uploadArea");
  
  debugMode = checkbox.checked;
  
  if (debugMode) {
    uploadArea.classList.add("debug-mode-active");
    console.log("ðŸ” Modo DEBUG ativado");
  } else {
    uploadArea.classList.remove("debug-mode-active");
    console.log("âš¡ Modo PRODUÃ‡ÃƒO ativado");
  }
  
  // Atualizar UI se jÃ¡ tiver arquivos selecionados
  if (selectedFiles.length > 0) {
    updateUI();
  }
}

// ============================================================
// FILE MANAGEMENT
// ============================================================

function clearFiles() {
  console.log("ðŸ—‘ï¸ Limpando todos os arquivos");
  selectedFiles = [];
  updateUI();

  // Esconder sections
  document.getElementById("resultSection").style.display = "none";
  document.getElementById("errorSection").style.display = "none";
}

// ============================================================
// CALLBACK DE ARQUIVOS SELECIONADOS
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
    debugMode: debugMode
  });

  // Adicionar arquivos vÃ¡lidos
  selectedFiles = validFiles;

  // Mostrar erros se houver
  if (errors.length > 0) {
    showError(errors[0]);
  }

  // Atualizar interface
  updateUI();
}

// ============================================================
// PROCESSAR ARQUIVOS
// ============================================================

async function processFiles() {
  if (selectedFiles.length === 0) {
    showError("Selecione pelo menos um arquivo PDF");
    return;
  }

  console.log(
    "ðŸš€ Iniciando processamento de",
    selectedFiles.length,
    "arquivo(s) - Debug:",
    debugMode
  );

  showLoading();

  try {
    // Criar FormData
    const formData = new FormData();
    selectedFiles.forEach((file, index) => {
      formData.append("files", file);
      console.log(`ðŸ“Ž Arquivo ${index + 1} adicionado: ${file.name}`);
    });
    
    // Adicionar flag de debug mode
    formData.append("debugMode", debugMode.toString());
    console.log(`ðŸ”§ Debug mode: ${debugMode}`);

    console.log("ðŸ“¤ Enviando para API:", getApiUrl());

    // Fazer requisiÃ§Ã£o
    const response = await fetch(getApiUrl(), {
      method: "POST",
      body: formData,
    });

    console.log("ðŸ“¥ Resposta recebida:", response.status, response.statusText);

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro ${response.status}: ${errorText}`);
    }

    // Download do arquivo Excel
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);

    // Tentar extrair filename do header
    const filename =
      response.headers.get("content-disposition")?.split("filename=")[1]?.replace(/"/g, '') ||
      (debugMode 
        ? `ItauCash2_DEBUG_${new Date().toISOString().split("T")[0]}.xlsx`
        : `ItauCash2_Transacoes_${new Date().toISOString().split("T")[0]}.xlsx`);

    console.log(`âœ… Sucesso! Arquivo: ${filename}`);

    showSuccess(filename, url);
  } catch (error) {
    console.error("âŒ Erro no processamento:", error);
    showError(error.message);
  } finally {
    hideLoading();
  }
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

// Tornar funÃ§Ã£o disponÃ­vel globalmente para reinicializaÃ§Ã£o
window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando ItaÃº Cash 2.0 Upload Handler...");

  // Inicializar sistema de upload
  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024, // 16MB
    allowMultiple: true,
    debug: true,
  });

  // Adicionar listener ao botÃ£o processar
  const processBtn = document.getElementById("processBtn");
  if (processBtn) {
    processBtn.addEventListener("click", processFiles);
    console.log("âœ… BotÃ£o processar configurado");
  }
  
  // Adicionar listener ao checkbox de debug
  const debugCheckbox = document.getElementById("debugModeCheckbox");
  if (debugCheckbox) {
    debugCheckbox.addEventListener("change", updateDebugMode);
    console.log("âœ… Checkbox DEBUG configurado");
  }
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  // DOM jÃ¡ carregado (navegaÃ§Ã£o SPA do Blazor)
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.processFiles = processFiles;
window.clearFiles = clearFiles;

console.log("âœ… Script itau-cash2.js carregado completamente");


----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\itau-movimentacao.js
----------------------------------------

// ================================================================
// ITAÃš MOVIMENTAÃ‡ÃƒO - Script de Upload Simplificado
// ================================================================
// Este arquivo usa o sistema compartilhado PdfUploadHandler
// Apenas define a lÃ³gica especÃ­fica do ItaÃº MovimentaÃ§Ã£o
// ================================================================

console.log("ðŸŸ¢ ItaÃº MovimentaÃ§Ã£o - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl() {
  return window.PdfProcessorConfig.getEndpoint("/api/itaumovimentacao/batch");
}

// ============================================================
// UI FUNCTIONS
// ============================================================

function showMessage(message, type = "info") {
  const statusMessage = document.getElementById("statusMessage");
  if (!statusMessage) return;

  statusMessage.textContent = message;
  statusMessage.className = `alert alert-${type}`;
  statusMessage.style.display = "block";

  if (type === "success" || type === "error") {
    setTimeout(() => {
      statusMessage.style.display = "none";
    }, 5000);
  }
}

function showLoading(show, text = "Processando...") {
  const loading = document.getElementById("loadingIndicator");
  const loadingText = document.getElementById("loadingText");
  const actionButtons = document.getElementById("actionButtons");

  if (loading) {
    loading.style.display = show ? "flex" : "none";
  }

  if (loadingText && text) {
    loadingText.textContent = text;
  }

  if (actionButtons) {
    actionButtons.style.display = show ? "none" : "flex";
  }
}

function formatFileSize(bytes) {
  if (bytes === 0) return "0 B";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
}

function updateUI() {
  const filesSelected = document.getElementById("filesSelected");
  const filesList = document.getElementById("filesList");
  const filesSummary = document.getElementById("filesSummary");
  const actionButtons = document.getElementById("actionButtons");
  const processBtn = document.getElementById("processBtn");

  if (!filesSelected || !filesList || !actionButtons) return;

  if (selectedFiles.length === 0) {
    filesSelected.style.display = "none";
    actionButtons.style.display = "none";
    return;
  }

  // Mostrar lista de arquivos
  filesSelected.style.display = "block";
  actionButtons.style.display = "flex";

  // Renderizar lista
  filesList.innerHTML = selectedFiles
    .map(
      (file, index) => `
    <div class="file-item">
      <span class="file-icon">ðŸ“„</span>
      <span class="file-name">${file.name}</span>
      <span class="file-size">${formatFileSize(file.size)}</span>
    </div>
  `,
    )
    .join("");

  // Atualizar resumo
  if (filesSummary) {
    const totalSize = selectedFiles.reduce((sum, f) => sum + f.size, 0);
    filesSummary.textContent = `Total: ${selectedFiles.length} arquivo(s) â€¢ ${formatFileSize(totalSize)}`;
  }

  // Habilitar botÃ£o de processar
  if (processBtn) {
    processBtn.disabled = false;
  }
}

// ============================================================
// FILE MANAGEMENT
// ============================================================

function clearFiles() {
  console.log("ðŸ—‘ï¸ Limpando todos os arquivos");
  selectedFiles = [];
  updateUI();
  showMessage("", "info"); // Limpar mensagens
}

// ============================================================
// CALLBACK DE ARQUIVOS SELECIONADOS
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Adicionar arquivos vÃ¡lidos
  selectedFiles = validFiles;

  // Mostrar erros se houver
  if (errors.length > 0) {
    showMessage(errors[0], "error");
  } else if (validFiles.length > 0) {
    showMessage(`${validFiles.length} arquivo(s) selecionado(s)`, "success");
  }

  // Atualizar interface
  updateUI();
}

// ============================================================
// PROCESSAR ARQUIVOS
// ============================================================

async function processFiles() {
  if (selectedFiles.length === 0) {
    showMessage("Nenhum arquivo selecionado", "error");
    return;
  }

  console.log(
    "ðŸš€ Iniciando processamento de",
    selectedFiles.length,
    "arquivo(s)",
  );

  showLoading(
    true,
    `Processando ${selectedFiles.length} extrato(s) do ItaÃº...`,
  );
  showMessage("", "info"); // Limpar mensagens anteriores

  try {
    // Criar FormData
    const formData = new FormData();
    selectedFiles.forEach((file) => {
      formData.append("files", file);
    });

    console.log("ðŸ“¤ Enviando para API:", getApiUrl());

    // Fazer requisiÃ§Ã£o
    const response = await fetch(getApiUrl(), {
      method: "POST",
      body: formData,
      mode: "cors",
    });

    console.log("ðŸ“¥ Resposta recebida:", response.status, response.statusText);

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro ${response.status}: ${errorText}`);
    }

    // Download do arquivo Excel
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;

    const timestamp = new Date()
      .toISOString()
      .slice(0, 19)
      .replace(/[-:]/g, "")
      .replace("T", "_");
    a.download = `movimentacao_itau_${timestamp}.xlsx`;

    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
    document.body.removeChild(a);

    console.log("âœ… Download iniciado com sucesso");

    showMessage(
      "âœ… Processamento concluÃ­do! Excel gerado e baixado.",
      "success",
    );

    // Limpar arquivos apÃ³s sucesso
    setTimeout(() => clearFiles(), 2000);
  } catch (error) {
    console.error("âŒ Erro no processamento:", error);
    showMessage(`Erro: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

// Tornar funÃ§Ã£o disponÃ­vel globalmente para reinicializaÃ§Ã£o
window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando ItaÃº MovimentaÃ§Ã£o Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024, // 16MB
    allowMultiple: true,
    debug: true,
  });
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  // DOM jÃ¡ carregado (navegaÃ§Ã£o SPA do Blazor)
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.processFiles = processFiles;
window.clearFiles = clearFiles;

console.log("âœ… Script itau-movimentacao.js carregado completamente");



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\merge-pdf.js
----------------------------------------

// ================================================================
// MERGE PDF - Script Simplificado
// ================================================================
// Usa sistema compartilhado para upload bÃ¡sico
// MantÃ©m lÃ³gica complexa de page ranges, reordenaÃ§Ã£o e validaÃ§Ã£o
// ================================================================

console.log("ðŸŸ¢ MergePDF - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];
let filePageCounts = {};
let filePageRanges = {};

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl(endpoint = "/batch") {
  return window.PdfProcessorConfig.getEndpoint(`/api/mergepdf${endpoint}`);
}

// ============================================================
// PAGE COUNT (via API)
// ============================================================

async function getPageCount(file) {
  try {
    const formData = new FormData();
    formData.append("file", file);

    const response = await fetch(getApiUrl("/pagecount"), {
      method: "POST",
      body: formData,
      mode: "cors",
    });

    if (response.ok) {
      const data = await response.json();
      return data.pageCount || "?";
    } else {
      console.warn(`âš ï¸ NÃ£o foi possÃ­vel contar pÃ¡ginas de ${file.name}`);
      return "?";
    }
  } catch (error) {
    console.error("âŒ Erro ao contar pÃ¡ginas:", error);
    return "?";
  }
}

// ============================================================
// FILE PROCESSING
// ============================================================

async function processFiles(files) {
  console.log(`\nðŸ“‚ Processando ${files.length} arquivo(s)`);

  selectedFiles = [];
  filePageCounts = {};
  filePageRanges = {};

  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    console.log(
      `\nðŸ“„ Processando arquivo ${i + 1}/${files.length}: ${file.name}`,
    );

    // Contar pÃ¡ginas do PDF
    const pageCount = await getPageCount(file);

    selectedFiles.push(file);
    filePageCounts[i] = pageCount;
    filePageRanges[i] = `1-${pageCount}`; // Range padrÃ£o: todas as pÃ¡ginas

    console.log(`âœ… Arquivo adicionado: ${file.name} (${pageCount} pÃ¡ginas)`);
  }

  console.log(`\nðŸŽ¨ Renderizando lista com ${selectedFiles.length} arquivos`);
  renderFilesList();
  updateMergeInfo();
}

// ============================================================
// CALLBACK DO SISTEMA COMPARTILHADO
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Mostrar erros se houver
  if (errors.length > 0) {
    showMessage(errors[0], "error");
  }

  // Processar arquivos vÃ¡lidos
  if (validFiles.length > 0) {
    processFiles(validFiles);
  }
}

// ============================================================
// RENDERIZAÃ‡ÃƒO DA LISTA
// ============================================================

function renderFilesList() {
  const filesArea = document.getElementById("filesArea");
  const counter = document.getElementById("fileCounter");
  const actionButtons = document.getElementById("actionButtons");

  if (selectedFiles.length === 0) {
    filesArea.innerHTML = "";
    counter.style.display = "none";
    actionButtons.style.display = "none";
    return;
  }

  counter.style.display = "block";
  actionButtons.style.display = "flex";

  filesArea.innerHTML = selectedFiles
    .map(
      (file, index) => `
    <div class="file-item" data-index="${index}">
      <div class="file-header">
        <div class="file-info">
          <div class="file-number">${index + 1}</div>
          <div class="file-details">
            <div class="file-name">${file.name}</div>
            <div class="file-meta">
              <span>ðŸ“„ ${filePageCounts[index]} pÃ¡gina(s)</span>
              <span>ðŸ’¾ ${formatFileSize(file.size)}</span>
            </div>
          </div>
        </div>
        <div class="file-actions">
          <button class="btn-icon" 
                  onclick="moveFile(${index}, 'up')" 
                  ${index === 0 ? "disabled" : ""}
                  title="Mover para cima">
            â†‘
          </button>
          <button class="btn-icon" 
                  onclick="moveFile(${index}, 'down')" 
                  ${index === selectedFiles.length - 1 ? "disabled" : ""}
                  title="Mover para baixo">
            â†“
          </button>
          <button class="btn-icon btn-delete" 
                  onclick="removeFile(${index})"
                  title="Remover arquivo">
            ðŸ—‘ï¸
          </button>
        </div>
      </div>
      
      <div class="page-range-section">
        <label class="page-range-label">PÃ¡ginas a incluir:</label>
        <input type="text" 
               class="page-range-input" 
               id="range-${index}"
               value="${filePageRanges[index]}"
               onchange="updatePageRange(${index}, this.value)"
               onblur="validatePageRange(${index}, this.value)"
               placeholder="Ex: 1-3, 1,3,5, ou 1-5,9" />
        <div class="page-range-hint">
          Exemplos: "1,3,5" (pÃ¡ginas especÃ­ficas), "1-5" (intervalo), "1,3-6,9" (misto)
        </div>
        <div class="range-error" id="range-error-${index}"></div>
      </div>
    </div>
  `,
    )
    .join("");

  console.log("âœ… Lista renderizada");
}

function formatFileSize(bytes) {
  if (bytes === 0) return "0 B";
  const k = 1024;
  const sizes = ["B", "KB", "MB", "GB"];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
}

// ============================================================
// PAGE RANGE MANAGEMENT
// ============================================================

function updatePageRange(index, range) {
  filePageRanges[index] = range;
  console.log(`ðŸ“„ Range atualizado para arquivo ${index}: ${range}`);
}

function validatePageRange(index, range) {
  const input = document.getElementById(`range-${index}`);
  const errorDiv = document.getElementById(`range-error-${index}`);
  const maxPages = filePageCounts[index];

  // Limpar erro
  input.classList.remove("error");
  errorDiv.style.display = "none";

  if (!range.trim()) {
    showRangeError(index, "Range de pÃ¡ginas nÃ£o pode estar vazio");
    return false;
  }

  try {
    parsePageRange(range, maxPages);
    console.log(`âœ… Range vÃ¡lido para arquivo ${index}`);
    return true;
  } catch (error) {
    showRangeError(index, error.message);
    return false;
  }
}

function showRangeError(index, message) {
  const input = document.getElementById(`range-${index}`);
  const errorDiv = document.getElementById(`range-error-${index}`);

  input.classList.add("error");
  errorDiv.textContent = message;
  errorDiv.style.display = "block";
}

function parsePageRange(range, maxPages) {
  const parts = range.split(",");

  for (let part of parts) {
    part = part.trim();

    if (part.includes("-")) {
      const [start, end] = part.split("-").map((n) => parseInt(n.trim()));

      if (isNaN(start) || isNaN(end)) {
        throw new Error(`Range invÃ¡lido: "${part}"`);
      }

      if (start > end) {
        throw new Error(
          `Range invÃ¡lido: inÃ­cio (${start}) maior que fim (${end})`,
        );
      }

      if (maxPages !== "?" && (start > maxPages || end > maxPages)) {
        throw new Error(`PÃ¡gina fora do limite: mÃ¡ximo Ã© ${maxPages}`);
      }
    } else {
      const pageNum = parseInt(part);

      if (isNaN(pageNum) || pageNum < 1) {
        throw new Error(`NÃºmero de pÃ¡gina invÃ¡lido: "${part}"`);
      }

      if (maxPages !== "?" && pageNum > maxPages) {
        throw new Error(
          `PÃ¡gina ${pageNum} fora do limite: mÃ¡ximo Ã© ${maxPages}`,
        );
      }
    }
  }

  return true;
}

// ============================================================
// FILE REORDERING
// ============================================================

function moveFile(index, direction) {
  if (direction === "up" && index > 0) {
    [selectedFiles[index], selectedFiles[index - 1]] = [
      selectedFiles[index - 1],
      selectedFiles[index],
    ];
    [filePageCounts[index], filePageCounts[index - 1]] = [
      filePageCounts[index - 1],
      filePageCounts[index],
    ];
    [filePageRanges[index], filePageRanges[index - 1]] = [
      filePageRanges[index - 1],
      filePageRanges[index],
    ];

    renderFilesList();
    console.log(`ðŸ”¼ Arquivo movido para cima: posiÃ§Ã£o ${index + 1} â†’ ${index}`);
  } else if (direction === "down" && index < selectedFiles.length - 1) {
    [selectedFiles[index], selectedFiles[index + 1]] = [
      selectedFiles[index + 1],
      selectedFiles[index],
    ];
    [filePageCounts[index], filePageCounts[index + 1]] = [
      filePageCounts[index + 1],
      filePageCounts[index],
    ];
    [filePageRanges[index], filePageRanges[index + 1]] = [
      filePageRanges[index + 1],
      filePageRanges[index],
    ];

    renderFilesList();
    console.log(
      `ðŸ”½ Arquivo movido para baixo: posiÃ§Ã£o ${index + 1} â†’ ${index + 2}`,
    );
  }
}

function removeFile(index) {
  const fileName = selectedFiles[index].name;
  selectedFiles.splice(index, 1);

  // Reorganizar Ã­ndices
  const newPageCounts = {};
  const newPageRanges = {};

  let newIndex = 0;
  for (let i = 0; i < selectedFiles.length + 1; i++) {
    if (i !== index) {
      newPageCounts[newIndex] = filePageCounts[i];
      newPageRanges[newIndex] = filePageRanges[i];
      newIndex++;
    }
  }

  filePageCounts = newPageCounts;
  filePageRanges = newPageRanges;

  renderFilesList();
  updateMergeInfo();
  console.log(`ðŸ—‘ï¸ Arquivo removido: ${fileName}`);
}

// ============================================================
// UI UPDATE
// ============================================================

function updateMergeInfo() {
  const counterText = document.getElementById("counterText");
  const mergeBtn = document.getElementById("mergeBtn");

  const count = selectedFiles.length;

  if (counterText) {
    counterText.textContent = `Arquivos selecionados: ${count}`;
  }

  if (mergeBtn) {
    mergeBtn.disabled = count < 2;

    if (count < 2) {
      mergeBtn.textContent = "ðŸ”— Selecione pelo menos 2 PDFs";
    } else {
      mergeBtn.textContent = "ðŸ”— Mesclar PDFs";
    }
  }
}

// ============================================================
// MERGE EXECUTION
// ============================================================

async function mergePdfs() {
  if (selectedFiles.length < 2) {
    showMessage("Selecione pelo menos 2 PDFs para mesclar", "error");
    return;
  }

  // Validar todos os ranges
  let allValid = true;
  for (let i = 0; i < selectedFiles.length; i++) {
    if (!validatePageRange(i, filePageRanges[i])) {
      allValid = false;
    }
  }

  if (!allValid) {
    showMessage("Por favor, corrija os erros nos ranges de pÃ¡ginas", "error");
    return;
  }

  console.log(`\nðŸ”— Iniciando mesclagem de ${selectedFiles.length} arquivos`);

  showLoading(true, `Mesclando ${selectedFiles.length} PDFs...`);

  try {
    const formData = new FormData();

    // Adicionar arquivos na ordem
    for (let i = 0; i < selectedFiles.length; i++) {
      formData.append("files", selectedFiles[i]);
      formData.append("pageRanges", filePageRanges[i]);
    }

    console.log("ðŸ“¡ Enviando para API...");
    const response = await fetch(getApiUrl("/batch"), {
      method: "POST",
      body: formData,
      mode: "cors",
    });

    console.log(
      `ðŸ“Š Resposta da API: ${response.status} ${response.statusText}`,
    );

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro na API: ${response.status} - ${errorText}`);
    }

    // Download do arquivo
    const blob = await response.blob();
    const timestamp = new Date()
      .toISOString()
      .slice(0, 19)
      .replace(/[-:]/g, "")
      .replace("T", "_");
    const fileName = `pdf_mesclado_${timestamp}.pdf`;

    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
    document.body.removeChild(a);

    console.log(`âœ… Download iniciado: ${fileName}`);
    showMessage(
      `âœ… ${selectedFiles.length} PDFs mesclados com sucesso!`,
      "success",
    );

    // Limpar apÃ³s 2 segundos
    setTimeout(clearAllFiles, 2000);
  } catch (error) {
    console.error("âŒ Erro ao mesclar:", error);
    showMessage(`âŒ Erro ao mesclar: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// CLEAR
// ============================================================

function clearAllFiles() {
  selectedFiles = [];
  filePageCounts = {};
  filePageRanges = {};

  const fileInput = document.getElementById("fileInput");
  if (fileInput) {
    fileInput.value = "";
  }

  renderFilesList();
  updateMergeInfo();
  showMessage("", "");
  console.log("ðŸ—‘ï¸ Todos os arquivos removidos");
}

// ============================================================
// UI HELPERS
// ============================================================

function showLoading(show, text = "Processando...") {
  const loading = document.getElementById("loadingIndicator");
  const loadingText = document.getElementById("loadingText");

  if (loading) {
    loading.style.display = show ? "block" : "none";
  }

  if (loadingText && text) {
    loadingText.textContent = text;
  }
}

function showMessage(message, type = "info") {
  const statusMessage = document.getElementById("statusMessage");

  if (!message) {
    statusMessage.style.display = "none";
    return;
  }

  statusMessage.textContent = message;
  statusMessage.className = `alert alert-${type}`;
  statusMessage.style.display = "block";
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando Merge PDF Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024,
    allowMultiple: true,
    debug: true,
  });
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.mergePdfs = mergePdfs;
window.clearAllFiles = clearAllFiles;
window.moveFile = moveFile;
window.removeFile = removeFile;
window.updatePageRange = updatePageRange;
window.validatePageRange = validatePageRange;

console.log("âœ… Script merge-pdf.js carregado completamente");



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\morgan-stanley.js
----------------------------------------

// ================================================================
// MORGAN STANLEY - Script de Upload Simplificado
// ================================================================
// Este arquivo usa o sistema compartilhado PdfUploadHandler
// Apenas define a lÃ³gica especÃ­fica do Morgan Stanley
// ================================================================

console.log("ðŸŸ¢ Morgan Stanley - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl() {
  return window.PdfProcessorConfig.getEndpoint("/api/morgan-stanley/batch");
}

// ============================================================
// UI FUNCTIONS ESPECÃFICAS DO MORGAN
// ============================================================

function showLoading() {
  document.getElementById("loadingSection").style.display = "block";
  document.getElementById("resultSection").style.display = "none";
  document.getElementById("errorSection").style.display = "none";
  document.getElementById("fileList").style.display = "none";
}

function hideLoading() {
  document.getElementById("loadingSection").style.display = "none";
}

function showSuccess(filename, url) {
  document.getElementById("resultMessage").textContent =
    `Arquivo gerado: ${filename}`;
  document.getElementById("downloadLink").href = url;
  document.getElementById("downloadLink").download = filename;
  document.getElementById("resultSection").style.display = "block";
}

function showError(message) {
  document.getElementById("errorMessage").textContent = message;
  document.getElementById("errorSection").style.display = "block";
}

function updateUI() {
  const fileList = document.getElementById("fileList");
  const fileListContent = document.getElementById("fileListContent");

  if (selectedFiles.length === 0) {
    fileList.style.display = "none";
    return;
  }

  // Renderizar lista
  let html = "<ul>";
  selectedFiles.forEach((file) => {
    html += `<li>ðŸ“„ ${file.name} (${(file.size / 1024).toFixed(2)} KB)</li>`;
  });
  html += "</ul>";

  fileListContent.innerHTML = html;
  fileList.style.display = "block";

  console.log(`ðŸ“‹ Mostrando ${selectedFiles.length} arquivo(s)`);
}

// ============================================================
// FILE MANAGEMENT
// ============================================================

function clearFiles() {
  console.log("ðŸ—‘ï¸ Limpando todos os arquivos");
  selectedFiles = [];
  updateUI();

  // Esconder sections
  document.getElementById("resultSection").style.display = "none";
  document.getElementById("errorSection").style.display = "none";
}

// ============================================================
// CALLBACK DE ARQUIVOS SELECIONADOS
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Adicionar arquivos vÃ¡lidos
  selectedFiles = validFiles;

  // Mostrar erros se houver
  if (errors.length > 0) {
    showError(errors[0]);
  }

  // Atualizar interface
  updateUI();
}

// ============================================================
// PROCESSAR ARQUIVOS
// ============================================================

async function processFiles() {
  if (selectedFiles.length === 0) {
    showError("Selecione pelo menos um arquivo PDF");
    return;
  }

  console.log(
    "ðŸš€ Iniciando processamento de",
    selectedFiles.length,
    "arquivo(s)",
  );

  showLoading();

  try {
    // Criar FormData
    const formData = new FormData();
    selectedFiles.forEach((file, index) => {
      formData.append("files", file);
      console.log(`ðŸ“Ž Arquivo ${index + 1} adicionado: ${file.name}`);
    });

    console.log("ðŸ“¤ Enviando para API:", getApiUrl());

    // Fazer requisiÃ§Ã£o
    const response = await fetch(getApiUrl(), {
      method: "POST",
      body: formData,
    });

    console.log("ðŸ“¥ Resposta recebida:", response.status, response.statusText);

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro ${response.status}: ${errorText}`);
    }

    // Download do arquivo Excel
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);

    // Tentar extrair filename do header
    const filename =
      response.headers.get("content-disposition")?.split("filename=")[1] ||
      `morgan_stanley_${new Date().toISOString().split("T")[0]}.xlsx`;

    console.log("âœ… Sucesso! Arquivo:", filename);

    showSuccess(filename, url);
  } catch (error) {
    console.error("âŒ Erro no processamento:", error);
    showError(error.message);
  } finally {
    hideLoading();
  }
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

// Tornar funÃ§Ã£o disponÃ­vel globalmente para reinicializaÃ§Ã£o
window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando Morgan Stanley Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024, // 16MB
    allowMultiple: true,
    debug: true,
  });

  // Adicionar listener ao botÃ£o processar
  const processBtn = document.getElementById("processBtn");
  if (processBtn) {
    processBtn.addEventListener("click", processFiles);
    console.log("âœ… BotÃ£o processar configurado");
  }
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  // DOM jÃ¡ carregado (navegaÃ§Ã£o SPA do Blazor)
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.processFiles = processFiles;
window.clearFiles = clearFiles;

console.log("âœ… Script morgan-stanley.js carregado completamente");



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\pdf-upload-handler.js
----------------------------------------

// ================================================================
// PDF UPLOAD HANDLER - Sistema Universal de Drag & Drop
// ================================================================
// Sistema robusto de upload de PDFs que funciona perfeitamente com:
// - Blazor SPA navigation
// - MÃºltiplas pÃ¡ginas
// - Recarregamento de pÃ¡gina
// - NavegaÃ§Ã£o entre rotas
// ================================================================

window.PdfUploadHandler = (function () {
  "use strict";

  // ============================================================
  // ESTADO PRIVADO
  // ============================================================

  let config = {
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: null,
    maxFileSize: 16 * 1024 * 1024, // 16MB
    allowMultiple: true,
    debug: true,
  };

  let listeners = []; // Guardar referÃªncias para cleanup

  // ============================================================
  // LOGGING
  // ============================================================

  function log(...args) {
    if (config.debug) {
      console.log("[PdfUploadHandler]", ...args);
    }
  }

  function error(...args) {
    console.error("[PdfUploadHandler]", ...args);
  }

  // ============================================================
  // CLEANUP - Remove todos os listeners anteriores
  // ============================================================

  function cleanup() {
    log("ðŸ§¹ Limpando listeners antigos...");

    listeners.forEach((item) => {
      item.element.removeEventListener(item.event, item.handler);
    });

    listeners = [];
    log("âœ… Cleanup concluÃ­do");
  }

  // ============================================================
  // ADICIONAR LISTENER COM TRACKING
  // ============================================================

  function addTrackedListener(element, event, handler) {
    element.addEventListener(event, handler);
    listeners.push({ element, event, handler });
  }

  // ============================================================
  // VALIDAÃ‡ÃƒO DE ARQUIVOS
  // ============================================================

  function validateFile(file) {
    // Validar tipo
    if (!file.name.toLowerCase().endsWith(".pdf")) {
      return { valid: false, error: "Apenas arquivos PDF sÃ£o permitidos" };
    }

    // Validar tamanho
    if (file.size > config.maxFileSize) {
      const maxMB = (config.maxFileSize / (1024 * 1024)).toFixed(0);
      return { valid: false, error: `Arquivo ${file.name} excede ${maxMB}MB` };
    }

    // Validar que nÃ£o estÃ¡ vazio
    if (file.size === 0) {
      return { valid: false, error: `Arquivo ${file.name} estÃ¡ vazio` };
    }

    return { valid: true };
  }

  // ============================================================
  // PROCESSAR ARQUIVOS
  // ============================================================

  function processFiles(files) {
    log("ðŸ“‚ Processando arquivos...", files);

    if (!files || files.length === 0) {
      log("âš ï¸ Nenhum arquivo recebido");
      return;
    }

    const validFiles = [];
    const errors = [];

    // Validar cada arquivo
    for (let i = 0; i < files.length; i++) {
      const file = files[i];
      const validation = validateFile(file);

      if (validation.valid) {
        validFiles.push(file);
        log(
          `âœ… Arquivo vÃ¡lido: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`,
        );
      } else {
        errors.push(validation.error);
        error(`âŒ ${validation.error}`);
      }
    }

    // Chamar callback com resultados
    if (config.onFilesSelected) {
      config.onFilesSelected(validFiles, errors);
    }
  }

  // ============================================================
  // DRAG & DROP HANDLERS
  // ============================================================

  function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
  }

  function handleDragEnter(e, uploadArea) {
    preventDefaults(e);
    uploadArea.classList.add("drag-over");
  }

  function handleDragOver(e) {
    preventDefaults(e);
  }

  function handleDragLeave(e, uploadArea) {
    preventDefaults(e);
    uploadArea.classList.remove("drag-over");
  }

  function handleDrop(e, uploadArea) {
    preventDefaults(e);
    uploadArea.classList.remove("drag-over");

    log("ðŸ“ Arquivos arrastados");
    const files = e.dataTransfer.files;
    processFiles(files);
  }

  // ============================================================
  // FILE INPUT HANDLER
  // ============================================================

  function handleFileInputChange(e) {
    log("ðŸ“ Arquivos selecionados via input");
    const files = e.target.files;
    processFiles(files);

    // Limpar input para permitir selecionar o mesmo arquivo novamente
    e.target.value = "";
  }

  // ============================================================
  // SETUP DO DRAG & DROP
  // ============================================================

  function setupDragAndDrop(uploadArea, fileInput) {
    log("ðŸ”§ Configurando Drag & Drop...");

    // âœ… CRITICAL FIX: Desabilitar pointer events nos elementos filhos
    // Isso evita que Ã­cones e textos bloqueiem o drag & drop
    const children = uploadArea.querySelectorAll("*");
    children.forEach((child) => {
      child.style.pointerEvents = "none";
    });
    log(
      `âœ… Desabilitados pointer-events em ${children.length} elementos filhos`,
    );

    // Prevenir comportamento padrÃ£o em toda a pÃ¡gina
    const preventDefaultsHandler = (e) => preventDefaults(e);
    addTrackedListener(document.body, "dragenter", preventDefaultsHandler);
    addTrackedListener(document.body, "dragover", preventDefaultsHandler);
    addTrackedListener(document.body, "dragleave", preventDefaultsHandler);
    addTrackedListener(document.body, "drop", preventDefaultsHandler);

    // Handlers especÃ­ficos da Ã¡rea de upload
    addTrackedListener(uploadArea, "dragenter", (e) =>
      handleDragEnter(e, uploadArea),
    );
    addTrackedListener(uploadArea, "dragover", handleDragOver);
    addTrackedListener(uploadArea, "dragleave", (e) =>
      handleDragLeave(e, uploadArea),
    );
    addTrackedListener(uploadArea, "drop", (e) => handleDrop(e, uploadArea));

    // Click para abrir seletor de arquivo
    const clickHandler = (e) => {
      e.preventDefault();
      e.stopPropagation();
      log("ðŸ–±ï¸ Upload area clicada");
      fileInput.click();
    };
    addTrackedListener(uploadArea, "click", clickHandler);

    // Change do input
    addTrackedListener(fileInput, "change", handleFileInputChange);

    log("âœ… Drag & Drop configurado com sucesso");
  }

  // ============================================================
  // FUNÃ‡ÃƒO PRINCIPAL DE INICIALIZAÃ‡ÃƒO
  // ============================================================

  function waitForElements(callback, maxAttempts = 20, interval = 100) {
    let attempts = 0;

    function check() {
      attempts++;

      const uploadArea = document.getElementById(config.uploadAreaId);
      const fileInput = document.getElementById(config.fileInputId);

      if (uploadArea && fileInput) {
        log("âœ… Elementos encontrados:", { uploadArea, fileInput });
        callback(uploadArea, fileInput);
        return true;
      }

      if (attempts >= maxAttempts) {
        error(
          `âŒ Timeout: Elementos nÃ£o encontrados apÃ³s ${maxAttempts} tentativas`,
        );
        error(
          `   Procurando por: #${config.uploadAreaId}, #${config.fileInputId}`,
        );
        return false;
      }

      log(`â³ Tentativa ${attempts}/${maxAttempts} - Aguardando elementos...`);
      setTimeout(check, interval);
    }

    check();
  }

  function initialize(options = {}) {
    log("ðŸš€ Inicializando PDF Upload Handler...");

    // Fazer cleanup de inicializaÃ§Ãµes anteriores
    cleanup();

    // Atualizar configuraÃ§Ã£o
    config = { ...config, ...options };

    // Validar callback obrigatÃ³rio
    if (typeof config.onFilesSelected !== "function") {
      error("âŒ ERRO: onFilesSelected callback Ã© obrigatÃ³rio!");
      return false;
    }

    // Aguardar elementos no DOM (necessÃ¡rio para Blazor SPA)
    waitForElements((uploadArea, fileInput) => {
      setupDragAndDrop(uploadArea, fileInput);
      log("ðŸŽ‰ Sistema inicializado com sucesso!");
    });

    return true;
  }

  // ============================================================
  // INTERFACE PÃšBLICA
  // ============================================================

  return {
    init: initialize,
    cleanup: cleanup,

    // Utility para reconfigurar
    setDebug: function (enabled) {
      config.debug = enabled;
    },
  };
})();

// ============================================================
// AUTO-INICIALIZAÃ‡ÃƒO PARA BLAZOR
// ============================================================
// Este cÃ³digo detecta quando o Blazor termina de renderizar
// e reinicializa o handler automaticamente
// ============================================================

(function () {
  "use strict";

  let blazorInitialized = false;

  // Detectar enhanced navigation do Blazor
  if (window.Blazor) {
    console.log(
      "[PdfUploadHandler] ðŸ”µ Blazor detectado - configurando listeners...",
    );

    // Blazor 8+ usa este evento
    window.addEventListener("enhancedload", function () {
      console.log("[PdfUploadHandler] ðŸ”„ Blazor enhanced navigation detectada");

      // Dar tempo para o DOM atualizar
      setTimeout(function () {
        if (window.initializePdfUpload) {
          console.log(
            "[PdfUploadHandler] ðŸ”„ Reinicializando apÃ³s navegaÃ§Ã£o...",
          );
          window.initializePdfUpload();
        }
      }, 100);
    });
  }

  // Fallback para navegaÃ§Ã£o tradicional
  document.addEventListener("DOMContentLoaded", function () {
    console.log("[PdfUploadHandler] ðŸ“„ DOMContentLoaded disparado");
    blazorInitialized = true;
  });

  // Fallback adicional
  window.addEventListener("load", function () {
    if (!blazorInitialized) {
      console.log(
        "[PdfUploadHandler] ðŸ”„ Window load - inicializaÃ§Ã£o de seguranÃ§a",
      );
    }
  });
})();



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\rotate-pdf.js
----------------------------------------

// ================================================================
// ROTATE PDF - Script Simplificado
// ================================================================
// Usa sistema compartilhado para upload bÃ¡sico
// MantÃ©m lÃ³gica especÃ­fica de thumbnails, rotaÃ§Ã£o e grid
// ================================================================

console.log("ðŸŸ¢ RotatePDF - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let pdfFiles = [];
let selectedFiles = new Set();
let nextFileId = 1;

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl(endpoint = "/batch") {
  return window.PdfProcessorConfig.getEndpoint(`/api/rotatepdf${endpoint}`);
}

// ============================================================
// THUMBNAIL GENERATION
// ============================================================

async function generateThumbnail(file) {
  try {
    const formData = new FormData();
    formData.append("file", file);

    const response = await fetch(getApiUrl("/thumbnail"), {
      method: "POST",
      body: formData,
      mode: "cors",
    });

    if (!response.ok) {
      throw new Error("Erro ao gerar miniatura");
    }

    const data = await response.json();
    return data.thumbnail;
  } catch (error) {
    console.error("Erro ao gerar thumbnail:", error);
    return null;
  }
}

// ============================================================
// FILE PROCESSING (ESPECÃFICO)
// ============================================================

async function processFiles(files) {
  if (!files || files.length === 0) return;

  showLoading(true, "Carregando arquivos e gerando miniaturas...");

  let processedCount = 0;

  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    console.log(`ðŸ“„ Processando: ${file.name}`);

    // Gerar miniatura via API
    const thumbnail = await generateThumbnail(file);

    // Adicionar Ã  lista
    pdfFiles.push({
      id: nextFileId++,
      file: file,
      name: file.name,
      size: file.size,
      rotation: 0,
      thumbnail: thumbnail,
    });

    processedCount++;
  }

  // Atualizar UI
  renderPdfGrid();
  updateUI();
  showLoading(false);

  if (processedCount > 0) {
    showMessage(
      `âœ… ${processedCount} arquivo(s) carregado(s) com sucesso!`,
      "success",
    );
  }
}

// ============================================================
// CALLBACK DO SISTEMA COMPARTILHADO
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Mostrar erros se houver
  if (errors.length > 0) {
    showMessage(errors[0], "error");
  }

  // Processar arquivos vÃ¡lidos
  if (validFiles.length > 0) {
    processFiles(validFiles);
  }
}

// ============================================================
// PDF GRID RENDERING
// ============================================================

function renderPdfGrid() {
  const grid = document.getElementById("pdfGrid");
  grid.innerHTML = "";

  pdfFiles.forEach((pdf) => {
    const isSelected = selectedFiles.has(pdf.id);
    const card = document.createElement("div");
    card.className = `pdf-card ${isSelected ? "selected" : ""}`;
    card.onclick = () => toggleSelection(pdf.id);

    const thumbnailHtml = pdf.thumbnail
      ? `<img src="${pdf.thumbnail}" style="transform: rotate(${pdf.rotation}deg);" alt="${pdf.name}" />`
      : `<div class="pdf-icon" style="transform: rotate(${pdf.rotation}deg);">ðŸ“„</div>`;

    card.innerHTML = `
      <div class="pdf-checkbox">
        <input type="checkbox" ${isSelected ? "checked" : ""} readonly />
      </div>
      <div class="pdf-thumbnail">
        ${thumbnailHtml}
      </div>
      <div class="pdf-info">
        <div class="pdf-name" title="${pdf.name}">${pdf.name}</div>
        <div class="pdf-size">${formatFileSize(pdf.size)}</div>
        ${pdf.rotation !== 0 ? `<span class="rotation-badge">${pdf.rotation}Â°</span>` : ""}
      </div>
    `;

    grid.appendChild(card);
  });
}

function formatFileSize(bytes) {
  if (bytes < 1024) return bytes + " B";
  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + " KB";
  return (bytes / 1024 / 1024).toFixed(1) + " MB";
}

// ============================================================
// SELECTION MANAGEMENT
// ============================================================

function toggleSelection(fileId) {
  if (selectedFiles.has(fileId)) {
    selectedFiles.delete(fileId);
  } else {
    selectedFiles.add(fileId);
  }
  renderPdfGrid();
  updateSelectAllButton();
}

function toggleSelectAll() {
  if (selectedFiles.size === pdfFiles.length) {
    selectedFiles.clear();
  } else {
    pdfFiles.forEach((pdf) => selectedFiles.add(pdf.id));
  }
  renderPdfGrid();
  updateSelectAllButton();
}

function updateSelectAllButton() {
  const btn = document.getElementById("selectAllText");
  if (!btn) return;

  const text =
    selectedFiles.size === pdfFiles.length
      ? "Desmarcar Todos"
      : "âœ“ Selecionar Todos";
  btn.textContent = text;
}

// ============================================================
// ROTATION
// ============================================================

function rotateSelected(degrees) {
  let rotatedCount = 0;
  pdfFiles.forEach((pdf) => {
    if (selectedFiles.has(pdf.id)) {
      pdf.rotation = (pdf.rotation + degrees) % 360;
      if (pdf.rotation < 0) pdf.rotation += 360;
      rotatedCount++;
    }
  });

  renderPdfGrid();
  showMessage(`âœ… ${rotatedCount} arquivo(s) rotacionado(s)`, "success");
}

// ============================================================
// DOWNLOAD
// ============================================================

async function processDownload() {
  if (pdfFiles.length === 0) {
    showMessage("âŒ Nenhum arquivo para processar", "error");
    return;
  }

  showLoading(true, "Processando PDFs... Aguarde...");

  try {
    const formData = new FormData();

    // Adicionar arquivos e rotaÃ§Ãµes
    pdfFiles.forEach((pdf) => {
      formData.append("files", pdf.file);
      formData.append("rotations", pdf.rotation.toString());
    });

    // Chamar API
    const response = await fetch(getApiUrl("/batch"), {
      method: "POST",
      body: formData,
      mode: "cors",
    });

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(errorText || "Erro ao processar PDFs");
    }

    // Baixar arquivo
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;

    // Nome do arquivo baseado na resposta
    const contentDisposition = response.headers.get("Content-Disposition");
    let filename = "pdfs_rotacionados.zip";

    if (contentDisposition) {
      const matches = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(
        contentDisposition,
      );
      if (matches != null && matches[1]) {
        filename = matches[1].replace(/['"]/g, "");
      }
    }

    a.download = filename;
    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
    document.body.removeChild(a);

    showMessage("âœ… Download concluÃ­do com sucesso!", "success");
  } catch (error) {
    console.error("Erro no download:", error);
    showMessage(`âŒ Erro: ${error.message}`, "error");
  } finally {
    showLoading(false);
  }
}

// ============================================================
// CLEAR ALL
// ============================================================

function clearAll() {
  if (confirm("Deseja limpar todos os arquivos?")) {
    pdfFiles = [];
    selectedFiles.clear();
    updateUI();
    renderPdfGrid();
    showMessage("ðŸ—‘ï¸ Arquivos limpos", "info");
  }
}

// ============================================================
// UI UPDATE
// ============================================================

function updateUI() {
  const counterText = document.getElementById("counterText");
  const fileCounter = document.getElementById("fileCounter");
  const previewSection = document.getElementById("previewSection");

  const count = pdfFiles.length;

  if (counterText) {
    counterText.textContent = `Arquivos carregados: ${count}`;
  }

  if (fileCounter) {
    fileCounter.style.display = count > 0 ? "block" : "none";
  }

  if (previewSection) {
    previewSection.style.display = count > 0 ? "block" : "none";
  }

  updateSelectAllButton();
}

function showLoading(show, text = "Processando...") {
  const loading = document.getElementById("loadingIndicator");
  const loadingText = document.getElementById("loadingText");

  if (loading) {
    loading.style.display = show ? "block" : "none";
  }

  if (loadingText && text) {
    loadingText.textContent = text;
  }
}

function showMessage(message, type = "info") {
  const statusMessage = document.getElementById("statusMessage");

  if (!message) {
    statusMessage.style.display = "none";
    return;
  }

  statusMessage.textContent = message;
  statusMessage.className = `alert alert-${type}`;
  statusMessage.style.display = "block";

  // Auto-hide apÃ³s 5 segundos (exceto errors)
  if (type !== "error") {
    setTimeout(() => {
      statusMessage.style.display = "none";
    }, 5000);
  }
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando Rotate PDF Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024,
    allowMultiple: true,
    debug: true,
  });
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.toggleSelectAll = toggleSelectAll;
window.rotateSelected = rotateSelected;
window.processDownload = processDownload;
window.clearAll = clearAll;

console.log("âœ… Script rotate-pdf.js carregado completamente");



----------------------------------------
Conteudo do arquivo: C:\PROJETOS\MPCN-SYSTEMS\Extrator-PDF-MS\mpcn-pdf-tools\PdfProcessor.Web\wwwroot\js\ubs.js
----------------------------------------

// ================================================================
// UBS SWITZERLAND - Script de Upload Simplificado
// ================================================================
// Este arquivo usa o sistema compartilhado PdfUploadHandler
// Apenas define a lÃ³gica especÃ­fica do UBS
// ================================================================

console.log("ðŸŸ¢ UBS Switzerland - Script carregado");

// ============================================================
// ESTADO GLOBAL
// ============================================================

let selectedFiles = [];

// ============================================================
// API CONFIGURATION
// ============================================================

function getApiUrl() {
  return window.PdfProcessorConfig.getEndpoint("/api/ubs/batch");
}

// ============================================================
// UI FUNCTIONS ESPECÃFICAS DO UBS
// ============================================================

function showLoading() {
  document.getElementById("loadingSection").style.display = "block";
  document.getElementById("resultSection").style.display = "none";
  document.getElementById("errorSection").style.display = "none";
  document.getElementById("fileList").style.display = "none";
}

function hideLoading() {
  document.getElementById("loadingSection").style.display = "none";
}

function showSuccess(filename, url) {
  document.getElementById("resultMessage").textContent =
    `Arquivo gerado: ${filename}`;
  document.getElementById("downloadLink").href = url;
  document.getElementById("downloadLink").download = filename;
  document.getElementById("resultSection").style.display = "block";
}

function showError(message) {
  document.getElementById("errorMessage").textContent = message;
  document.getElementById("errorSection").style.display = "block";
}

function updateUI() {
  const fileList = document.getElementById("fileList");
  const fileListContent = document.getElementById("fileListContent");

  if (selectedFiles.length === 0) {
    fileList.style.display = "none";
    return;
  }

  // Renderizar lista
  let html = "<ul>";
  selectedFiles.forEach((file) => {
    html += `<li>ðŸ“„ ${file.name} (${(file.size / 1024).toFixed(2)} KB)</li>`;
  });
  html += "</ul>";

  fileListContent.innerHTML = html;
  fileList.style.display = "block";

  console.log(`ðŸ“‹ Mostrando ${selectedFiles.length} arquivo(s)`);
}

// ============================================================
// FILE MANAGEMENT
// ============================================================

function clearFiles() {
  console.log("ðŸ—‘ï¸ Limpando todos os arquivos");
  selectedFiles = [];
  updateUI();

  // Esconder sections
  document.getElementById("resultSection").style.display = "none";
  document.getElementById("errorSection").style.display = "none";
}

// ============================================================
// CALLBACK DE ARQUIVOS SELECIONADOS
// ============================================================

function onFilesSelected(validFiles, errors) {
  console.log("ðŸ“ Callback recebido:", {
    validFiles: validFiles.length,
    errors: errors.length,
  });

  // Adicionar arquivos vÃ¡lidos
  selectedFiles = validFiles;

  // Mostrar erros se houver
  if (errors.length > 0) {
    showError(errors[0]);
  }

  // Atualizar interface
  updateUI();
}

// ============================================================
// PROCESSAR ARQUIVOS
// ============================================================

async function processFiles() {
  if (selectedFiles.length === 0) {
    showError("Selecione pelo menos um arquivo PDF");
    return;
  }

  console.log(
    "ðŸš€ Iniciando processamento de",
    selectedFiles.length,
    "arquivo(s)",
  );

  showLoading();

  try {
    // Criar FormData
    const formData = new FormData();
    selectedFiles.forEach((file, index) => {
      formData.append("files", file);
      console.log(`ðŸ“Ž Arquivo ${index + 1} adicionado: ${file.name}`);
    });

    console.log("ðŸ“¤ Enviando para API:", getApiUrl());

    // Fazer requisiÃ§Ã£o
    const response = await fetch(getApiUrl(), {
      method: "POST",
      body: formData,
    });

    console.log("ðŸ“¥ Resposta recebida:", response.status, response.statusText);

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`Erro ${response.status}: ${errorText}`);
    }

    // Download do arquivo Excel
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);

    // Tentar extrair filename do header
    const filename =
      response.headers.get("content-disposition")?.split("filename=")[1] ||
      `ubs_switzerland_${new Date().toISOString().split("T")[0]}.xlsx`;

    console.log("âœ… Sucesso! Arquivo:", filename);

    showSuccess(filename, url);
  } catch (error) {
    console.error("âŒ Erro no processamento:", error);
    showError(error.message);
  } finally {
    hideLoading();
  }
}

// ============================================================
// INICIALIZAÃ‡ÃƒO
// ============================================================

// Tornar funÃ§Ã£o disponÃ­vel globalmente para reinicializaÃ§Ã£o
window.initializePdfUpload = function () {
  console.log("ðŸ”§ Inicializando UBS Switzerland Upload Handler...");

  window.PdfUploadHandler.init({
    uploadAreaId: "uploadArea",
    fileInputId: "fileInput",
    onFilesSelected: onFilesSelected,
    maxFileSize: 16 * 1024 * 1024, // 16MB
    allowMultiple: true,
    debug: true,
  });

  // Adicionar listener ao botÃ£o processar
  const processBtn = document.getElementById("processBtn");
  if (processBtn) {
    processBtn.addEventListener("click", processFiles);
    console.log("âœ… BotÃ£o processar configurado");
  }
};

// InicializaÃ§Ã£o automÃ¡tica
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", window.initializePdfUpload);
} else {
  // DOM jÃ¡ carregado (navegaÃ§Ã£o SPA do Blazor)
  setTimeout(window.initializePdfUpload, 50);
}

// ============================================================
// FUNÃ‡Ã•ES GLOBAIS (chamadas pelo HTML)
// ============================================================

window.processFiles = processFiles;
window.clearFiles = clearFiles;

console.log("âœ… Script ubs.js carregado completamente");



