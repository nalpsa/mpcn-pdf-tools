@page "/itau-cash"
@page "/itau"

<PageTitle>ItaÃº - Cash Transactions - PDF Processor</PageTitle>

<div class="page-container">
  <div class="page-header">
    <div class="header-icon">ğŸ¦</div>
    <div>
      <h1>ItaÃº - Cash Transactions</h1>
      <p class="subtitle">ExtraÃ§Ã£o de transaÃ§Ãµes em mÃºltiplas moedas</p>
    </div>
  </div>

  <div class="content-card">
    <div class="info-box info">
      <div class="info-icon">ğŸ’±</div>
      <div>
        <strong>ExtraÃ§Ã£o de Cash Transactions:</strong>
        <p style="margin: 0.5rem 0 0 0; color: #666;">
          O sistema detecta automaticamente <strong>mÃºltiplas contas no mesmo PDF</strong> (USD, EUR, BRL, etc.), 
          criando uma <strong>aba separada</strong> para cada conta no arquivo Excel final.
        </p>
      </div>
    </div>

    <div class="info-box warning">
      <div class="info-icon">âš ï¸</div>
      <div>
        <strong>Melhorias Implementadas:</strong>
        <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
          <li><strong>MÃºltiplas PÃ¡ginas:</strong> Processa tabelas que continuam por vÃ¡rias pÃ¡ginas</li>
          <li><strong>MÃºltiplas Contas:</strong> Extrai todas as contas do mesmo PDF</li>
          <li><strong>ContinuaÃ§Ã£o de Tabelas:</strong> NÃ£o para atÃ© encontrar "Closing Balance"</li>
        </ul>
      </div>
    </div>

    <div class="info-box info">
      <div class="info-icon">âš ï¸</div>
      <div>
        <strong>Pontos importantes para ajustar no XLSX:</strong>
        <p style="margin: 0.5rem 0 0 0; color: #666;">
          Quando a tabela passa de uma pÃ¡gina, a Ãºltima linha de cada pÃ¡gina deve ser <strong>AJUSTADA</strong> no XLSX, Pois, apÃ³s a descriÃ§Ã£o correta, uma <strong>frase lixo</strong> acaba sendo inserida.
          ApÃ³s a descriÃ§Ã£o correta, Ã© acrescentado algo como <strong>"=== PÃGINA 9 === Transactions Operation Date Value Date Description Value Account Balance"</strong>, e isso deve ser removido.
        </p>
      </div>
    </div>

    <div class="features-list">
      <div class="feature-item">
        <span class="feature-icon">ğŸ”</span>
        <span>Identifica a seÃ§Ã£o "Cash Transactions"</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ğŸ¦</span>
        <span>Detecta "Opening Balance Account: NUMERO MOEDA"</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ğŸ’±</span>
        <span>Suporta mÃºltiplas moedas (USD, EUR, BRL, etc.)</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ğŸ“‹</span>
        <span>Extrai todas as transaÃ§Ãµes atÃ© "Closing Balance"</span>
      </div>
      <div class="feature-item">
        <span class="feature-icon">ğŸ“„</span>
        <span>Processa tabelas que continuam em vÃ¡rias pÃ¡ginas</span>
      </div>
    </div>

    <div class="upload-section">
      <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
        <div class="upload-icon">ğŸ“„</div>
        <div class="upload-text">Clique aqui ou arraste os PDFs</div>
        <div class="upload-hint">Selecione mÃºltiplos PDFs do ItaÃº (mÃ¡x. 16MB cada)</div>
      </div>
      <input type="file" id="fileInput" class="hidden-file-input" multiple accept=".pdf" />
    </div>

    <!-- Lista de arquivos -->
    <div id="filesSelected" class="files-selected" style="display: none;">
      <div class="files-header">ğŸ“‹ Arquivos Selecionados:</div>
      <div id="filesList" class="files-list"></div>
      <div id="filesSummary" class="files-summary"></div>
    </div>

    <!-- BotÃ£o -->
    <div id="actionButtons" class="action-section" style="display: none;">
      <button class="btn btn-primary" id="processBtn" onclick="processFiles()" disabled>
        Processar PDFs e Gerar Consolidado
      </button>
    </div>

    <!-- Loading -->
    <div id="loadingIndicator" class="loading" style="display: none;">
      <div class="spinner"></div>
      <p id="loadingText">Processando extratos do ItaÃº... Aguarde por favor.</p>
      <div id="progressInfo" class="progress-info"></div>
    </div>

    <!-- Status -->
    <div id="statusMessage" class="alert" style="display: none;"></div>
  </div>

  <div class="feature-boxes">
    <div class="feature-box">
      <div class="feature-icon">ğŸ’±</div>
      <h4>MÃºltiplas Moedas</h4>
      <p>USD, EUR, BRL e outras moedas</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">ğŸ“Š</div>
      <h4>MÃºltiplas Contas</h4>
      <p>Processa vÃ¡rias contas em um Ãºnico Excel</p>
    </div>
    <div class="feature-box">
      <div class="feature-icon">âš¡</div>
      <h4>Batch Processing</h4>
      <p>Processa mÃºltiplos PDFs de uma vez</p>
    </div>
  </div>

  <div class="help-section">
    <h3>ğŸ’¡ Como funciona:</h3>
    <ol>
      <li>Selecione mÃºltiplos PDFs do ItaÃº</li>
      <li>O sistema identifica automaticamente as seÃ§Ãµes "Cash Transactions"</li>
      <li>Para cada conta encontrada (ex: "6086454001 USD"), cria uma aba no Excel</li>
      <li>Se o mesmo nÃºmero de conta aparecer com moedas diferentes, cria abas separadas</li>
      <li>Exemplo de abas: "6086454001_USD", "6086454001_EUR", "1234567890_BRL"</li>
    </ol>
  </div>
</div>

<!-- style -->
<link rel="stylesheet" href="css/itau-cash.css" />


<script src="/js/itau-cash.js"></script>
